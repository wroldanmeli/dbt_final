{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.13", "generated_at": "2024-06-07T01:42:00.348141Z", "invocation_id": "8d6e47e2-59cc-426b-bd8f-147a4a51d900", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T01:37:48.385323Z", "completed_at": "2024-06-07T01:37:48.404193Z"}, {"name": "execute", "started_at": "2024-06-07T01:37:48.406595Z", "completed_at": "2024-06-07T01:37:55.234744Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 6.853408098220825, "adapter_response": {"_message": "CREATE TABLE (16.0k rows, 8.1 GiB processed)", "code": "CREATE TABLE", "rows_affected": 15979, "bytes_processed": 8719123181, "bytes_billed": 8719958016, "location": "US", "project_id": "metrics-streams-dev", "job_id": "a1a1f0b9-13ec-4e9b-978e-ee8950757a2a", "slot_ms": 1192504}, "message": "CREATE TABLE (16.0k rows, 8.1 GiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_BillingDashControlBase", "compiled": true, "compiled_code": "\n\nWITH \n    fecha_tablas AS (\n        SELECT table_id,\n               TIMESTAMP_MILLIS(last_modified_time) DateTIme_lastUpd, \n               row_count Count_rows, \n               size_bytes\n        FROM `metrics-streams-dev`.`ProcessedData`.`__TABLES__` ),\n\n    days_dummies AS (\n        SELECT days_gen FROM \n        UNNEST(GENERATE_DATE_ARRAY(PARSE_DATE('%F', '2022-01-01'), DATE(CURRENT_DATE() - INTERVAL 2 DAY) , INTERVAL 1 DAY))  AS days_gen\n        ),\n\n    pipelines_dummies AS (\n       SELECT idproceso, \n              proceso,\n              Responsable \n       FROM ManagementData.tproceso \n       WHERE idproceso in ( \n              SELECT DISTINCT idproceso FROM `metrics-streams-dev`.`ProcessedData`.`BillingtabFuryAllocation` WHERE idproceso NOT IN (88) \n              UNION ALL \n              SELECT 29 )),\n\n    pipes_day_real AS (\n       SELECT DATE(B.datetime) dia,\n                   B.idproceso, \n                   COUNT(1) conteo ,\n                   SUM(B.total_cost) total_cost\n       FROM `metrics-streams-dev`.`ProcessedData`.`BillingtabFuryAllocation` B \n       INNER JOIN pipelines_dummies C\n             ON(B.idproceso=C.idproceso)\n       GROUP BY 1,2 \n       UNION ALL\n       SELECT DATE(D.datetime) dia,\n                   29 idproceso, \n                   COUNT(1) conteo ,\n                   SUM(D.total_cost) total_cost\n       FROM `metrics-streams-dev`.`ProcessedData`.`BillingtabMelidata` D\n       GROUP BY 1,2\n       UNION ALL\n       SELECT DATE(E.datetime) dia,\n                   155 idproceso, \n                   COUNT(1) conteo ,\n                   SUM(E.total_cost) total_cost\n       FROM  `metrics-streams-dev`.`ProcessedData`.`BillingtabBQMeliBIData` E\n       GROUP BY 1,2 \n       UNION ALL\n       SELECT DATE(F.datetime) dia,\n                   155 idproceso, \n                   COUNT(1) conteo ,\n                   SUM(F.total_cost) total_cost\n       FROM  `metrics-streams-dev`.`ProcessedData`.`BillingtabGENAI` F\n       GROUP BY 1,2 \n       UNION ALL\n       SELECT DATE(G.datetime) dia,\n                   155 idproceso, \n                   COUNT(1) conteo ,\n                   SUM(G.total_cost) total_cost\n       FROM  `metrics-streams-dev`.`ProcessedData`.`BillingtabMelidataBIFinalCosts` G\n       GROUP BY 1,2 \n       ),\n\n    cruce_pipes_values AS (\n       SELECT A.*,\n              B.dia,\n              B.conteo,\n              B.total_cost \n       FROM pipelines_dummies A  \n       LEFT JOIN pipes_day_real B \n            ON (A.idproceso=B.idproceso) \n       ),\n\n    matriz_days_pipes AS (\n       SELECT * \n       FROM days_dummies, pipelines_dummies\n       ),\n\n    selected_base AS (\n       SELECT A.days_gen day, \n              A.idproceso,\n              A.proceso,\n              A.responsable,\n              ROUND(COALESCE(B.conteo,null,0),0) conteo,\n              ROUND(COALESCE(B.total_cost,null,0),2) total_cost \n       FROM  matriz_days_pipes A  \n       LEFT JOIN cruce_pipes_values B \n            ON (A.days_gen = B.dia AND A.idproceso=B.idproceso) \n       ) \n\n    SELECT A.*,\n      SUM(A.conteo)     OVER (PARTITION BY A.day ORDER BY day DESC) AS total_rows_day,\n      SUM(A.total_cost) OVER (PARTITION BY A.day ORDER BY day DESC) AS total_cost_day,\n      AVG(A.conteo)     OVER (PARTITION BY DATE(DATE_TRUNC(A.day , WEEK)), idproceso ) AS avg_rows_week,\n      AVG(A.total_cost) OVER (PARTITION BY DATE(DATE_TRUNC(A.day , WEEK)), idproceso ) AS avg_cost_week,\n      AVG(A.conteo)     OVER (PARTITION BY DATE(DATE_TRUNC(A.day , MONTH)), idproceso ) AS avg_rows_month,\n      AVG(A.total_cost) OVER (PARTITION BY DATE(DATE_TRUNC(A.day , MONTH)),idproceso ) AS avg_cost_month \n   FROM selected_base A", "relation_name": "`metrics-streams-dev`.`ProcessedData`.`BillingDashControlBase`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T01:37:55.245783Z", "completed_at": "2024-06-07T01:37:55.254685Z"}, {"name": "execute", "started_at": "2024-06-07T01:37:55.256767Z", "completed_at": "2024-06-07T01:37:58.118981Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.877333879470825, "adapter_response": {"_message": "CREATE TABLE (40.0 rows, 1.6 KiB processed)", "code": "CREATE TABLE", "rows_affected": 40, "bytes_processed": 1624, "bytes_billed": 10485760, "location": "US", "project_id": "metrics-streams-dev", "job_id": "ae166241-7af2-4c53-b522-281b7c6b5166", "slot_ms": 2962}, "message": "CREATE TABLE (40.0 rows, 1.6 KiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_tmp_process_output", "compiled": true, "compiled_code": "\n\n\n\nWITH \n    get_lista AS (SELECT '[]' as lista_in),\n    full_proc AS (SELECT DISTINCT idprocesopadre as idproceso FROM `metrics-streams-dev`.`ManagementData`.`tproceso` ),\n    list_cut AS (SELECT REPLACE(REPLACE(REPLACE(lista_in,'[',''),']',''),' ','')  as lista_cut FROM get_lista ),\n    proc_input AS (SELECT ARRAY_CONCAT(ARRAY_AGG(CAST(listado AS INT64)),[44]) array_process\n                                FROM list_cut , UNNEST(SPLIT(lista_cut)) AS listado),\n    partial_list AS (SELECT idproceso FROM proc_input , UNNEST(array_process) AS idproceso),                           \n    proc_output AS (SELECT A.idproceso FROM partial_list A WHERE EXISTS(SELECT 'X' FROM full_proc B WHERE A.idproceso = B.idproceso))                            \n\n    \n    SELECT * FROM  \n       full_proc\n    ", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_tmp_process_output`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T01:37:58.129852Z", "completed_at": "2024-06-07T01:38:13.085547Z"}, {"name": "execute", "started_at": "2024-06-07T01:38:13.087685Z", "completed_at": "2024-06-07T01:38:16.887586Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 18.762154579162598, "adapter_response": {"_message": "CREATE TABLE (887.0 rows, 7.5 GiB processed)", "code": "CREATE TABLE", "rows_affected": 887, "bytes_processed": 8023002144, "bytes_billed": 8023703552, "location": "US", "project_id": "metrics-streams-dev", "job_id": "591b38a4-60dd-41a9-9963-368d319eb7a6", "slot_ms": 381403}, "message": "CREATE TABLE (887.0 rows, 7.5 GiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_last_snapshot", "compiled": true, "compiled_code": "-- depends_on: `metrics-streams-dev`.`TemporalData`.`final_tmp_process_output`\nSELECT DATE(datetime) day_snap, '20240607013700' sufijo , COUNT(1) records_snap, CAST(ROUND(SUM(total_cost),0) AS INT64) cost_snap \n        FROM ProcessedData_REPRO_snapshots.BillingfacAllocationFinal_20240607013700  \n        GROUP BY 1", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_last_snapshot`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T01:38:16.898342Z", "completed_at": "2024-06-07T01:38:20.837154Z"}, {"name": "execute", "started_at": "2024-06-07T01:38:20.839292Z", "completed_at": "2024-06-07T01:38:37.144062Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 20.249707221984863, "adapter_response": {"_message": "CREATE TABLE (35.4k rows, 64.7 GiB processed)", "code": "CREATE TABLE", "rows_affected": 35361, "bytes_processed": 69426684230, "bytes_billed": 69427265536, "location": "US", "project_id": "metrics-streams-dev", "job_id": "949bc018-c3ee-42ba-83d0-170fadcacf8f", "slot_ms": 2014351}, "message": "CREATE TABLE (35.4k rows, 64.7 GiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.substract_get_OffFury_aws", "compiled": true, "compiled_code": "-- depends on : `metrics-streams-dev`.`TemporalData`.`final_tmp_process_output` \n\n\n\n\n\n\n\n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n\n\n\n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n\n\n\n\n\nSELECT \n        cast(timestamp_trunc(line_item_usage_start_date,DAY) as DATETIME) as datetime,\n        line_item_usage_account_id as account_id\n        ,product_product_name as service_type\n        ,line_item_usage_type as billing_key      \n        ,CASE WHEN resource_tags_user_cloudcontroller_stack= '' or resource_tags_user_cloudcontroller_stack is null THEN\n          'NO-STACK'\n        ELSE\n          resource_tags_user_cloudcontroller_stack\n        END as service_name\n        ,cast(SUM(CASE WHEN line_item_line_item_type = 'DiscountedUsage' THEN \n            reservation_effective_cost\n            WHEN line_item_line_item_type = 'Usage' THEN \n              line_item_unblended_cost\n            WHEN line_item_line_item_type = 'SavingsPlanCoveredUsage' THEN\n              savings_plan_savings_plan_effective_cost\n            WHEN line_item_line_item_type = 'Fee' \n                  AND product_product_name in ('AWS Premium Support','OCBOCBAWSDirectConnect') or bill_billing_entity = 'AWS Marketplace' THEN \n                line_item_unblended_cost\n            END) as numeric) as total_cost\n        ,pricing_unit as billing_unit\n        ,cast(SUM(line_item_usage_amount) as numeric) as billing_usage_ammount\n        ,'AWS' as provider\n        ,current_date()  load_date  \n        ,current_date() update_date\n        ,'Test dbt' as observation\n        FROM `metrics-streams-dev`.`RawData`.`billing_edp`  \n        WHERE year >= 2024\n              and year <= 2024\n              and month >= 6\n              and month <=  6\n              and date(line_item_usage_start_date) >= '2024-06-01'  and date(line_item_usage_start_date) <='2024-06-04' \n              AND line_item_line_item_type IN ('DiscountedUsage', 'Usage', 'RIFee', 'SavingsPlanCoveredUsage', 'Fee')\n              AND line_item_usage_type NOT LIKE '%HeavyUsage%' \n               AND (   ( line_item_usage_account_id = \"165742082170\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  ( line_item_usage_account_id = \"698901797328\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  ( line_item_usage_account_id = \"150890519415\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  ( line_item_usage_account_id = \"122375311039\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  ( line_item_usage_account_id = \"047141863347\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  ( line_item_usage_account_id = \"272718278578\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  ( line_item_usage_account_id = \"886495075632\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  ( line_item_usage_account_id = \"958338282214\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  ( line_item_usage_account_id = \"537757959597\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  ( line_item_usage_account_id = \"621237723456\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  ( line_item_usage_account_id = \"690399877577\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  ( line_item_usage_account_id = \"796854892605\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  ( line_item_usage_account_id = \"796854892605\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  ( line_item_usage_account_id = \"751671831563\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  ( line_item_usage_account_id = \"270916447595\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  ( line_item_usage_account_id = \"750993754488 \" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\"))  OR (line_item_line_item_description like \"%Conditional Deal%\" AND  line_item_usage_account_id = \"736370371722\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_operation  =  \"NatGateway\" AND  line_item_usage_account_id = \"736370371722\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonCloudFront\" AND  line_item_usage_account_id = \"558628470851\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"awswaf\" AND  line_item_usage_account_id = \"537757959597\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonRoute53\" AND  line_item_usage_account_id = \"958338282214\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"awswaf\" AND  line_item_usage_account_id = \"019704497826\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonCloudFront\" AND  line_item_usage_account_id = \"537757959597\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSShield\" AND  line_item_usage_account_id = \"537757959597\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSCertificateManager\" AND  line_item_usage_account_id = \"047141863347\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSDirectConnect\" AND  line_item_usage_account_id = \"537757959597\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSCertificateManager\" AND  line_item_usage_account_id = \"070958878125\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSDirectConnect\" AND  line_item_usage_account_id = \"690399877577\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonRoute53\" AND  line_item_usage_account_id = \"558628470851\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSShield\" AND  line_item_usage_account_id = \"128464316945\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSDirectConnect\" AND  line_item_usage_account_id = \"598925332888\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonCloudFront\" AND  line_item_usage_account_id = \"749651711864\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonCloudFront\" AND  line_item_usage_account_id = \"598925332888\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonCloudFront\" AND  line_item_usage_account_id = \"913292487988\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonCloudFront\" AND  line_item_usage_account_id = \"955895235416\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonVPC\" AND  line_item_usage_account_id = \"558628470851\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonVPC\" AND  line_item_usage_account_id = \"961618667388\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonCloudFront\" AND  line_item_usage_account_id = \"281193985665\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonApiGateway\" AND  line_item_usage_account_id = \"830619001108\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonCloudFront\" AND  line_item_usage_account_id = \"621237723456\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSCertificateManager\" AND  line_item_usage_account_id = \"558628470851\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSDirectConnect\" AND  line_item_usage_account_id = \"767428572615\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"awswaf\" AND  line_item_usage_account_id = \"047141863347\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSShield\" AND  line_item_usage_account_id = \"767428572615\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSCertificateManager\" AND  line_item_usage_account_id = \"205860777463\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonVPC\" AND  line_item_usage_account_id = \"621237723456\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSShield\" AND  line_item_usage_account_id = \"961618667388\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSDirectConnect\" AND  line_item_usage_account_id = \"128464316945\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonRoute53\" AND  line_item_usage_account_id = \"470332157166\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonRoute53\" AND  line_item_usage_account_id = \"749651711864\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonVPC\" AND  line_item_usage_account_id = \"128464316945\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonVPC\" AND  line_item_usage_account_id = \"913292487988\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonRoute53\" AND  line_item_usage_account_id = \"690399877577\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonRoute53\" AND  line_item_usage_account_id = \"047141863347\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"awswaf\" AND  line_item_usage_account_id = \"961618667388\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonVPC\" AND  line_item_usage_account_id = \"070958878125\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSCertificateManager\" AND  line_item_usage_account_id = \"621237723456\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"awswaf\" AND  line_item_usage_account_id = \"830619001108\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonApiGateway\" AND  line_item_usage_account_id = \"205860777463\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonCloudFront\" AND  line_item_usage_account_id = \"047141863347\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonRoute53\" AND  line_item_usage_account_id = \"205860777463\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSCertificateManager\" AND  line_item_usage_account_id = \"019704497826\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonApiGateway\" AND  line_item_usage_account_id = \"537757959597\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonApiGateway\" AND  line_item_usage_account_id = \"128464316945\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonVPC\" AND  line_item_usage_account_id = \"019704497826\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonVPC\" AND  line_item_usage_account_id = \"281193985665\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSCertificateManager\" AND  line_item_usage_account_id = \"598925332888\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonApiGateway\" AND  line_item_usage_account_id = \"070958878125\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonRoute53\" AND  line_item_usage_account_id = \"913292487988\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonApiGateway\" AND  line_item_usage_account_id = \"767428572615\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonApiGateway\" AND  line_item_usage_account_id = \"558628470851\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonRoute53\" AND  line_item_usage_account_id = \"736370371722\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"awswaf\" AND  line_item_usage_account_id = \"470332157166\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSShield\" AND  line_item_usage_account_id = \"470332157166\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSDirectConnect\" AND  line_item_usage_account_id = \"047141863347\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonCloudFront\" AND  line_item_usage_account_id = \"830619001108\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"awswaf\" AND  line_item_usage_account_id = \"621237723456\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonRoute53\" AND  line_item_usage_account_id = \"598925332888\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSShield\" AND  line_item_usage_account_id = \"205860777463\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonCloudFront\" AND  line_item_usage_account_id = \"019704497826\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSCertificateManager\" AND  line_item_usage_account_id = \"961618667388\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonElastiCache\" AND  line_item_usage_account_id = \"736370371722\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonVPC\" AND  line_item_usage_account_id = \"205860777463\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"awswaf\" AND  line_item_usage_account_id = \"767428572615\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonRoute53\" AND  line_item_usage_account_id = \"070958878125\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonApiGateway\" AND  line_item_usage_account_id = \"736370371722\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSShield\" AND  line_item_usage_account_id = \"736370371722\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonVPC\" AND  line_item_usage_account_id = \"958338282214\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonApiGateway\" AND  line_item_usage_account_id = \"019704497826\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonEC2\" AND  line_item_usage_account_id = \"598925332888\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSELB\" AND  line_item_usage_account_id = \"019704497826\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSCertificateManager\" AND  line_item_usage_account_id = \"470332157166\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonCloudFront\" AND  line_item_usage_account_id = \"736370371722\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"awswaf\" AND  line_item_usage_account_id = \"736370371722\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSShield\" AND  line_item_usage_account_id = \"019704497826\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonRoute53\" AND  line_item_usage_account_id = \"767428572615\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSCertificateManager\" AND  line_item_usage_account_id = \"830619001108\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"awswaf\" AND  line_item_usage_account_id = \"281193985665\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonApiGateway\" AND  line_item_usage_account_id = \"598925332888\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonRoute53\" AND  line_item_usage_account_id = \"537757959597\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"awswaf\" AND  line_item_usage_account_id = \"205860777463\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonCloudFront\" AND  line_item_usage_account_id = \"961618667388\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"awswaf\" AND  line_item_usage_account_id = \"128464316945\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonApiGateway\" AND  line_item_usage_account_id = \"961618667388\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"awswaf\" AND  line_item_usage_account_id = \"749651711864\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonRoute53\" AND  line_item_usage_account_id = \"961618667388\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonVPC\" AND  line_item_usage_account_id = \"598925332888\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonApiGateway\" AND  line_item_usage_account_id = \"047141863347\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSShield\" AND  line_item_usage_account_id = \"047141863347\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonVPC\" AND  line_item_usage_account_id = \"767428572615\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSCertificateManager\" AND  line_item_usage_account_id = \"690399877577\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonCloudFront\" AND  line_item_usage_account_id = \"070958878125\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSCertificateManager\" AND  line_item_usage_account_id = \"537757959597\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSCertificateManager\" AND  line_item_usage_account_id = \"958338282214\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSDirectConnect\" AND  line_item_usage_account_id = \"470332157166\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSShield\" AND  line_item_usage_account_id = \"830619001108\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSShield\" AND  line_item_usage_account_id = \"749651711864\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSShield\" AND  line_item_usage_account_id = \"690399877577\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSCertificateManager\" AND  line_item_usage_account_id = \"749651711864\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"awswaf\" AND  line_item_usage_account_id = \"913292487988\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSShield\" AND  line_item_usage_account_id = \"913292487988\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSCertificateManager\" AND  line_item_usage_account_id = \"767428572615\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonCloudFront\" AND  line_item_usage_account_id = \"690399877577\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSShield\" AND  line_item_usage_account_id = \"070958878125\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonRoute53\" AND  line_item_usage_account_id = \"019704497826\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSDirectConnect\" AND  line_item_usage_account_id = \"958338282214\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonApiGateway\" AND  line_item_usage_account_id = \"470332157166\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSCertificateManager\" AND  line_item_usage_account_id = \"281193985665\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSDirectConnect\" AND  line_item_usage_account_id = \"830619001108\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonRoute53\" AND  line_item_usage_account_id = \"621237723456\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonCloudFront\" AND  line_item_usage_account_id = \"470332157166\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonVPC\" AND  line_item_usage_account_id = \"830619001108\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonDynamoDB\" AND  line_item_usage_account_id = \"019704497826\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSDirectConnect\" AND  line_item_usage_account_id = \"019704497826\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSDirectConnect\" AND  line_item_usage_account_id = \"955895235416\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSShield\" AND  line_item_usage_account_id = \"958338282214\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonApiGateway\" AND  line_item_usage_account_id = \"913292487988\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonApiGateway\" AND  line_item_usage_account_id = \"281193985665\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"awswaf\" AND  line_item_usage_account_id = \"958338282214\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSShield\" AND  line_item_usage_account_id = \"558628470851\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonCloudFront\" AND  line_item_usage_account_id = \"128464316945\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonVPC\" AND  line_item_usage_account_id = \"047141863347\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonVPC\" AND  line_item_usage_account_id = \"736370371722\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonApiGateway\" AND  line_item_usage_account_id = \"690399877577\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSDirectConnect\" AND  line_item_usage_account_id = \"621237723456\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"awswaf\" AND  line_item_usage_account_id = \"598925332888\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSDirectConnect\" AND  line_item_usage_account_id = \"558628470851\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonApiGateway\" AND  line_item_usage_account_id = \"958338282214\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"awswaf\" AND  line_item_usage_account_id = \"070958878125\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonRoute53\" AND  line_item_usage_account_id = \"128464316945\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonCloudFront\" AND  line_item_usage_account_id = \"767428572615\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"awswaf\" AND  line_item_usage_account_id = \"690399877577\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSShield\" AND  line_item_usage_account_id = \"598925332888\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonVPC\" AND  line_item_usage_account_id = \"470332157166\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonRoute53\" AND  line_item_usage_account_id = \"830619001108\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSDirectConnect\" AND  line_item_usage_account_id = \"736370371722\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonCloudFront\" AND  line_item_usage_account_id = \"958338282214\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSShield\" AND  line_item_usage_account_id = \"955895235416\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonVPC\" AND  line_item_usage_account_id = \"537757959597\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonCloudFront\" AND  line_item_usage_account_id = \"205860777463\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSELB\" AND  line_item_usage_account_id = \"736370371722\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonApiGateway\" AND  line_item_usage_account_id = \"955895235416\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSCertificateManager\" AND  line_item_usage_account_id = \"128464316945\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonVPC\" AND  line_item_usage_account_id = \"955895235416\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSDirectConnect\" AND  line_item_usage_account_id = \"281193985665\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSCertificateManager\" AND  line_item_usage_account_id = \"736370371722\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSDirectConnect\" AND  line_item_usage_account_id = \"749651711864\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSDirectConnect\" AND  line_item_usage_account_id = \"961618667388\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonRoute53\" AND  line_item_usage_account_id = \"955895235416\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonVPC\" AND  line_item_usage_account_id = \"749651711864\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSDirectConnect\" AND  line_item_usage_account_id = \"205860777463\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSCertificateManager\" AND  line_item_usage_account_id = \"913292487988\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"awswaf\" AND  line_item_usage_account_id = \"955895235416\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonRoute53\" AND  line_item_usage_account_id = \"281193985665\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonApiGateway\" AND  line_item_usage_account_id = \"621237723456\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSDirectConnect\" AND  line_item_usage_account_id = \"070958878125\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSCertificateManager\" AND  line_item_usage_account_id = \"955895235416\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonApiGateway\" AND  line_item_usage_account_id = \"749651711864\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSShield\" AND  line_item_usage_account_id = \"281193985665\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSShield\" AND  line_item_usage_account_id = \"621237723456\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSDirectConnect\" AND  line_item_usage_account_id = \"913292487988\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonVPC\" AND  line_item_usage_account_id = \"690399877577\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"awswaf\" AND  line_item_usage_account_id = \"558628470851\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_resource_id = \"traffic-layer-logs-current\" AND  line_item_usage_account_id = \"736370371722\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_usage_type = \"Global-SoftwareUsage-Contracts\" AND  line_item_usage_account_id = \"199745886785\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (product_product_name = \"Amazon Simple Storage Service\" AND  line_item_usage_account_id = \"070958878125\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (product_product_name = \"Amazon Simple Storage Service\" AND  line_item_usage_account_id = \"161094425896\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (product_product_name = \"Amazon Simple Storage Service\" AND  line_item_usage_account_id = \"281193985665\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (product_product_name = \"Amazon Simple Storage Service\" AND  line_item_usage_account_id = \"014991816441\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (product_product_name = \"Amazon Simple Storage Service\" AND  line_item_usage_account_id = \"913292487988\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (product_product_name = \"Amazon Simple Storage Service\" AND  line_item_usage_account_id = \"635950459433\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (product_product_name = \"Amazon Simple Storage Service\" AND  line_item_usage_account_id = \"767428572615\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (product_product_name = \"Amazon Simple Storage Service\" AND  line_item_usage_account_id = \"627632095367\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (product_product_name = \"Amazon Simple Storage Service\" AND  line_item_usage_account_id = \"830619001108\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (product_product_name = \"Amazon Simple Storage Service\" AND  line_item_usage_account_id = \"128464316945\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (product_product_name = \"Amazon Simple Storage Service\" AND  line_item_usage_account_id = \"228092041116\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (product_product_name = \"Amazon Simple Storage Service\" AND  line_item_usage_account_id = \"961618667388\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (product_product_name = \"Amazon Simple Storage Service\" AND  line_item_usage_account_id = \"470332157166\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (product_product_name = \"Amazon Simple Storage Service\" AND  line_item_usage_account_id = \"955895235416\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (product_product_name = \"Amazon Simple Storage Service\" AND  line_item_usage_account_id = \"088484141381\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (product_product_name = \"Amazon Simple Storage Service\" AND  line_item_usage_account_id = \"632765385162\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (product_servicecode = \"AWSDataTransfer\" AND  line_item_usage_account_id = \"736370371722\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (resource_tags_user_application = \"traffic-layer\" AND  line_item_usage_account_id = \"736370371722\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (resource_tags_user_application != \"\" AND  line_item_usage_account_id = \"736370371722\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (resource_tags_user_cb_application = \"melidata-generic-streams\" AND  line_item_usage_account_id = \"968153641465\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (resource_tags_user_name like  \"md-spark%\" AND  line_item_usage_account_id = \"968153641465\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (resource_tags_user_name like \"data-apps-nomad%\" AND  line_item_usage_account_id = \"736370371722\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (resource_tags_user_name like  \"md-presto%\" AND  line_item_usage_account_id = \"968153641465\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (resource_tags_user_name like  \"md-hive%\" AND  line_item_usage_account_id = \"968153641465\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (resource_tags_user_name  = \"fury-controlplane\" AND  line_item_usage_account_id = \"736370371722\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (resource_tags_user_owner = \"serverless\" AND  line_item_usage_account_id = \"736370371722\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (resource_tags_user_service = \"bigq\" AND  line_item_usage_account_id = \"019704497826\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (resource_tags_user_service = \"mq\" AND  line_item_usage_account_id = \"019704497826\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (resource_tags_user_service = \"furylogs\" AND  line_item_usage_account_id = \"433070516464\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (resource_tags_user_service = \"furylogs-test\" AND  line_item_usage_account_id = \"433070516464\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (resource_tags_user_service = \"ds\" AND  line_item_usage_account_id = \"019704497826\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (resource_tags_user_service = \"kvs\" AND  line_item_usage_account_id = \"019704497826\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (resource_tags_user_service like \"object-storage%\" AND  line_item_usage_account_id = \"736370371722\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")))\n        GROUP BY 1,2,3,4,5,7,9,10,11,12\n        having total_cost>0\n        ORDER BY 9,1", "relation_name": "`metrics-streams-dev`.`TemporalData`.`substract_get_OffFury_aws`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T01:38:37.153688Z", "completed_at": "2024-06-07T01:38:42.058205Z"}, {"name": "execute", "started_at": "2024-06-07T01:38:42.060389Z", "completed_at": "2024-06-07T01:38:45.433310Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 8.283872127532959, "adapter_response": {"_message": "CREATE TABLE (751.0 rows, 35.2 GiB processed)", "code": "CREATE TABLE", "rows_affected": 751, "bytes_processed": 37780645871, "bytes_billed": 37781241856, "location": "US", "project_id": "metrics-streams-dev", "job_id": "c771ce8a-5bc8-48c1-b890-e262f4230435", "slot_ms": 297522}, "message": "CREATE TABLE (751.0 rows, 35.2 GiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.substract_get_OffFury_gcp", "compiled": true, "compiled_code": "-- depends on : `metrics-streams-dev`.`TemporalData`.`final_tmp_process_output` \n\n\n\n\n\n\n\n\n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n\n\n\n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n\n\n\n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n\nSELECT\n      cast(TIMESTAMP_TRUNC(usage_start_time, DAY) AS datetime) datetime,\n      CASE\n        WHEN PROJECT.id IS NULL THEN 'Cargos no especificos de un proyecto'\n        ELSE\n          PROJECT.id\n      END AS account_id,\n      service.description AS service_type,\n      sku.description AS billing_key,\n      'NO-STACK' AS service_name,\n      cast((SUM(CAST(cost * 1000000 AS INT64)) + SUM(IFNULL((\n              SELECT\n                SUM(CAST(c.amount * 1000000 AS INT64))\n              FROM\n                UNNEST(credits) c),\n          0))) / 1000000 as numeric)  AS total_cost,\n      usage.pricing_unit AS billing_unit,\n      cast(SUM(usage.amount_in_pricing_units) as numeric)  AS billing_usage_amount,\n      'GCP' AS provider\n      ,current_date()  load_date\t\n      ,current_date() update_date\n      ,'Test dbt' as observation \n    FROM `metrics-streams-dev`.`GoogleCloudBillingDetail`.`BillingDetailExport` \n    WHERE\n      PARTITIONTIME >= DATETIME_SUB(CAST(PARSE_DATE('%F', '2024-06-01') as TIMESTAMP), INTERVAL 1 DAY)\n      AND PARTITIONTIME <= DATETIME_ADD(cast(PARSE_DATE('%F', '2024-06-04') as TIMESTAMP ),INTERVAL 1 DAY)\n      AND TIMESTAMP_TRUNC(usage_start_time, DAY) >=cast(PARSE_DATE('%F', '2024-06-01') as timestamp)\n      AND TIMESTAMP_TRUNC(usage_start_time, DAY) <= cast(PARSE_DATE('%F', '2024-06-04') as timestamp)\n       AND (   (  PROJECT.id = \"gobiernoit-reservas\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpbs-mob-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"mid-shp-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"test-shp-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"test-fra-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpbt-mp-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpbt-mob-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"low-db-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpt-mkt-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"mid-fra-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpbt-cp-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpbs-mkt-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"low-mkt-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpbt-shp-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"dev05-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bps-cp-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpbs-db-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"test-mob-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"mid-cp-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpt-mp-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"test-mkt-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"low-cp-bq02\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"high-fra-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"mid-db-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"high-com-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bps-mob-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpt-mob-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"high-mkt-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"high-shp-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpbt-db-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpbt-mkt-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"dev04b-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpbs-fra-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpt-shp-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpt-com-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"low-fra-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpbs-com-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bps-mp-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"low-com-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"mid-com-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"low-cp-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"low-shp-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"mid-mkt-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bps-shp-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"high-mob-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpbs-shp-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpbs-api-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bps-db-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpbt-fra-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bigqueue-test\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bps-mkt-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"low-mob-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpbt-com-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"mid-api-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpt-db-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bps-api-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"test-db-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"dev02-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bps-fra-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"mid-mp-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpt-fra-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"high-cp-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpt-cp-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"high-mp-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"high-db-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"dev03-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bps-com-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"dev01-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"mid-mob-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"test-cp-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpbt-api-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"low-mp-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"high-api-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpbs-cp-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"test-api-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpbs-mp-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bigqueue\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"test-mp-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"low-api-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpt-api-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"shared-vpc-224614\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\"))  OR (resource.global_name like \"%//bigquery.googleapis.com/projects/melidata-marketplace/datasets/melidata%\" AND PROJECT.id = \"melidata-marketplace\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (resource.name like \"%desaenv%\" AND PROJECT.id = \"598925332888\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (resource.name like \"%DESAENV%\" AND PROJECT.id = \"dbaas-268214\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (resource.name like \"%desaenv%\" AND PROJECT.id = \"dbaas-268214\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (resource.name like \"%DESAENV%\" AND PROJECT.id = \"598925332888\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (service.description = \"Compute Engine\" AND PROJECT.id = \"fury-202121\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (service.description = \"Compute Engine\" AND PROJECT.id = \"dbaas-268214\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")))\n    GROUP BY 1, 2, 3, 4, 5, 7, 9, 10, 11, 12\n    HAVING total_cost > 0.0", "relation_name": "`metrics-streams-dev`.`TemporalData`.`substract_get_OffFury_gcp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T01:38:45.444008Z", "completed_at": "2024-06-07T01:38:47.030797Z"}, {"name": "execute", "started_at": "2024-06-07T01:38:47.032833Z", "completed_at": "2024-06-07T01:38:49.578182Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.138628244400024, "adapter_response": {"_message": "CREATE TABLE (28.0 rows, 982.5 MiB processed)", "code": "CREATE TABLE", "rows_affected": 28, "bytes_processed": 1030223642, "bytes_billed": 1030750208, "location": "US", "project_id": "metrics-streams-dev", "job_id": "62ff1f58-7fa2-438c-b693-acb658256503", "slot_ms": 4354}, "message": "CREATE TABLE (28.0 rows, 982.5 MiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.substract_get_OffFury_oci", "compiled": true, "compiled_code": "-- depends on : `metrics-streams-dev`.`TemporalData`.`final_tmp_process_output` \n\n\n\n\n\n\n\n\n       \n           \n\n       \n           \n\n       \n           \n\n       \n           \n\n       \n           \n\n       \n           \n\n       \n           \n\n\nSELECT\n      cast(TIMESTAMP_TRUNC(cost_lineItem_intervalUsageStart, DAY) AS datetime) datetime,\n     'ocid1.tenancy.oc1..aaaaaaaalgfveinmsacv4lo36wk4hfoiokh2m52j72sw5f4boms676vvc2da' AS account_id,\n      CONCAT('OCI_',cost_product_Description) AS service_type,\n      COALESCE(usage_product_resource,null,'UNDEFINED')  AS billing_key,\n      'NO-STACK' AS service_name,\n      CAST(SUM(ROUND(cost_total_cost_US,2)) AS NUMERIC)  AS total_cost,\n      COALESCE(usage_consumedQuantityUnits,null,'UNDEFINED') billing_unit,\n      CAST(SUM(ROUND(cost_total_usage,2)) AS NUMERIC)  AS billing_usage_amount,\n      'OCI' AS provider\n      ,current_date()  load_date\n      ,current_date() update_date\n      ,'Test dbt' as observation\n    FROM `metrics-streams-dev`.`WorkData`.`BillingOracleAnnualUnified`\n    WHERE\n        (cost_product_Description = \"Exadata X9M Additional Storage Instance Meter\"  AND  cost_lineItem_intervalUsageStart BETWEEN \"2024-06-01\" AND \"2024-06-04\") OR (cost_product_Description = \"Exadata X8M Additional Storage Instance Meter\"  AND  cost_lineItem_intervalUsageStart BETWEEN \"2024-06-01\" AND \"2024-06-04\") OR (cost_product_Description = \"Exadata X9M Additional Compute Instance Meter\"  AND  cost_lineItem_intervalUsageStart BETWEEN \"2024-06-01\" AND \"2024-06-04\") OR (cost_product_Description = \"Database Exadata - Additional OCPUs - BYOL\"  AND  cost_lineItem_intervalUsageStart BETWEEN \"2024-06-01\" AND \"2024-06-04\") OR (cost_product_Description = \"Exadata X9M Quarter Rack Instance Meter\"  AND  cost_lineItem_intervalUsageStart BETWEEN \"2024-06-01\" AND \"2024-06-04\") OR (cost_product_Description = \"Exadata X8M Quarter Rack Instance Meter\"  AND  cost_lineItem_intervalUsageStart BETWEEN \"2024-06-01\" AND \"2024-06-04\") OR (cost_product_Description = \"Exadata X8M Additional Compute Instance Meter\"  AND  cost_lineItem_intervalUsageStart BETWEEN \"2024-06-01\" AND \"2024-06-04\")\n    GROUP BY 1,2,3,4,5,7,9,10,11,12\n    HAVING total_cost > 0.0", "relation_name": "`metrics-streams-dev`.`TemporalData`.`substract_get_OffFury_oci`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T01:38:49.588965Z", "completed_at": "2024-06-07T01:38:50.485115Z"}, {"name": "execute", "started_at": "2024-06-07T01:38:50.487152Z", "completed_at": "2024-06-07T01:38:52.772914Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.188525438308716, "adapter_response": {"_message": "CREATE TABLE (23.0 rows, 0 processed)", "code": "CREATE TABLE", "rows_affected": 23, "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "metrics-streams-dev", "job_id": "5af13b18-ffe6-455d-a4bd-e87e142653e7", "slot_ms": 3578}, "message": "CREATE TABLE (23.0 rows, 0 processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.substract_get_rules_fury", "compiled": true, "compiled_code": "-- depends on : `metrics-streams-dev`.`TemporalData`.`final_tmp_process_output`\n\n\n\n\n    \n    SELECT\n        'application_name' tag_key, \n        'mqadmin' tag_value,\n        '!=' operator,\n        '2023-02-01' from_date,\n        '2030-12-31' to_date,\n        '(application_name != \"mqadmin\")' cadena\n\n    \n    union all\n    \n\n\n    \n    SELECT\n        'application_name' tag_key, \n        'mq-pubsub-poc' tag_value,\n        '!=' operator,\n        '2023-02-01' from_date,\n        '2030-12-31' to_date,\n        '(application_name != \"mq-pubsub-poc\")' cadena\n\n    \n    union all\n    \n\n\n    \n    SELECT\n        'application_name' tag_key, \n        'mqapi' tag_value,\n        '!=' operator,\n        '2023-02-01' from_date,\n        '2030-12-31' to_date,\n        '(application_name != \"mqapi\")' cadena\n\n    \n    union all\n    \n\n\n    \n    SELECT\n        'application_name' tag_key, \n        'bq-provider-manager' tag_value,\n        '!=' operator,\n        '2023-02-01' from_date,\n        '2030-12-31' to_date,\n        '(application_name != \"bq-provider-manager\")' cadena\n\n    \n    union all\n    \n\n\n    \n    SELECT\n        'application_name' tag_key, \n        'mqpusher' tag_value,\n        '!=' operator,\n        '2023-02-01' from_date,\n        '2030-12-31' to_date,\n        '(application_name != \"mqpusher\")' cadena\n\n    \n    union all\n    \n\n\n    \n    SELECT\n        'application_name' tag_key, \n        'mq-publisher' tag_value,\n        '!=' operator,\n        '2023-02-01' from_date,\n        '2030-12-31' to_date,\n        '(application_name != \"mq-publisher\")' cadena\n\n    \n    union all\n    \n\n\n    \n    SELECT\n        'application_name' tag_key, \n        'bigqueue-load-testing-utils' tag_value,\n        '!=' operator,\n        '2023-02-01' from_date,\n        '2030-12-31' to_date,\n        '(application_name != \"bigqueue-load-testing-utils\")' cadena\n\n    \n    union all\n    \n\n\n    \n    SELECT\n        'application_name' tag_key, \n        'bq-consumer-mock' tag_value,\n        '!=' operator,\n        '2023-02-01' from_date,\n        '2030-12-31' to_date,\n        '(application_name != \"bq-consumer-mock\")' cadena\n\n    \n    union all\n    \n\n\n    \n    SELECT\n        'application_name' tag_key, \n        'logan' tag_value,\n        '!=' operator,\n        '2022-12-02' from_date,\n        '2030-12-31' to_date,\n        '(application_name != \"logan\")' cadena\n\n    \n    union all\n    \n\n\n    \n    SELECT\n        'application_name' tag_key, \n        'logs-collector' tag_value,\n        '!=' operator,\n        '2022-12-02' from_date,\n        '2030-12-31' to_date,\n        '(application_name != \"logs-collector\")' cadena\n\n    \n    union all\n    \n\n\n    \n    SELECT\n        'application_name' tag_key, \n        'logs-admin' tag_value,\n        '!=' operator,\n        '2022-12-02' from_date,\n        '2030-12-31' to_date,\n        '(application_name != \"logs-admin\")' cadena\n\n    \n    union all\n    \n\n\n    \n    SELECT\n        'application_name' tag_key, \n        'melidata-tracking-api' tag_value,\n        '!=' operator,\n        '2024-04-01' from_date,\n        '2031-12-31' to_date,\n        '(application_name != \"melidata-tracking-api\")' cadena\n\n    \n    union all\n    \n\n\n    \n    SELECT\n        'application_name' tag_key, \n        'traffic-layer' tag_value,\n        '!=' operator,\n        '2022-01-01' from_date,\n        '2031-12-31' to_date,\n        '(application_name != \"traffic-layer\")' cadena\n\n    \n    union all\n    \n\n\n    \n    SELECT\n        'application_name' tag_key, \n        'kvsapi' tag_value,\n        '!=' operator,\n        '2022-01-01' from_date,\n        '2031-12-31' to_date,\n        '(application_name != \"kvsapi\")' cadena\n\n    \n    union all\n    \n\n\n    \n    SELECT\n        'application_name' tag_key, \n        'kvsapi-migrator' tag_value,\n        '!=' operator,\n        '2022-01-01' from_date,\n        '2031-12-31' to_date,\n        '(application_name != \"kvsapi-migrator\")' cadena\n\n    \n    union all\n    \n\n\n    \n    SELECT\n        'application_name' tag_key, \n        'dsapi' tag_value,\n        '!=' operator,\n        '2022-01-01' from_date,\n        '2031-12-31' to_date,\n        '(application_name != \"dsapi\")' cadena\n\n    \n    union all\n    \n\n\n    \n    SELECT\n        'application_name' tag_key, \n        'dsadmin' tag_value,\n        '!=' operator,\n        '2022-01-01' from_date,\n        '2031-12-31' to_date,\n        '(application_name != \"dsadmin\")' cadena\n\n    \n    union all\n    \n\n\n    \n    SELECT\n        'application_name' tag_key, \n        'melistreams-commons' tag_value,\n        '!=' operator,\n        '2023-08-01' from_date,\n        '2031-12-31' to_date,\n        '(application_name != \"melistreams-commons\")' cadena\n\n    \n    union all\n    \n\n\n    \n    SELECT\n        'application_name' tag_key, \n        'melistreams-producer' tag_value,\n        '!=' operator,\n        '2023-08-01' from_date,\n        '2031-12-31' to_date,\n        '(application_name != \"melistreams-producer\")' cadena\n\n    \n    union all\n    \n\n\n    \n    SELECT\n        'application_name' tag_key, \n        'melistreams-admin' tag_value,\n        '!=' operator,\n        '2023-08-01' from_date,\n        '2031-12-31' to_date,\n        '(application_name != \"melistreams-admin\")' cadena\n\n    \n    union all\n    \n\n\n    \n    SELECT\n        'application_name' tag_key, \n        'melistreams-pusher' tag_value,\n        '!=' operator,\n        '2023-08-01' from_date,\n        '2031-12-31' to_date,\n        '(application_name != \"melistreams-pusher\")' cadena\n\n    \n    union all\n    \n\n\n    \n    SELECT\n        'application_name' tag_key, \n        'melistreams' tag_value,\n        '!=' operator,\n        '2023-08-01' from_date,\n        '2031-12-31' to_date,\n        '(application_name != \"melistreams\")' cadena\n\n    \n    union all\n    \n\n\n    \n    SELECT\n        'application_name' tag_key, \n        'message-services-util' tag_value,\n        '!=' operator,\n        '2023-08-01' from_date,\n        '2031-12-31' to_date,\n        '(application_name != \"message-services-util\")' cadena\n\n    \n\n", "relation_name": "`metrics-streams-dev`.`TemporalData`.`substract_get_rules_fury`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T01:38:52.782925Z", "completed_at": "2024-06-07T01:38:53.905947Z"}, {"name": "execute", "started_at": "2024-06-07T01:38:53.908017Z", "completed_at": "2024-06-07T01:38:56.453774Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.6752333641052246, "adapter_response": {"_message": "CREATE TABLE (1.0 rows, 436.6 KiB processed)", "code": "CREATE TABLE", "rows_affected": 1, "bytes_processed": 447048, "bytes_billed": 10485760, "location": "US", "project_id": "metrics-streams-dev", "job_id": "cc20e3e1-5e1e-4d9f-986c-c6e33a77b2c7", "slot_ms": 420}, "message": "CREATE TABLE (1.0 rows, 436.6 KiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_last_dashOffFury_values", "compiled": true, "compiled_code": "-- depends_on: `metrics-streams-dev`.`TemporalData`.`final_last_snapshot`\nSELECT \n                    '20240607013700' sufijo, \n                    CURRENT_DATETIME('UTC') datetime,\n                    COUNT(1) records,\n                    COALESCE(SUM(CAST(total_cost AS FLOAT64)),null,0) total_cost\n            FROM  ProcessedData.BillingDashControlBaseOffFury\n            WHERE day BETWEEN '2024-06-01' AND  '2024-06-04'", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_last_dashOffFury_values`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T01:38:56.465153Z", "completed_at": "2024-06-07T01:39:00.178817Z"}, {"name": "execute", "started_at": "2024-06-07T01:39:00.180963Z", "completed_at": "2024-06-07T01:39:02.528480Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 6.067668437957764, "adapter_response": {"_message": "CREATE TABLE (1.0 rows, 249.7 KiB processed)", "code": "CREATE TABLE", "rows_affected": 1, "bytes_processed": 255664, "bytes_billed": 10485760, "location": "US", "project_id": "metrics-streams-dev", "job_id": "2b0e93e8-0d4b-4be8-a8a3-d622aefbd3c9", "slot_ms": 226}, "message": "CREATE TABLE (1.0 rows, 249.7 KiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_last_dashfury_values", "compiled": true, "compiled_code": "-- depends_on: `metrics-streams-dev`.`TemporalData`.`final_last_snapshot`\nSELECT \n                    '20240607013700' sufijo, \n                    CURRENT_DATETIME('UTC') datetime,\n                    COUNT(1) records,\n                    COALESCE(SUM(CAST(total_cost AS FLOAT64)),null,0) total_cost\n            FROM `metrics-streams-dev`.`ProcessedData`.`BillingDashControlBase`  \n            WHERE day BETWEEN '2024-06-01' AND  '2024-06-04'", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_last_dashfury_values`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T01:39:02.538239Z", "completed_at": "2024-06-07T01:39:03.722508Z"}, {"name": "execute", "started_at": "2024-06-07T01:39:03.724667Z", "completed_at": "2024-06-07T01:39:06.247300Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.713578224182129, "adapter_response": {"_message": "CREATE TABLE (1.0 rows, 57.7 MiB processed)", "code": "CREATE TABLE", "rows_affected": 1, "bytes_processed": 60519744, "bytes_billed": 60817408, "location": "US", "project_id": "metrics-streams-dev", "job_id": "b1767e48-ae80-4895-912c-8ef07417f0ac", "slot_ms": 1200}, "message": "CREATE TABLE (1.0 rows, 57.7 MiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_last_final_values", "compiled": true, "compiled_code": "-- depends on : `metrics-streams-dev`.`TemporalData`.`final_last_snapshot`  \nSELECT \n                            '20240607013700'  sufijo, \n                            CURRENT_DATETIME('UTC') datetime,\n                            COUNT(1) records,\n                            COALESCE(SUM(CAST(total_cost AS FLOAT64)),null,0) total_cost\n                          FROM ProcessedData.BillingfacAllocationFinal \n                          WHERE datetime BETWEEN '2024-06-01' AND  '2024-06-04'", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_last_final_values`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T01:39:06.258795Z", "completed_at": "2024-06-07T01:39:07.451247Z"}, {"name": "execute", "started_at": "2024-06-07T01:39:07.457202Z", "completed_at": "2024-06-07T01:39:09.737953Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.483726739883423, "adapter_response": {"_message": "CREATE TABLE (1.0 rows, 436.6 KiB processed)", "code": "CREATE TABLE", "rows_affected": 1, "bytes_processed": 447048, "bytes_billed": 10485760, "location": "US", "project_id": "metrics-streams-dev", "job_id": "ee5e1ef9-1b53-4d2c-88f6-a75c0584a04d", "slot_ms": 147}, "message": "CREATE TABLE (1.0 rows, 436.6 KiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_prev_dashOffFury_values", "compiled": true, "compiled_code": "-- depends_on: `metrics-streams-dev`.`TemporalData`.`final_last_snapshot`\nSELECT '20240607013700' sufijo,\n                PARSE_DATETIME('%Y%m%d%H%M%S', '20240607013700') datetime,\n                COUNT(1) records,\n                COALESCE(SUM(CAST(total_cost AS FLOAT64)),null,0) total_cost\n          FROM ProcessedData_REPRO_snapshots.BillingDashControlBaseOffFury_20240607013700\n          WHERE day BETWEEN '2024-06-01' AND '2024-06-04'", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_prev_dashOffFury_values`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T01:39:09.747962Z", "completed_at": "2024-06-07T01:39:10.894224Z"}, {"name": "execute", "started_at": "2024-06-07T01:39:10.896299Z", "completed_at": "2024-06-07T01:39:13.474237Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.7305638790130615, "adapter_response": {"_message": "CREATE TABLE (1.0 rows, 249.7 KiB processed)", "code": "CREATE TABLE", "rows_affected": 1, "bytes_processed": 255664, "bytes_billed": 10485760, "location": "US", "project_id": "metrics-streams-dev", "job_id": "8617c2ff-355a-48d1-a197-2b94be78d48f", "slot_ms": 193}, "message": "CREATE TABLE (1.0 rows, 249.7 KiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_prev_dashfury_values", "compiled": true, "compiled_code": "-- depends_on: `metrics-streams-dev`.`TemporalData`.`final_last_snapshot`\nSELECT '20240607013700' sufijo, \n                PARSE_DATETIME('%Y%m%d%H%M%S', '20240607013700') datetime,\n                COUNT(1) records,\n                COALESCE(SUM(CAST(total_cost AS FLOAT64)),null,0) total_cost \n          FROM ProcessedData_REPRO_snapshots.BillingDashControlBase_20240607013700\n          WHERE day BETWEEN '2024-06-01' AND '2024-06-04'", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_prev_dashfury_values`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T01:39:13.486372Z", "completed_at": "2024-06-07T01:39:14.773555Z"}, {"name": "execute", "started_at": "2024-06-07T01:39:14.775883Z", "completed_at": "2024-06-07T01:39:17.362826Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.882235527038574, "adapter_response": {"_message": "CREATE TABLE (1.0 rows, 57.7 MiB processed)", "code": "CREATE TABLE", "rows_affected": 1, "bytes_processed": 60519744, "bytes_billed": 60817408, "location": "US", "project_id": "metrics-streams-dev", "job_id": "4389df20-2f82-4bea-98c9-9f8719077df7", "slot_ms": 1383}, "message": "CREATE TABLE (1.0 rows, 57.7 MiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_prev_final_values", "compiled": true, "compiled_code": "-- depends_on: `metrics-streams-dev`.`TemporalData`.`final_last_snapshot`\nSELECT '20240607013700' sufijo, \n                PARSE_DATETIME('%Y%m%d%H%M%S', '20240607013700') datetime,\n                COUNT(1) records,\n                COALESCE(SUM(CAST(total_cost AS FLOAT64)),null,0) total_cost \n          FROM ProcessedData_REPRO_snapshots.BillingfacAllocationFinal_20240607013700\n          WHERE datetime BETWEEN '2024-06-01' AND '2024-06-04'", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_prev_final_values`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T01:39:17.374439Z", "completed_at": "2024-06-07T01:39:17.395416Z"}, {"name": "execute", "started_at": "2024-06-07T01:39:17.397797Z", "completed_at": "2024-06-07T01:39:23.322016Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 5.952287912368774, "adapter_response": {"_message": "MERGE (36.1k rows, 35.0 MiB processed)", "code": "MERGE", "rows_affected": 36140, "bytes_processed": 36750984, "bytes_billed": 41943040, "location": "US", "project_id": "metrics-streams-dev", "job_id": "26dfbb26-5dd3-456c-b740-dfe66349b9b7", "slot_ms": 23965}, "message": "MERGE (36.1k rows, 35.0 MiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.substract_all_in_one", "compiled": true, "compiled_code": "-- depends on : (<BigQueryRelation `metrics-streams-dev`.`TemporalData`.`substract_get_OffFury_aws`>, <BigQueryRelation `metrics-streams-dev`.`TemporalData`.`substract_get_OffFury_gcp`>, <BigQueryRelation `metrics-streams-dev`.`TemporalData`.`substract_get_OffFury_oci`>) \n\n\nSELECT * FROM `metrics-streams-dev`.`TemporalData`.`substract_get_OffFury_aws` \nUNION ALL \nSELECT * FROM `metrics-streams-dev`.`TemporalData`.`substract_get_OffFury_gcp`\nUNION ALL \nSELECT * FROM `metrics-streams-dev`.`TemporalData`.`substract_get_OffFury_oci`", "relation_name": "`metrics-streams-dev`.`ProcessedData`.`BillingtabOffFurysubtract`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T01:39:23.335180Z", "completed_at": "2024-06-07T01:39:23.344681Z"}, {"name": "execute", "started_at": "2024-06-07T01:39:23.346824Z", "completed_at": "2024-06-07T01:39:27.116429Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.787154197692871, "adapter_response": {"_message": "CREATE TABLE (52.3k rows, 9.8 MiB processed)", "code": "CREATE TABLE", "rows_affected": 52333, "bytes_processed": 10296282, "bytes_billed": 10485760, "location": "US", "project_id": "metrics-streams-dev", "job_id": "2b0a9ce2-67e6-4389-a3dd-61bbfb07e7d7", "slot_ms": 46360}, "message": "CREATE TABLE (52.3k rows, 9.8 MiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_tmp_BillingDashHistoFullSubstract", "compiled": true, "compiled_code": "\n\n   WITH \n    days_dummies AS (\n        SELECT days_gen FROM \n        UNNEST(GENERATE_DATE_ARRAY(PARSE_DATE('%F', '2022-01-01'), DATE(CURRENT_DATE() - INTERVAL 2 DAY) , INTERVAL 1 DAY))  AS days_gen\n        ),\n\n   only_real_service_type AS (\n        SELECT DISTINCT service_type \n        FROM `metrics-streams-dev`.`ProcessedData`.`BillingtabOffFurysubtract`  \n   ),\n\n    service_type_day_real AS (\n       SELECT DATE(datetime) day,\n            service_type,\n            ROUND(SUM(total_cost),2) total_cost,\n            COUNT(1) conteo\n       FROM `metrics-streams-dev`.`ProcessedData`.`BillingtabOffFurysubtract`  \n       WHERE service_type IS NOT NULL\n       GROUP BY 1,2\n       ),\n\n    service_type_dummies AS (\n       SELECT DISTINCT service_type\n       FROM only_real_service_type \n       WHERE service_type IS NOT NULL\n       ),\n\n    matriz_days_service_type AS (\n       SELECT A.days_gen, B.service_type \n       FROM days_dummies A, service_type_dummies B\n       ),\n\n    cruce_service_type_values AS (\n       SELECT A.days_gen day,\n              A.service_type,\n              COALESCE(B.total_cost,null,0) total_cost,\n              COALESCE(B.conteo,null,0) conteo\n       FROM matriz_days_service_type A\n       LEFT JOIN service_type_day_real B\n            ON (A.days_gen=B.day AND A.service_type=B.service_type)\n       )\n\n    SELECT * FROM cruce_service_type_values", "relation_name": "`metrics-streams-dev`.`TemporalData`.`BillingDashHistoFullSubstract`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T01:39:27.128627Z", "completed_at": "2024-06-07T01:39:27.148016Z"}, {"name": "execute", "started_at": "2024-06-07T01:39:27.150545Z", "completed_at": "2024-06-07T01:39:31.568290Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.4442973136901855, "adapter_response": {"_message": "CREATE TABLE (57.6k rows, 16.2 MiB processed)", "code": "CREATE TABLE", "rows_affected": 57604, "bytes_processed": 16968465, "bytes_billed": 20971520, "location": "US", "project_id": "metrics-streams-dev", "job_id": "a7aa59ac-0407-4ed0-9125-0949bb8973d4", "slot_ms": 21167}, "message": "CREATE TABLE (57.6k rows, 16.2 MiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_tmp_BillingfacgetBigquery", "compiled": true, "compiled_code": "-- depends on : `metrics-streams-dev`.`ProcessedData`.`BillingtabOffFurysubtract`\nSELECT \n          '237' AS idcatalogoorigen,\n          'Bigquery Meli-bi-data' AS nombrenemonico,\n          '63'  AS idproceso,\n          COALESCE(username,null,'No owner') AS generator_cost_name,\n          'No Aplica' AS account_id, \n          DATE(datetime) as datetime,\n          service_name, \n          service_type, \n          billing_key, \n          billing_usage_amount billing_usage_ammount, \n          total_cost,  \n          billing_concept, \n          billing_unit, \n          initiative_id, \n          initiative_external_code,\n          initiative_external_name,\n          head, \n          sponsor,\n          1 project_id, \n          'No aplica' project_code, \n          1 team_id, \n          'No aplica' team_name, \n          avenue_id, \n          avenue_name, \n          bu_id,bu_name, \n          super_bu_id, \n          super_bu_name, \n          load_date, \n          CURRENT_DATETIME('UTC') AS update_date,\n          'Test dbt' observation,\n          CAST('155' AS INT64)  as idprocesoanterior\n      FROM `metrics-streams-dev`.`ProcessedData`.`BillingtabBQMeliBIData`  AS BillingtabBQMeliBIData\n      WHERE DATE(datetime) >= '2024-06-01'\n            AND DATE(datetime) <= '2024-06-04'\n            AND EXISTS(SELECT 'X' FROM `metrics-streams-dev`.`TemporalData`.`final_tmp_process_output` as tempprocesos WHERE 155=tempprocesos.idproceso)", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_tmp_BillingfacgetBigquery`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T01:39:31.578578Z", "completed_at": "2024-06-07T01:39:31.589779Z"}, {"name": "execute", "started_at": "2024-06-07T01:39:31.591898Z", "completed_at": "2024-06-07T01:39:34.906599Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.332733154296875, "adapter_response": {"_message": "CREATE TABLE (11.3k rows, 4.4 MiB processed)", "code": "CREATE TABLE", "rows_affected": 11256, "bytes_processed": 4641281, "bytes_billed": 20971520, "location": "US", "project_id": "metrics-streams-dev", "job_id": "0c4278c0-483c-4209-9aa5-a28d508dcc43", "slot_ms": 14760}, "message": "CREATE TABLE (11.3k rows, 4.4 MiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_tmp_BillingfacgetDatamesh", "compiled": true, "compiled_code": "-- depends on : `metrics-streams-dev`.`ProcessedData`.`BillingtabOffFurysubtract`\nSELECT \n          '247'  AS idcatalogoorigen,\n          'Bigquery Datamesh' AS nombrenemonico,\n          '63'  AS idproceso,\n          COALESCE(service_name,null,'No owner') AS generator_cost_name,\n          'No Aplica' AS account_id, \n          DATE(datetime) as datetime,\n          service_name, \n          service_type, \n          billing_key, \n          billing_usage_amount billing_usage_ammount, \n          total_cost,  \n          billing_concept, \n          billing_unit, \n          initiative_id, \n          initiative_external_code,\n          initiative_external_name,\n          head, \n          sponsor,\n          1 project_id, \n          'No aplica' project_code, \n          1 team_id, \n          'No aplica' team_name, \n          avenue_id, \n          avenue_name, \n          bu_id,bu_name, \n          super_bu_id,\n          super_bu_name, \n          load_date, \n          CURRENT_DATETIME('UTC') AS update_date, \n          'Test dbt' observation,\n          CAST('155' AS INT64) as idprocesoanterior\n      FROM `metrics-streams-dev`.`ProcessedData`.`BillingtabBQDatamesh`  AS BillingtabBQDatamesh\n      WHERE DATE(datetime) >= '2024-06-01'\n            AND DATE(datetime) <= '2024-06-04'\n            AND EXISTS(SELECT 'X' FROM `metrics-streams-dev`.`TemporalData`.`final_tmp_process_output` as tempprocesos WHERE 155=tempprocesos.idproceso)", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_tmp_BillingfacgetDatamesh`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T01:39:34.917717Z", "completed_at": "2024-06-07T01:39:34.929980Z"}, {"name": "execute", "started_at": "2024-06-07T01:39:34.932350Z", "completed_at": "2024-06-07T01:39:40.036951Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 5.123533725738525, "adapter_response": {"_message": "CREATE TABLE (2.1m rows, 96.2 GiB processed)", "code": "CREATE TABLE", "rows_affected": 2077153, "bytes_processed": 103346040707, "bytes_billed": 103346601984, "location": "US", "project_id": "metrics-streams-dev", "job_id": "8c1b2c65-96a7-48a8-bdb0-18e15c7ec139", "slot_ms": 609036}, "message": "CREATE TABLE (2.1m rows, 96.2 GiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_tmp_BillingfacgetFury", "compiled": true, "compiled_code": "-- depends on : `metrics-streams-dev`.`ProcessedData`.`BillingtabOffFurysubtract`\nSELECT \n          '70'  AS idcatalogoorigen,\n          'Fury' AS nombrenemonico,\n          '63'  AS idproceso,\n          application_name AS generator_cost_name,\n          'No Aplica' AS account_id,\n          DATE(datetime) as datetime,\n          service_name, \n          service_type, \n          billing_key, \n          billing_usage_ammount,\n          total_cost,\n          billing_concept,\n          billing_unit,\n          initiative_id, \n          initiative_external_code,  \n          initiative_external_name, \n          head, \n          sponsor, \n          project_id, \n          project_code, \n          team_id, \n          team_name, \n          avenue_id, \n          avenue_name, \n          bu_id,bu_name, \n          super_bu_id,  \n          super_bu_name, \n          load_date, \n          CURRENT_DATETIME('UTC') AS update_date,\n          'Test dbt' observation,\n          idproceso  as idprocesoanterior\n      FROM `metrics-streams-dev`.`ProcessedData`.`BillingtabFuryAllocation` as BillingtabFury\n      WHERE DATE(datetime) >= '2024-06-01'\n            AND DATE(datetime) <= '2024-06-04'\n            AND NOT EXISTS(SELECT 'X' FROM `metrics-streams-dev`.`TemporalData`.`substract_get_rules_fury` as restarfury \n                           WHERE restarfury.tag_key='application_name' AND BillingtabFury.application_name=restarfury.tag_value )\n            AND EXISTS(SELECT 'X' FROM `metrics-streams-dev`.`TemporalData`.`final_tmp_process_output` as tempprocesos WHERE BillingtabFury.idproceso=tempprocesos.idproceso)", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_tmp_BillingfacgetFury`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T01:39:40.046693Z", "completed_at": "2024-06-07T01:39:40.057117Z"}, {"name": "execute", "started_at": "2024-06-07T01:39:40.059119Z", "completed_at": "2024-06-07T01:39:43.600192Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.5576107501983643, "adapter_response": {"_message": "CREATE TABLE (131.0 rows, 38.1 KiB processed)", "code": "CREATE TABLE", "rows_affected": 131, "bytes_processed": 38972, "bytes_billed": 20971520, "location": "US", "project_id": "metrics-streams-dev", "job_id": "729a2dc8-c61a-4283-894e-540cb27e0c6d", "slot_ms": 4404}, "message": "CREATE TABLE (131.0 rows, 38.1 KiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_tmp_BillingfacgetMelidata", "compiled": true, "compiled_code": "-- depends on : `metrics-streams-dev`.`ProcessedData`.`BillingtabOffFurysubtract`\nSELECT \n          '55'  AS idcatalogoorigen,\n          'Melidata' AS nombrenemonico,\n          '63'  AS idproceso,\n          username AS generator_cost_name, \n          'No Aplica' AS account_id, \n          DATE(datetime) as datetime,\n          service_name, \n          service_type, \n          billing_key, \n          CAST(billing_usage_amount AS numeric) billing_usage_amount, \n          CAST(total_cost AS numeric) total_cost,  \n          billing_concept, \n          billing_unit, \n          initiative_id, \n          initiative_external_code, \n          initiative_external_name, \n          head, \n          sponsor,\n          1 project_id, \n          'No aplica' project_code, \n          1 team_id, \n          'No aplica' team_name, \n          avenue_id, \n          avenue_name, \n          bu_id,bu_name, \n          super_bu_id, \n          super_bu_name, \n          load_date, \n          CURRENT_DATETIME('UTC') AS update_date, \n          'Test dbt' observation,\n          idproceso  as idprocesoanterior\n      FROM `metrics-streams-dev`.`ProcessedData`.`BillingtabMelidata`  AS BillingtabMelidata\n      WHERE DATE(datetime) >= '2024-06-01'\n            AND DATE(datetime) <= '2024-06-04'\n            AND EXISTS(SELECT 'X' FROM `metrics-streams-dev`.`TemporalData`.`final_tmp_process_output` as tempprocesos WHERE BillingtabMelidata.idproceso=tempprocesos.idproceso)", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_tmp_BillingfacgetMelidata`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T01:39:43.610710Z", "completed_at": "2024-06-07T01:39:43.622683Z"}, {"name": "execute", "started_at": "2024-06-07T01:39:43.624943Z", "completed_at": "2024-06-07T01:39:49.803469Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 6.196964502334595, "adapter_response": {"_message": "CREATE TABLE (327.2k rows, 179.1 MiB processed)", "code": "CREATE TABLE", "rows_affected": 327175, "bytes_processed": 187841669, "bytes_billed": 188743680, "location": "US", "project_id": "metrics-streams-dev", "job_id": "c0b84a25-7f74-45da-a42d-cd6da998ba19", "slot_ms": 29242}, "message": "CREATE TABLE (327.2k rows, 179.1 MiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_tmp_BillingfacgetOffFury", "compiled": true, "compiled_code": "-- depends on : `metrics-streams-dev`.`ProcessedData`.`BillingtabOffFurysubtract`\nSELECT \n          '72'  AS idcatalogoorigen,\n          'OffFury' AS nombrenemonico,\n          '63'  AS idproceso,\n          account_name AS generator_cost_name,\n          BillingtabOffFury.account_id,\n          DATE(BillingtabOffFury.datetime) as datetime,\n          BillingtabOffFury.service_name, \n          BillingtabOffFury.service_type, \n          BillingtabOffFury.billing_key, \n          ROUND((billing_usage_amount - IFNULL(billing_usage_ammount,0)),2) AS billing_usage_ammount,\n          ROUND((BillingtabOffFury.total_cost - IFNULL(BillingtabOffFurysubtract.total_cost,0)),2) AS total_cost,\n          billing_concept, \n          BillingtabOffFury.billing_unit, \n          CAST(initiative_id AS INT64) initiative_id,  \n          initiative_external_code, \n          initiative_external_name, \n          head, \n          sponsor, \n          1 project_id, \n          'No Aplica' project_code, \n          1 team_id, \n          'No Aplica' team_name,\n          CAST(avenue_id AS INT64) avenue_id , \n          avenue_name,\n          CAST(bu_id AS INT64) bu_id,\n          bu_name, \n          CAST(super_bu_id AS INT64) super_bu_id, \n          super_bu_name, \n          BillingtabOffFury.load_date, \n          CURRENT_DATETIME('UTC') AS update_date,\n          'Test dbt' observation, \n          BillingtabOffFury.idproceso  as idprocesoanterior\n      FROM `metrics-streams-dev`.`ProcessedData`.`BillingtabOffFury` as BillingtabOffFury\n      LEFT JOIN `metrics-streams-dev`.`ProcessedData`.`BillingtabOffFurysubtract` as BillingtabOffFurysubtract \n           ON (DATE(BillingtabOffFury.datetime) = DATE(BillingtabOffFurysubtract.datetime)\n              AND BillingtabOffFury.account_id  =BillingtabOffFurysubtract.account_id\n              AND BillingtabOffFury.service_type =BillingtabOffFurysubtract.service_type\n              AND BillingtabOffFury.billing_key =BillingtabOffFurysubtract.billing_key\n              AND BillingtabOffFury.service_name =BillingtabOffFurysubtract.service_name\n              AND BillingtabOffFury.billing_unit =BillingtabOffFurysubtract.billing_unit)\n      WHERE DATE(BillingtabOffFury.datetime) >= '2024-06-01'\n            AND DATE(BillingtabOffFury.datetime) <= '2024-06-04' \n            AND (BillingtabOffFury.total_cost - IFNULL(BillingtabOffFurysubtract.total_cost,0)) > 0 \n             AND EXISTS(SELECT 'X' FROM `metrics-streams-dev`.`TemporalData`.`final_tmp_process_output` as tempprocesos WHERE BillingtabOffFury.idproceso=tempprocesos.idproceso)", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_tmp_BillingfacgetOffFury`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T01:39:49.814952Z", "completed_at": "2024-06-07T01:39:49.828978Z"}, {"name": "execute", "started_at": "2024-06-07T01:39:49.830999Z", "completed_at": "2024-06-07T01:39:52.892912Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.0826539993286133, "adapter_response": {"_message": "CREATE TABLE (3.1k rows, 1.1 MiB processed)", "code": "CREATE TABLE", "rows_affected": 3078, "bytes_processed": 1137343, "bytes_billed": 20971520, "location": "US", "project_id": "metrics-streams-dev", "job_id": "4e43e825-4ae0-4413-933d-9d19865a33d8", "slot_ms": 18054}, "message": "CREATE TABLE (3.1k rows, 1.1 MiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_tmp_BillingfacgetOpenAI", "compiled": true, "compiled_code": "-- depends on : `metrics-streams-dev`.`ProcessedData`.`BillingtabOffFurysubtract`\nSELECT \n          '199'  AS idcatalogoorigen,\n          nombrenemonico,\n          '63' AS idproceso,\n          generator_cost_name, \n          account_id, \n          DATE(datetime) as datetime,\n          service_name, \n          service_type, \n          billing_key, \n          billing_usage_ammount, \n          total_cost,  \n          billing_concept, \n          billing_unit, \n          initiative_id, \n          initiative_external_code, \n          initiative_external_name, \n          head, \n          sponsor,\n          project_id, \n          project_code, \n          team_id, \n          team_name, \n          avenue_id, \n          avenue_name, \n          bu_id,\n          bu_name, \n          super_bu_id, \n          super_bu_name, \n          load_date, \n          CURRENT_DATETIME('UTC') AS update_date, \n          'Test dbt' observation,\n          CAST('151' AS INT64)  as idprocesoanterior\n      FROM `metrics-streams-dev`.`ProcessedData`.`BillingtabGENAI`  AS BillingtabGENAI\n      WHERE DATE(datetime) >= '2024-06-01'\n            AND DATE(datetime) <= '2024-06-04'\n            AND EXISTS(SELECT 'X' FROM `metrics-streams-dev`.`TemporalData`.`final_tmp_process_output` as tempprocesos WHERE 151=tempprocesos.idproceso)", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_tmp_BillingfacgetOpenAI`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T01:39:52.902196Z", "completed_at": "2024-06-07T01:39:52.913163Z"}, {"name": "execute", "started_at": "2024-06-07T01:39:52.915453Z", "completed_at": "2024-06-07T01:39:56.538844Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.6407923698425293, "adapter_response": {"_message": "CREATE TABLE (65.7k rows, 493.4 MiB processed)", "code": "CREATE TABLE", "rows_affected": 65739, "bytes_processed": 517392431, "bytes_billed": 517996544, "location": "US", "project_id": "metrics-streams-dev", "job_id": "99f56fd9-7fdc-42d8-9d80-303cbb2e5865", "slot_ms": 32468}, "message": "CREATE TABLE (65.7k rows, 493.4 MiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_tmp_BillingtabMelidataBIFinalCosts", "compiled": true, "compiled_code": "-- depends on : `metrics-streams-dev`.`ProcessedData`.`BillingtabOffFurysubtract`\nSELECT \n          '248'  AS idcatalogoorigen,\n          'melidata-storage' AS nombrenemonico,\n          '63'  AS idproceso,\n          application_name AS generator_cost_name,\n          'No Aplica' AS account_id, \n          DATE(datetime) datetime,\n          service_name, \n          service_type, \n          billing_key, \n          CAST(billing_usage_amount AS numeric) billing_usage_amount, \n          CAST(total_cost AS numeric) total_cost,  \n          billing_concept, \n          billing_unit, \n          initiative_id, \n          initiative_external_code, \n          initiative_external_name, \n          head,\n          sponsor,\n          1 project_id, \n          'No aplica' project_code, \n          1 team_id, \n          'No aplica' team_name, \n          avenue_id, \n          avenue_name, \n          bu_id,bu_name, \n          super_bu_id, \n          super_bu_name, \n          load_date, \n          CURRENT_DATETIME('UTC') AS update_date, \n          'Test dbt' observation,\n          210 AS idprocesoanterior\nFROM `metrics-streams-dev`.`ProcessedData`.`BillingtabMelidataBIFinalCosts`  AS BillingtabMelidata\n      WHERE DATE(datetime) >= '2024-06-01'\n            AND DATE(datetime) <= '2024-06-04'\n            AND EXISTS(SELECT 'X' FROM `metrics-streams-dev`.`TemporalData`.`final_tmp_process_output` as tempprocesos WHERE 210=tempprocesos.idproceso)", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_tmp_BillingtabMelidataBIFinalCosts`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T01:39:56.822160Z", "completed_at": "2024-06-07T01:39:56.833870Z"}, {"name": "execute", "started_at": "2024-06-07T01:39:56.836259Z", "completed_at": "2024-06-07T01:40:02.391332Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 5.574189901351929, "adapter_response": {"_message": "CREATE TABLE (2.5m rows, 1.0 GiB processed)", "code": "CREATE TABLE", "rows_affected": 2542136, "bytes_processed": 1116220270, "bytes_billed": 1116733440, "location": "US", "project_id": "metrics-streams-dev", "job_id": "5a1e4879-d1ff-4159-bfcd-6475fe04486f", "slot_ms": 94059}, "message": "CREATE TABLE (2.5m rows, 1.0 GiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_tmp_consolidate", "compiled": true, "compiled_code": "\n-- depends on : (<BigQueryRelation `metrics-streams-dev`.`TemporalData`.`final_tmp_BillingfacgetOffFury`>, <BigQueryRelation `metrics-streams-dev`.`TemporalData`.`final_tmp_BillingfacgetFury`>, <BigQueryRelation `metrics-streams-dev`.`TemporalData`.`final_tmp_BillingfacgetMelidata`>, <BigQueryRelation `metrics-streams-dev`.`TemporalData`.`final_tmp_BillingfacgetBigquery`>, <BigQueryRelation `metrics-streams-dev`.`TemporalData`.`final_tmp_BillingfacgetOpenAI`>, <BigQueryRelation `metrics-streams-dev`.`TemporalData`.`final_tmp_BillingfacgetDatamesh`>, Undefined)\n\n\nSELECT * FROM `metrics-streams-dev`.`TemporalData`.`final_tmp_BillingfacgetOffFury`\nUNION ALL \nSELECT * FROM `metrics-streams-dev`.`TemporalData`.`final_tmp_BillingfacgetFury`\nUNION ALL \nSELECT * FROM `metrics-streams-dev`.`TemporalData`.`final_tmp_BillingfacgetMelidata`\nUNION ALL \nSELECT * FROM `metrics-streams-dev`.`TemporalData`.`final_tmp_BillingfacgetBigquery`\nUNION ALL\nSELECT * FROM `metrics-streams-dev`.`TemporalData`.`final_tmp_BillingfacgetOpenAI`\nUNION ALL\nSELECT * FROM `metrics-streams-dev`.`TemporalData`.`final_tmp_BillingfacgetDatamesh`\nUNION ALL\nSELECT * FROM `metrics-streams-dev`.`TemporalData`.`final_tmp_BillingtabMelidataBIFinalCosts`", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_tmp_consolidate`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T01:40:02.402296Z", "completed_at": "2024-06-07T01:40:02.414578Z"}, {"name": "execute", "started_at": "2024-06-07T01:40:02.416581Z", "completed_at": "2024-06-07T01:40:14.479414Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 12.081529378890991, "adapter_response": {"_message": "CREATE TABLE (2.5m rows, 1.0 GiB processed)", "code": "CREATE TABLE", "rows_affected": 2504504, "bytes_processed": 1090798910, "bytes_billed": 1091567616, "location": "US", "project_id": "metrics-streams-dev", "job_id": "a0ca6634-ebbe-4c17-ab0e-b5827f7f1640", "slot_ms": 265719}, "message": "CREATE TABLE (2.5m rows, 1.0 GiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_prefacIT", "compiled": true, "compiled_code": "\n\n-- depends_on: `metrics-streams-dev`.`TemporalData`.`final_tmp_consolidate`\nSELECT  CAST(a.idcatalogoorigen AS INT64) idcatalogoorigen,   \n              a.nombrenemonico,\n              CAST(a.idproceso AS INT64) idproceso,\n              a.generator_cost_name,\n              a.account_id, \n              a.datetime,   \n              a.service_name,   \n              a.service_type,   \n              a.billing_key,\n              SUM(CAST(a.billing_usage_ammount AS NUMERIC)) billing_usage_ammount,   \n              SUM(CAST(a.total_cost AS NUMERIC)) total_cost,  \n              IF (a.idprocesoanterior=155, a.billing_key, a.billing_concept) billing_concept,\n              a.billing_unit,   \n              a.initiative_id,  \n              a.initiative_external_code, \n              LEFT(a.initiative_external_name,149)  initiative_external_name,\n              LEFT(a.head,149) head,\n              LEFT(a.sponsor,149) sponsor,\n              a.project_id,\n              LEFT(a.project_code,149) project_code,    \n              a.team_id,LEFT(a.team_name,149) team_name,\n              a.avenue_id, LEFT(a.avenue_name,149) avenue_name, \n              a.bu_id,\n              LEFT(a.bu_name,149) bu_name,\n              a.super_bu_id, \n              LEFT(a.super_bu_name,149) super_bu_name,\n              MIN(a.load_date) load_date,\n              MAX(a.update_date) update_date,\n              CONCAT('se sumaron ', CAST( COUNT(1) AS STRING), ' de registros') observation,\n              a.idprocesoanterior,\n              ARRAY_AGG(STRUCT(PARSE_JSON(\n                  CASE WHEN a.idprocesoanterior=155 THEN\n                       billing_concept\n                  ELSE\n                       '{\"N/A\":\"N/A\"}' \n                  END) AS user, CAST(billing_usage_ammount AS NUMERIC) AS billing_usage_ammount , CAST(total_cost  AS NUMERIC) AS total_cost)) AS consumption_type \n      FROM `metrics-streams-dev`.`TemporalData`.`final_tmp_consolidate` AS a\n      INNER JOIN \n        (SELECT \n            final.datetime,\n            final.generator_cost_name,\n            final.billing_key,\n            final.service_type,\n            final.service_name,\n            final.billing_unit\n         FROM `metrics-streams-dev`.`TemporalData`.`final_tmp_consolidate` AS  final\n         GROUP BY 1,2,3,4,5,6\n         HAVING COUNT(1)>1) b\n      ON      a.datetime=b.datetime\n          AND a.generator_cost_name =b.generator_cost_name\n          AND a.billing_key = b.billing_key\n          AND a.service_type = b.service_type\n          AND a.service_name = b.service_name\n          AND a.billing_unit= b.billing_unit\n      GROUP BY 1,2,3,4,5,6,7,8,9,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,32\n      UNION ALL\n      SELECT CAST(a.idcatalogoorigen AS INT64) idcatalogoorigen,\n             a.nombrenemonico,  \n             CAST(a.idproceso AS INT64) idproceso,\n             a.generator_cost_name,\n             a.account_id,\n             a.datetime,    \n             a.service_name,\n             a.service_type,\n             a.billing_key,\n             SUM(CAST(a.billing_usage_ammount AS NUMERIC)) billing_usage_ammount, \n             SUM(CAST(a.total_cost AS NUMERIC)) total_cost, \n             a.billing_concept,\n             a.billing_unit,\n             a.initiative_id,   \n             a.initiative_external_code,\n             LEFT(a.initiative_external_name,149) initiative_external_name,\n             LEFT(a.head,149) head,\n             LEFT(a.sponsor,149) sponsor,   \n             a.project_id,\n             LEFT(a.project_code,149) project_code, \n             a.team_id,\n             LEFT(a.team_name,149) team_name,\n             a.avenue_id,\n             LEFT(a.avenue_name,149) avenue_name,   \n             a.bu_id,\n             LEFT(a.bu_name,149) bu_name,   \n             a.super_bu_id,\n             LEFT(a.super_bu_name,149) super_bu_name,\n             MIN(a.load_date) load_date,   \n             MAX(a.update_date) update_date,\n             CONCAT('se sumaron ', CAST( COUNT(1) AS STRING), ' de registros') observation,\n             a.idprocesoanterior,\n             ARRAY_AGG(STRUCT(PARSE_JSON('{\"N/A\":\"N/A\"}') AS user, CAST(billing_usage_ammount AS NUMERIC) as billing_usage_ammount, CAST(total_cost AS NUMERIC) as total_cost )) AS consumption_type   \n      FROM `metrics-streams-dev`.`TemporalData`.`final_tmp_consolidate`  AS a\n      INNER JOIN \n      (SELECT \n             final.datetime,\n             final.generator_cost_name,\n             final.billing_key,\n             final.service_type, \n             final.service_name,\n             final.billing_unit\n        FROM `metrics-streams-dev`.`TemporalData`.`final_tmp_consolidate` final\n        GROUP BY 1,2,3,4,5,6\n        HAVING COUNT(1)=1) b \n      ON  (\n          a.datetime=b.datetime\n      AND a.generator_cost_name =b.generator_cost_name\n      AND a.billing_key = b.billing_key\n      AND a.service_type = b.service_type\n      AND a.service_name = b.service_name\n      AND a.billing_unit= b.billing_unit)\n      WHERE a.idprocesoanterior != 155\n      GROUP BY 1,2,3,4,5,6,7,8,9,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,32\n      UNION ALL\n      SELECT CAST(a.idcatalogoorigen AS INT64) idcatalogoorigen,\n             a.nombrenemonico,  \n             CAST(a.idproceso AS INT64) idproceso,\n             a.generator_cost_name,\n             a.account_id,\n             a.datetime,    \n             a.service_name,\n             a.service_type,\n             a.billing_key,\n             SUM(CAST(a.billing_usage_ammount AS NUMERIC)) billing_usage_ammount, \n             SUM(CAST(a.total_cost AS NUMERIC)) total_cost, \n             a.billing_key AS billing_concept,\n             a.billing_unit,\n             a.initiative_id,   \n             a.initiative_external_code,\n             LEFT(a.initiative_external_name,149) initiative_external_name,\n             LEFT(a.head,149) head,\n             LEFT(a.sponsor,149) sponsor,   \n             a.project_id,\n             LEFT(a.project_code,149) project_code, \n             a.team_id,\n             LEFT(a.team_name,149) team_name,\n             a.avenue_id,\n             LEFT(a.avenue_name,149) avenue_name,   \n             a.bu_id,\n             LEFT(a.bu_name,149) bu_name,   \n             a.super_bu_id,\n             LEFT(a.super_bu_name,149) super_bu_name,\n             MIN(a.load_date) load_date,   \n             MAX(a.update_date) update_date,\n             CONCAT('se sumaron ', CAST( COUNT(1) AS STRING), ' de registros') observation,\n             a.idprocesoanterior,\n             ARRAY_AGG(STRUCT(PARSE_JSON('{\"N/A\":\"N/A\"}') AS user, CAST(billing_usage_ammount AS NUMERIC) AS billing_usage_ammount, CAST(total_cost AS NUMERIC) AS total_cost )) AS consumption_type \n      FROM `metrics-streams-dev`.`TemporalData`.`final_tmp_consolidate` a  \n      INNER JOIN\n      (SELECT \n             final.datetime,\n             final.generator_cost_name,\n             final.billing_key,\n             final.service_type, \n             final.service_name,\n             final.billing_unit\n        FROM `metrics-streams-dev`.`TemporalData`.`final_tmp_consolidate` final\n        WHERE final.idprocesoanterior = 155\n        GROUP BY 1,2,3,4,5,6\n        HAVING COUNT(1)=1) b \n      ON  (\n          a.datetime=b.datetime\n      AND a.generator_cost_name =b.generator_cost_name\n      AND a.billing_key = b.billing_key\n      AND a.service_type = b.service_type\n      AND a.service_name = b.service_name\n      AND a.billing_unit= b.billing_unit)\n      WHERE a.idprocesoanterior = 155\n      GROUP BY 1,2,3,4,5,6,7,8,9,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,32", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_prefacIT`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T01:40:14.489761Z", "completed_at": "2024-06-07T01:40:14.508702Z"}, {"name": "execute", "started_at": "2024-06-07T01:40:14.511266Z", "completed_at": "2024-06-07T01:40:19.688910Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 5.203377962112427, "adapter_response": {"_message": "CREATE TABLE (107.0 rows, 407.0 MiB processed)", "code": "CREATE TABLE", "rows_affected": 107, "bytes_processed": 426787930, "bytes_billed": 427819008, "location": "US", "project_id": "metrics-streams-dev", "job_id": "a2957b47-aee6-4e43-b8a7-aea18f5553c1", "slot_ms": 26214}, "message": "CREATE TABLE (107.0 rows, 407.0 MiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_dupli_check_it", "compiled": true, "compiled_code": "\n\n\n        SELECT DATE(datetime) day\n              ,generator_cost_name\n              ,account_id\n              ,service_type  \n              ,billing_key\n              ,service_name\n              ,billing_unit \n              ,billing_concept\n              ,idprocesoanterior\n              ,COUNT(1) records\n              ,SUM(total_cost) total_cost\n        FROM `metrics-streams-dev`.`TemporalData`.`final_prefacIT`\n        GROUP BY 1,2,3,4,5,6,7,8,9\n        HAVING COUNT(*) > 1", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_dupli_check_it`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T01:40:21.295493Z", "completed_at": "2024-06-07T01:40:21.308867Z"}, {"name": "execute", "started_at": "2024-06-07T01:40:21.310867Z", "completed_at": "2024-06-07T01:40:24.611830Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.320627450942993, "adapter_response": {"_message": "CREATE TABLE (107.0 rows, 1.2 GiB processed)", "code": "CREATE TABLE", "rows_affected": 107, "bytes_processed": 1257315260, "bytes_billed": 1258291200, "location": "US", "project_id": "metrics-streams-dev", "job_id": "edd6da1b-96a9-494e-bda6-3490e4dd1893", "slot_ms": 26499}, "message": "CREATE TABLE (107.0 rows, 1.2 GiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_dupli_check_it_reinsert_it", "compiled": true, "compiled_code": "\n\n\n\n\n        WITH base_for_change AS (\n          SELECT A.* FROM `metrics-streams-dev`.`TemporalData`.`final_prefacIT` A \n          INNER JOIN `metrics-streams-dev`.`TemporalData`.`final_dupli_check_it`  B \n          ON (DATE(A.datetime) = B.day AND\n              A.generator_cost_name = B.generator_cost_name AND\n              A.account_id = B.account_id AND \n              A.service_type = B.service_type AND\n              A.billing_key = B.billing_key AND\n              A.service_name = B.service_name AND  \n              A.billing_unit = B.billing_unit AND \n              A.billing_concept = B.billing_concept AND \n              A.idprocesoanterior = B.idprocesoanterior)  \n        )\n\n        SELECT * FROM base_for_change \n        WHERE TRUE \n        QUALIFY ROW_NUMBER() \n        OVER (PARTITION BY \n                DATE(datetime),\n                generator_cost_name,\n                account_id,\n                service_type,\n                billing_key,\n                service_name,\n                billing_unit,\n                billing_concept,\n                idprocesoanterior\n                ORDER BY load_date DESC) = 1", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_dupli_check_it_reinsert_it`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T01:40:24.635406Z", "completed_at": "2024-06-07T01:40:24.644113Z"}, {"name": "execute", "started_at": "2024-06-07T01:40:24.646133Z", "completed_at": "2024-06-07T01:40:30.450185Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 5.818951845169067, "adapter_response": {"_message": "CREATE TABLE (2.5m rows, 1.2 GiB processed)", "code": "CREATE TABLE", "rows_affected": 2504397, "bytes_processed": 1257353896, "bytes_billed": 1258291200, "location": "US", "project_id": "metrics-streams-dev", "job_id": "252f2196-6b4e-4da0-80b1-0e93ae260e2d", "slot_ms": 94026}, "message": "CREATE TABLE (2.5m rows, 1.2 GiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_prefacIT_nodup", "compiled": true, "compiled_code": "\n\n\n\nWITH cut_duplis AS (SELECT * FROM `metrics-streams-dev`.`TemporalData`.`final_prefacIT`  A \n                    WHERE NOT EXISTS (SELECT 'X' FROM `metrics-streams-dev`.`TemporalData`.`final_dupli_check_it_reinsert_it` B WHERE\n                        A.datetime=B.datetime AND\n                        A.generator_cost_name = B.generator_cost_name AND\n                        A.account_id = B.account_id AND \n                        A.service_type = B.service_type AND\n                        A.billing_key = B.billing_key AND\n                        A.service_name = B.service_name AND  \n                        A.billing_unit = B.billing_unit AND \n                        A.billing_concept = B.billing_concept AND \n                        A.idprocesoanterior = B.idprocesoanterior) AND A.initiative_id IS NOT NULL\n                    )\n\nSELECT * FROM cut_duplis  \nUNION ALL\nSELECT * FROM `metrics-streams-dev`.`TemporalData`.`final_dupli_check_it_reinsert_it`", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_prefacIT_nodup`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T01:40:30.460805Z", "completed_at": "2024-06-07T01:40:30.470177Z"}, {"name": "execute", "started_at": "2024-06-07T01:40:30.472457Z", "completed_at": "2024-06-07T01:40:48.022988Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 17.566429615020752, "adapter_response": {"_message": "MERGE (2.5m rows, 147.1 GiB processed)", "code": "MERGE", "rows_affected": 2504397, "bytes_processed": 157917037541, "bytes_billed": 157917642752, "location": "US", "project_id": "metrics-streams-dev", "job_id": "77c10d3e-23e5-469f-8880-ae80a2b87317", "slot_ms": 4595267}, "message": "MERGE (2.5m rows, 147.1 GiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.BillingfacAllocationFinal", "compiled": true, "compiled_code": "-- depends_on: `metrics-streams-dev`.`TemporalData`.`final_prefacIT_nodup` \n\n\nSELECT * FROM `metrics-streams-dev`.`TemporalData`.`final_prefacIT_nodup`", "relation_name": "`metrics-streams-dev`.`ProcessedData`.`BillingfacAllocationFinal`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T01:40:48.032794Z", "completed_at": "2024-06-07T01:40:48.044736Z"}, {"name": "execute", "started_at": "2024-06-07T01:40:48.046650Z", "completed_at": "2024-06-07T01:40:54.212883Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 6.184170246124268, "adapter_response": {"_message": "CREATE TABLE (2.5m rows, 1.2 GiB processed)", "code": "CREATE TABLE", "rows_affected": 2504397, "bytes_processed": 1257248747, "bytes_billed": 1258291200, "location": "US", "project_id": "metrics-streams-dev", "job_id": "79f39643-af82-4d44-a276-83e4eaaf077f", "slot_ms": 90488}, "message": "CREATE TABLE (2.5m rows, 1.2 GiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_prefacFI", "compiled": true, "compiled_code": "-- depends_on: __dbt__cte__final_get_finance_limits\n\n\nWITH  __dbt__cte__final_get_finance_limits as (\n-- depends_on: `metrics-streams-dev`.`TemporalData`.`final_prefacIT`\n\n\n\n\n\n    \n    \n\n\nWITH get_current_day AS (\n    SELECT CASE WHEN CAST('7' AS INT64) >= 20 THEN \n         DATE(DATE_TRUNC(CURRENT_DATE(), month) )\n    ELSE\n         DATE(DATE_TRUNC(CURRENT_DATE(), month) - INTERVAL 1 MONTH )\n    END AS limit_finance),\n\n    get_range AS (SELECT limit_finance, \n           '2024-06-01' start_date, \n           '2024-06-04' end_date \n    FROM get_current_day), \n\n    get_limits_ind AS (\n    SELECT \n        CASE \n            WHEN  PARSE_DATE('%F', A.start_date) >= B.limit_finance AND PARSE_DATE('%F', A.end_date) >= B.limit_finance THEN\n                STRUCT(PARSE_DATE('%F', A.start_date) as start_date, PARSE_DATE('%F', A.end_date) as end_date) \n            WHEN  PARSE_DATE('%F', A.start_date) < B.limit_finance AND PARSE_DATE('%F', A.end_date) < B.limit_finance THEN\n                STRUCT(DATE(CURRENT_DATE('UTC') + INTERVAL 100 DAY) as start_date, DATE(CURRENT_DATE('UTC') + INTERVAL 100 DAY) as end_date) \n            WHEN  PARSE_DATE('%F', A.start_date) < B.limit_finance AND PARSE_DATE('%F', A.end_date) >= B.limit_finance THEN\n                STRUCT(B.limit_finance as start_date, DATE(A.end_date) as end_date ) \n       END AS output  \n    FROM get_range A , get_current_day B )\n\n    SELECT * FROM get_limits_ind\n    WHERE output IS NOT NULL\n), finance_limits AS (\n    SELECT output.start_date start_date, \n           output.end_date end_date \n    FROM __dbt__cte__final_get_finance_limits\n)\n\nSELECT A.* FROM `metrics-streams-dev`.`TemporalData`.`final_prefacIT_nodup` A , finance_limits B\nWHERE  DATE(A.datetime) BETWEEN B.start_date AND B.end_date", "relation_name": "`metrics-streams-dev`.`billing_wr_test`.`final_prefacFI`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T01:40:54.223010Z", "completed_at": "2024-06-07T01:40:54.241001Z"}, {"name": "execute", "started_at": "2024-06-07T01:40:54.243006Z", "completed_at": "2024-06-07T01:41:00.249771Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 6.030882358551025, "adapter_response": {"_message": "CREATE TABLE (2.7m rows, 6.6 GiB processed)", "code": "CREATE TABLE", "rows_affected": 2691158, "bytes_processed": 7041859410, "bytes_billed": 7042236416, "location": "US", "project_id": "metrics-streams-dev", "job_id": "62593834-92ad-43d4-b705-6912ea3b45e5", "slot_ms": 280164}, "message": "CREATE TABLE (2.7m rows, 6.6 GiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_tmp_BillingDashHistoFullAccountOffFury", "compiled": true, "compiled_code": "-- depends_on: `metrics-streams-dev`.`ProcessedData`.`BillingfacAllocationFinal`\n\n\n\n   WITH \n    days_dummies AS (\n        SELECT days_gen FROM \n        UNNEST(GENERATE_DATE_ARRAY(PARSE_DATE('%F', '2022-01-01'), DATE(CURRENT_DATE() - INTERVAL 2 DAY) , INTERVAL 1 DAY))  AS days_gen\n        ),\n\n    account_day_real AS (\n       SELECT DATE(datetime) day,\n            account_id, \n            account_name,\n            idproceso,\n            ROUND(SUM(total_cost),2) total_cost,\n            COUNT(1) conteo\n       FROM `metrics-streams-dev`.`ProcessedData`.`BillingtabOffFury` B \n       WHERE account_id IS NOT NULL AND account_name IS NOT NULL\n       GROUP BY 1,2,3,4\n       ),\n\n    account_dummies AS (\n       SELECT account_id, account_name, idproceso\n       FROM account_day_real \n       WHERE account_name IS NOT NULL AND account_id IS NOT NULL\n       GROUP BY 1,2,3 \n       ),\n\n    matriz_days_account AS (\n       SELECT A.days_gen, B.account_id , B.account_name, B.idproceso\n       FROM days_dummies A, account_dummies B\n       ),\n\n    cruce_account_values AS (\n       SELECT A.days_gen day,\n              A.account_id,\n              A.account_name,\n              A.idproceso,\n              COALESCE(B.total_cost,null,0) total_cost,\n              COALESCE(B.conteo,null,0) conteo\n       FROM matriz_days_account A\n       LEFT JOIN account_day_real B\n            ON (A.days_gen=B.day AND A.account_id=B.account_id AND A.account_name=B.account_name AND A.idproceso=B.idproceso)\n       )\n\n    SELECT * FROM cruce_account_values", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_tmp_BillingDashHistoFullAccountOffFury`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T01:41:00.259066Z", "completed_at": "2024-06-07T01:41:00.267628Z"}, {"name": "execute", "started_at": "2024-06-07T01:41:00.269580Z", "completed_at": "2024-06-07T01:41:19.725157Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 19.46981406211853, "adapter_response": {"_message": "MERGE (2.5m rows, 137.9 GiB processed)", "code": "MERGE", "rows_affected": 2504397, "bytes_processed": 148115912549, "bytes_billed": 148116602880, "location": "US", "project_id": "metrics-streams-dev", "job_id": "ee277b67-95b9-400f-8692-e3175e41c26f", "slot_ms": 4712756}, "message": "MERGE (2.5m rows, 137.9 GiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.BillingfacAllocationFinal_Finance", "compiled": true, "compiled_code": "\n\nSELECT * FROM `metrics-streams-dev`.`billing_wr_test`.`final_prefacFI`", "relation_name": "`metrics-streams-dev`.`ProcessedData`.`BillingfacAllocationFinal_Finance`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T01:41:19.734892Z", "completed_at": "2024-06-07T01:41:19.753766Z"}, {"name": "execute", "started_at": "2024-06-07T01:41:19.755981Z", "completed_at": "2024-06-07T01:41:24.877641Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 5.146878242492676, "adapter_response": {"_message": "CREATE TABLE (2.7m rows, 202.9 MiB processed)", "code": "CREATE TABLE", "rows_affected": 2691158, "bytes_processed": 212737193, "bytes_billed": 212860928, "location": "US", "project_id": "metrics-streams-dev", "job_id": "205bc65b-a3fd-4ed7-9e2a-484b8ff8b048", "slot_ms": 45045}, "message": "CREATE TABLE (2.7m rows, 202.9 MiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_BillingDashHistoFullAccountOffFury", "compiled": true, "compiled_code": "\n\nSELECT DISTINCT \n              day, \n              account_id, \n              account_name,\n              total_cost, \n              conteo,\n              ROW_NUMBER() OVER (PARTITION BY day ORDER BY total_cost DESC) AS ranking\nFROM `metrics-streams-dev`.`TemporalData`.`final_tmp_BillingDashHistoFullAccountOffFury`", "relation_name": "`metrics-streams-dev`.`TemporalData`.`BillingDashHistoFullAccountOffFury`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T01:41:24.887638Z", "completed_at": "2024-06-07T01:41:24.895442Z"}, {"name": "execute", "started_at": "2024-06-07T01:41:24.897369Z", "completed_at": "2024-06-07T01:41:28.484194Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.6004855632781982, "adapter_response": {"_message": "CREATE TABLE (18.6k rows, 202.9 MiB processed)", "code": "CREATE TABLE", "rows_affected": 18627, "bytes_processed": 212737193, "bytes_billed": 212860928, "location": "US", "project_id": "metrics-streams-dev", "job_id": "eaeab956-e5e9-4c86-9c87-fb427f1c69f6", "slot_ms": 34632}, "message": "CREATE TABLE (18.6k rows, 202.9 MiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_BillingDashControlBaseOffFury", "compiled": true, "compiled_code": "\n\n   WITH     \n    selected_base AS (\n      SELECT DATE(day) day,\n        account_id, \n        account_name,\n        total_cost,\n        conteo\n      FROM `metrics-streams-dev`.`TemporalData`.`BillingDashHistoFullAccountOffFury`  \n      QUALIFY ROW_NUMBER() OVER (PARTITION BY day ORDER BY total_cost DESC) <= 20\n      UNION ALL\n      SELECT day, \n             'ID_OTHERS' account_id, \n             'OTHERS ACCOUNTS TOP 20' account_name, \n             ROUND(SUM(total_cost),2) total_cost,\n             SUM(conteo) conteo\n      FROM (\n            SELECT DATE(day) day,\n                    account_id,\n                    account_name,\n                    total_cost,\n                    conteo\n            FROM  `metrics-streams-dev`.`TemporalData`.`BillingDashHistoFullAccountOffFury`\n            QUALIFY ROW_NUMBER() OVER (PARTITION BY day ORDER BY total_cost DESC) > 20)\n      GROUP BY 1,2,3  ) \n\n    SELECT *,\n        ROW_NUMBER() OVER (PARTITION BY day ORDER BY total_cost DESC) AS ranking \n    FROM selected_base\n    ORDER BY 1 DESC, 4 DESC", "relation_name": "`metrics-streams-dev`.`ProcessedData`.`BillingDashControlBaseOffFury`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T01:41:28.494854Z", "completed_at": "2024-06-07T01:41:28.513254Z"}, {"name": "execute", "started_at": "2024-06-07T01:41:28.515707Z", "completed_at": "2024-06-07T01:41:31.344416Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.8538551330566406, "adapter_response": {"_message": "CREATE TABLE (83.0 rows, 1.0 MiB processed)", "code": "CREATE TABLE", "rows_affected": 83, "bytes_processed": 1050713, "bytes_billed": 10485760, "location": "US", "project_id": "metrics-streams-dev", "job_id": "45f962b0-7084-439a-a04c-30fed36daa42", "slot_ms": 3860}, "message": "CREATE TABLE (83.0 rows, 1.0 MiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_BillingDashHistoRankingOffFury", "compiled": true, "compiled_code": "\n\nSELECT account_name, ARRAY_AGG(STRUCT (day, ranking, conteo, total_cost )) histo_rank \n          FROM `metrics-streams-dev`.`ProcessedData`.`BillingDashControlBaseOffFury`\n    GROUP BY account_name", "relation_name": "`metrics-streams-dev`.`billing_wr_test`.`BillingDashHistoRankingOffFury`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T01:41:31.356688Z", "completed_at": "2024-06-07T01:41:32.591712Z"}, {"name": "execute", "started_at": "2024-06-07T01:41:32.593659Z", "completed_at": "2024-06-07T01:41:35.432051Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.079973936080933, "adapter_response": {"_message": "CREATE TABLE (0.0 rows, 2.0 MiB processed)", "code": "CREATE TABLE", "rows_affected": 0, "bytes_processed": 2114966, "bytes_billed": 20971520, "location": "US", "project_id": "metrics-streams-dev", "job_id": "845e3e80-d57a-4365-ad54-b5c04f201319", "slot_ms": 21056}, "message": "CREATE TABLE (0.0 rows, 2.0 MiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_change_fury", "compiled": true, "compiled_code": "\n-- depends on : (<BigQueryRelation `metrics-streams-dev`.`billing_wr_test`.`BillingDashHistoRankingOffFury`>, <BigQueryRelation `metrics-streams-dev`.`TemporalData`.`final_last_snapshot`>)  \nWITH dif_1 AS (\n                SELECT day,\n                    idproceso,\n                    proceso,\n                    conteo,\n                    COALESCE(CAST(total_cost AS FLOAT64),null,0) AS total_cost  \n                FROM \n                `metrics-streams-dev`.`ProcessedData`.`BillingDashControlBase`\n                WHERE \n                day BETWEEN  '2024-06-01' \n                AND '2024-06-04'\n                EXCEPT \n                DISTINCT \n                SELECT day,\n                    idproceso,\n                    proceso,\n                    conteo,\n                    COALESCE(CAST(total_cost AS FLOAT64),null,0) AS total_cost \n                FROM \n                ProcessedData_REPRO_snapshots.BillingDashControlBase_20240607013700 \n                WHERE \n                day BETWEEN '2024-06-01' \n                AND '2024-06-04'\n            ),\n            \n             dif_2 AS (\n                 SELECT day,\n                 idproceso,\n                 proceso,\n                 conteo,\n                 COALESCE(CAST(total_cost AS FLOAT64),null,0) AS total_cost \n        FROM \n          ProcessedData_REPRO_snapshots.BillingDashControlBase_20240607013700 \n        WHERE \n          day BETWEEN '2024-06-01' \n          AND '2024-06-04' \n        EXCEPT \n          DISTINCT \n        SELECT day,\n               idproceso,\n               proceso,\n               conteo,\n               COALESCE(CAST(total_cost AS FLOAT64),null,0) AS total_cost         \n        FROM\n          `metrics-streams-dev`.`ProcessedData`.`BillingDashControlBase`\n        WHERE \n          day BETWEEN '2024-06-01' \n          AND '2024-06-04'\n      )\n        \n        SELECT 'LasttoPrev' sentido, * FROM dif_1\n        UNION ALL\n        SELECT 'PrevtoLast' sentido, * FROM dif_2", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_change_fury`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T01:41:35.441959Z", "completed_at": "2024-06-07T01:41:36.504784Z"}, {"name": "execute", "started_at": "2024-06-07T01:41:36.506768Z", "completed_at": "2024-06-07T01:41:39.673129Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.2351484298706055, "adapter_response": {"_message": "CREATE TABLE (0.0 rows, 2.6 MiB processed)", "code": "CREATE TABLE", "rows_affected": 0, "bytes_processed": 2771920, "bytes_billed": 20971520, "location": "US", "project_id": "metrics-streams-dev", "job_id": "1e1c0c30-47f6-43cc-a5c6-d2505611eac9", "slot_ms": 26068}, "message": "CREATE TABLE (0.0 rows, 2.6 MiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_change_offfury", "compiled": true, "compiled_code": "-- depends on : (<BigQueryRelation `metrics-streams-dev`.`billing_wr_test`.`BillingDashHistoRankingOffFury`>, <BigQueryRelation `metrics-streams-dev`.`TemporalData`.`final_last_snapshot`>)  \n\n\n        WITH dif_1 AS (\n                SELECT * \n                FROM `metrics-streams-dev`.`ProcessedData`.`BillingDashControlBaseOffFury`\n                WHERE \n                day BETWEEN  '2024-06-01' \n                AND '2024-06-04' \n                EXCEPT \n                DISTINCT \n                SELECT * \n                FROM \n                ProcessedData_REPRO_snapshots.BillingDashControlBaseOffFury_20240607013700 \n                WHERE \n                day BETWEEN '2024-06-01' \n                AND '2024-06-04'\n            ),\n            \n             dif_2 AS (\n                SELECT * \n                FROM \n                ProcessedData_REPRO_snapshots.BillingDashControlBaseOffFury_20240607013700 \n                WHERE \n                day BETWEEN '2024-06-01' \n                AND '2024-06-04' \n                EXCEPT \n                DISTINCT \n                SELECT *         \n                FROM\n                `metrics-streams-dev`.`ProcessedData`.`BillingDashControlBaseOffFury`\n                WHERE \n                day BETWEEN '2024-06-01' \n                AND '2024-06-04'\n            )\n        \n        SELECT 'LasttoPrev' sentido, * FROM dif_1\n        UNION ALL\n        SELECT 'PrevtoLast' sentido, * FROM dif_2", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_change_offfury`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T01:41:39.683430Z", "completed_at": "2024-06-07T01:41:40.828093Z"}, {"name": "execute", "started_at": "2024-06-07T01:41:40.830228Z", "completed_at": "2024-06-07T01:41:43.567358Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.8884501457214355, "adapter_response": {"_message": "CREATE TABLE (1.0 rows, 0 processed)", "code": "CREATE TABLE", "rows_affected": 1, "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "metrics-streams-dev", "job_id": "7e63a64b-1835-4463-8346-acd8ef826e04", "slot_ms": 145}, "message": "CREATE TABLE (1.0 rows, 0 processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_for_newrecord_fury", "compiled": true, "compiled_code": "-- depends_on: (<BigQueryRelation `metrics-streams-dev`.`TemporalData`.`final_last_snapshot`>, <BigQueryRelation `metrics-streams-dev`.`TemporalData`.`final_change_fury`>)\nSELECT   \n                '20240607013700' sufijo, \n                ARRAY_AGG(\n                STRUCT (\n                    COALESCE(day,null,DATE(CURRENT_DATE())) AS day,\n                    COALESCE(idproceso,null,0) AS idproceso,\n                    COALESCE(proceso,null,'EMPTY') AS proceso,\n                    COALESCE(sentido,null,'EMPTY') AS sentido,\n                    COALESCE(CAST(conteo AS FLOAT64),null,0) AS conteo,\n                    COALESCE(CAST(total_cost AS FLOAT64),null,0) AS total_cost\n                    )) AS value \n\n               FROM (SELECT CURRENT_DATE() day, \n                    0 idproceso,\n                    'NULL' proceso, \n                    'NULL' sentido,\n                    0 conteo, \n                    0 total_cost)", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_for_newrecord_fury`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T01:41:43.576607Z", "completed_at": "2024-06-07T01:41:44.706841Z"}, {"name": "execute", "started_at": "2024-06-07T01:41:44.708841Z", "completed_at": "2024-06-07T01:41:52.432586Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 8.860183000564575, "adapter_response": {"_message": "CREATE TABLE (1.0 rows, 0 processed)", "code": "CREATE TABLE", "rows_affected": 1, "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "metrics-streams-dev", "job_id": "b18b21a8-5e0f-4d45-a66b-daa53b9783b3", "slot_ms": 221}, "message": "CREATE TABLE (1.0 rows, 0 processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_for_newrecord_offfury", "compiled": true, "compiled_code": "-- depends_on: (<BigQueryRelation `metrics-streams-dev`.`TemporalData`.`final_last_snapshot`>, <BigQueryRelation `metrics-streams-dev`.`TemporalData`.`final_change_offfury`>)\nSELECT   \n                '20240607013700'  sufijo, \n                ARRAY_AGG(\n                STRUCT (\n                    COALESCE(day,null,DATE(CURRENT_DATE())) AS day,\n                    COALESCE(account_id,null,'EMPTY') AS account_id,\n                    COALESCE(account_name,null,'EMPTY') AS account_name,\n                    'N/A' AS responsable,\n                    COALESCE(sentido,null,'EMPTY') AS sentido,\n                    COALESCE(CAST(total_cost AS FLOAT64),null,0) AS total_cost,\n                    COALESCE(CAST(conteo AS INT64),null,0) AS conteo,\n                    COALESCE(CAST(ranking AS INT64),null,0) AS ranking\n                    )) AS value   \n            FROM (SELECT CURRENT_DATE() day, \n                  'NULL' account_id,\n                  'NULL' account_name, \n                  'N/A' responsable,\n                  'NULL' sentido,\n                  0 total_cost,\n                  0 conteo, \n                  0 ranking)", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_for_newrecord_offfury`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T01:41:52.445911Z", "completed_at": "2024-06-07T01:41:52.458315Z"}, {"name": "execute", "started_at": "2024-06-07T01:41:52.460933Z", "completed_at": "2024-06-07T01:41:55.744266Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.303896903991699, "adapter_response": {"_message": "CREATE TABLE (1.0 rows, 331.0 Bytes processed)", "code": "CREATE TABLE", "rows_affected": 1, "bytes_processed": 331, "bytes_billed": 83886080, "location": "US", "project_id": "metrics-streams-dev", "job_id": "b1022726-bba6-4e8e-a401-428852f6d2c4", "slot_ms": 5113}, "message": "CREATE TABLE (1.0 rows, 331.0 Bytes processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_new_record_bitacora", "compiled": true, "compiled_code": "-- depends on : (<BigQueryRelation `metrics-streams-dev`.`TemporalData`.`final_for_newrecord_fury`>, <BigQueryRelation `metrics-streams-dev`.`TemporalData`.`final_for_newrecord_offfury`>)  \n\n\n    SELECT \n      A.sufijo, \n      B.datetime,\n      'Test dbt' observation,\n      STRUCT(A.records, A.total_cost) AS last_final,\n      STRUCT(B.records, B.total_cost) AS prev_final,\n      STRUCT(C.records, C.total_cost) AS last_dash_fury,\n      STRUCT(D.records, D.total_cost) AS prev_dash_fury,\n      STRUCT(E.records, E.total_cost) AS last_dash_offfury,\n      STRUCT(F.records, F.total_cost) AS prev_dash_offfury,\n      (A.records    - B.records)    dif_final_records,\n      (A.total_cost - B.total_cost) dif_final_cost,\n      (C.records    - D.records)    dif_dash_fury_records,\n      (C.total_cost - D.total_cost) dif_dash_fury_cost,\n      (E.records    - F.records)    dif_dash_offfury_records,\n      (E.total_cost - F.total_cost) dif_dash_offfury_cost,\n      '2024-06-01'  date_start_repro,\n      '2024-06-04'  date_end_repro,\n      G.value struct_fury_dash, \n      H.value struct_offfury_dash\n    FROM  `metrics-streams-dev`.`TemporalData`.`final_last_final_values`                A \n        INNER JOIN `metrics-streams-dev`.`TemporalData`.`final_prev_final_values`       B  ON (A.sufijo=B.sufijo)\n        INNER JOIN `metrics-streams-dev`.`TemporalData`.`final_last_dashfury_values`    C  ON (A.sufijo=C.sufijo)\n        INNER JOIN `metrics-streams-dev`.`TemporalData`.`final_prev_dashfury_values`    D  ON (A.sufijo=D.sufijo)\n        INNER JOIN `metrics-streams-dev`.`TemporalData`.`final_last_dashOffFury_values` E  ON (A.sufijo=E.sufijo)\n        INNER JOIN `metrics-streams-dev`.`TemporalData`.`final_prev_dashOffFury_values` F  ON (A.sufijo=F.sufijo)\n        INNER JOIN `metrics-streams-dev`.`TemporalData`.`final_for_newrecord_fury`      G  ON (A.sufijo=G.sufijo)\n        INNER JOIN `metrics-streams-dev`.`TemporalData`.`final_for_newrecord_offfury`  H  ON (A.sufijo=H.sufijo)", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_new_record_bitacora`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T01:41:55.758468Z", "completed_at": "2024-06-07T01:41:57.197952Z"}, {"name": "execute", "started_at": "2024-06-07T01:41:57.200024Z", "completed_at": "2024-06-07T01:42:00.335902Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.582814455032349, "adapter_response": {"_message": "MERGE (1.0 rows, 2.6 KiB processed)", "code": "MERGE", "rows_affected": 1, "bytes_processed": 2709, "bytes_billed": 20971520, "location": "US", "project_id": "metrics-streams-dev", "job_id": "79d530a4-496a-4f4f-990a-002f63b478fe", "slot_ms": 13638}, "message": "MERGE (1.0 rows, 2.6 KiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.BillingBitacoraRepro", "compiled": true, "compiled_code": "-- depends on : `metrics-streams-dev`.`TemporalData`.`final_new_record_bitacora`  \n\n\n\nSELECT * FROM `metrics-streams-dev`.`TemporalData`.`final_new_record_bitacora`", "relation_name": "`metrics-streams-dev`.`billing_wr_test`.`BillingBitacoraRepro`"}], "elapsed_time": 254.96250772476196, "args": {"log_format_file": "debug", "send_anonymous_usage_stats": true, "use_colors": true, "indirect_selection": "eager", "project_dir": "/home/wilson_roldan/dbt_projects/dbt_final", "select": [], "write_json": true, "exclude": [], "vars": {"v_fecha_start": "2024-06-01", "v_fecha_end": "2024-06-04"}, "partial_parse": true, "populate_cache": true, "favor_state": false, "log_file_max_bytes": 10485760, "quiet": false, "static_parser": true, "printer_width": 80, "which": "run", "introspect": true, "use_colors_file": true, "log_format": "default", "invocation_command": "dbt run --vars {\"v_fecha_start\": \"2024-06-01\", \"v_fecha_end\":\"2024-06-04\"}", "cache_selected_only": false, "log_level": "info", "enable_legacy_logger": false, "profiles_dir": "/home/wilson_roldan/.dbt", "macro_debugging": false, "partial_parse_file_diff": true, "show_resource_report": false, "print": true, "strict_mode": false, "version_check": true, "log_level_file": "debug", "log_path": "/home/wilson_roldan/dbt_projects/dbt_final/logs", "warn_error_options": {"include": [], "exclude": []}, "defer": false}}