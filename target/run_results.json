{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.13", "generated_at": "2024-06-07T15:38:12.054160Z", "invocation_id": "57fd52f8-dbff-4943-bf26-02b72f565c26", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T15:33:14.595843Z", "completed_at": "2024-06-07T15:33:14.613884Z"}, {"name": "execute", "started_at": "2024-06-07T15:33:14.615885Z", "completed_at": "2024-06-07T15:33:22.030130Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 7.438652515411377, "adapter_response": {"_message": "CREATE TABLE (18.6k rows, 8.1 GiB processed)", "code": "CREATE TABLE", "rows_affected": 18641, "bytes_processed": 8729714125, "bytes_billed": 8730443776, "location": "US", "project_id": "metrics-streams-dev", "job_id": "c801cef0-25aa-49a9-a1e9-726226106858", "slot_ms": 1163526}, "message": "CREATE TABLE (18.6k rows, 8.1 GiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_BillingDashControlBase", "compiled": true, "compiled_code": "\n\nWITH \n    fecha_tablas AS (\n        SELECT table_id,\n               TIMESTAMP_MILLIS(last_modified_time) DateTIme_lastUpd, \n               row_count Count_rows, \n               size_bytes\n        FROM `metrics-streams-dev`.`ProcessedData`.`__TABLES__` ),\n\n    days_dummies AS (\n        SELECT days_gen FROM \n        UNNEST(GENERATE_DATE_ARRAY(PARSE_DATE('%F', '2022-01-01'), DATE(CURRENT_DATE() - INTERVAL 2 DAY) , INTERVAL 1 DAY))  AS days_gen\n        ),\n\n    pipelines_dummies AS (\n       SELECT idproceso, \n              proceso,\n              Responsable \n       FROM ManagementData.tproceso \n       WHERE idproceso in ( \n              SELECT DISTINCT idproceso FROM `metrics-streams-dev`.`ProcessedData`.`BillingtabFuryAllocation` WHERE idproceso NOT IN (88) \n              UNION ALL \n              SELECT 29 )),\n\n    pipes_day_real AS (\n       SELECT DATE(B.datetime) dia,\n                   B.idproceso, \n                   COUNT(1) conteo ,\n                   SUM(B.total_cost) total_cost\n       FROM `metrics-streams-dev`.`ProcessedData`.`BillingtabFuryAllocation` B \n       INNER JOIN pipelines_dummies C\n             ON(B.idproceso=C.idproceso)\n       GROUP BY 1,2 \n       UNION ALL\n       SELECT DATE(D.datetime) dia,\n                   29 idproceso, \n                   COUNT(1) conteo ,\n                   SUM(D.total_cost) total_cost\n       FROM `metrics-streams-dev`.`ProcessedData`.`BillingtabMelidata` D\n       GROUP BY 1,2\n       UNION ALL\n       SELECT DATE(E.datetime) dia,\n                   155 idproceso, \n                   COUNT(1) conteo ,\n                   SUM(E.total_cost) total_cost\n       FROM  `metrics-streams-dev`.`ProcessedData`.`BillingtabBQMeliBIData` E\n       GROUP BY 1,2 \n       UNION ALL\n       SELECT DATE(F.datetime) dia,\n                   155 idproceso, \n                   COUNT(1) conteo ,\n                   SUM(F.total_cost) total_cost\n       FROM  `metrics-streams-dev`.`ProcessedData`.`BillingtabGENAI` F\n       GROUP BY 1,2 \n       UNION ALL\n       SELECT DATE(G.datetime) dia,\n                   155 idproceso, \n                   COUNT(1) conteo ,\n                   SUM(G.total_cost) total_cost\n       FROM  `metrics-streams-dev`.`ProcessedData`.`BillingtabMelidataBIFinalCosts` G\n       GROUP BY 1,2 \n       ),\n\n    cruce_pipes_values AS (\n       SELECT A.*,\n              B.dia,\n              B.conteo,\n              B.total_cost \n       FROM pipelines_dummies A  \n       LEFT JOIN pipes_day_real B \n            ON (A.idproceso=B.idproceso) \n       ),\n\n    matriz_days_pipes AS (\n       SELECT * \n       FROM days_dummies, pipelines_dummies\n       ),\n\n    selected_base AS (\n       SELECT A.days_gen day, \n              A.idproceso,\n              A.proceso,\n              A.responsable,\n              ROUND(COALESCE(B.conteo,null,0),0) conteo,\n              ROUND(COALESCE(B.total_cost,null,0),2) total_cost \n       FROM  matriz_days_pipes A  \n       LEFT JOIN cruce_pipes_values B \n            ON (A.days_gen = B.dia AND A.idproceso=B.idproceso) \n       ) \n\n    SELECT A.*,\n      SUM(A.conteo)     OVER (PARTITION BY A.day ORDER BY day DESC) AS total_rows_day,\n      SUM(A.total_cost) OVER (PARTITION BY A.day ORDER BY day DESC) AS total_cost_day,\n      AVG(A.conteo)     OVER (PARTITION BY DATE(DATE_TRUNC(A.day , WEEK)), idproceso ) AS avg_rows_week,\n      AVG(A.total_cost) OVER (PARTITION BY DATE(DATE_TRUNC(A.day , WEEK)), idproceso ) AS avg_cost_week,\n      AVG(A.conteo)     OVER (PARTITION BY DATE(DATE_TRUNC(A.day , MONTH)), idproceso ) AS avg_rows_month,\n      AVG(A.total_cost) OVER (PARTITION BY DATE(DATE_TRUNC(A.day , MONTH)),idproceso ) AS avg_cost_month \n   FROM selected_base A", "relation_name": "`metrics-streams-dev`.`ProcessedData`.`BillingDashControlBase`"}, {"status": "warn", "timing": [{"name": "compile", "started_at": "2024-06-07T15:33:22.039862Z", "completed_at": "2024-06-07T15:33:22.051148Z"}, {"name": "execute", "started_at": "2024-06-07T15:33:22.053086Z", "completed_at": "2024-06-07T15:33:23.689825Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.6539537906646729, "adapter_response": {"_message": "SELECT (1.0 rows, 1.6 KiB processed)", "code": "SELECT", "rows_affected": 1, "bytes_processed": 1624, "bytes_billed": 10485760, "location": "US", "project_id": "metrics-streams-dev", "job_id": "48649759-07ba-4a0a-9f2d-56daa7c571c4", "slot_ms": 12458}, "message": "Got 7 results, configured to warn if != 0", "failures": 7, "unique_id": "test.BillingfacAllocationFinal.final_val_int_list_test", "compiled": true, "compiled_code": "\n\n\n\nWITH \n    full_proc AS (SELECT DISTINCT idprocesopadre as idproceso FROM `metrics-streams-dev`.`ManagementData`.`tproceso` ), \n     \n        get_lista AS (SELECT '[3, 56, 66, 151, 155, 29]' as lista_in),\n      \n    list_cut AS (SELECT REPLACE(REPLACE(REPLACE(lista_in,'[',''),']',''),' ','')  as lista_cut FROM get_lista ),\n    proc_input AS (SELECT ARRAY_CONCAT(ARRAY_AGG(CAST(listado AS INT64)),[44]) array_process\n                                FROM list_cut , UNNEST(SPLIT(lista_cut)) AS listado),\n    partial_list AS (SELECT idproceso FROM proc_input , UNNEST(array_process) AS idproceso),                           \n    proc_output AS (SELECT A.idproceso FROM partial_list A WHERE EXISTS(SELECT 'X' FROM full_proc B WHERE A.idproceso = B.idproceso))                            \n\n    SELECT * FROM proc_output", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T15:33:23.699276Z", "completed_at": "2024-06-07T15:33:23.707608Z"}, {"name": "execute", "started_at": "2024-06-07T15:33:23.709614Z", "completed_at": "2024-06-07T15:33:26.978661Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.2833704948425293, "adapter_response": {"_message": "CREATE TABLE (7.0 rows, 1.6 KiB processed)", "code": "CREATE TABLE", "rows_affected": 7, "bytes_processed": 1624, "bytes_billed": 10485760, "location": "US", "project_id": "metrics-streams-dev", "job_id": "66df5291-1b2a-4c9d-b139-1efb4c656126", "slot_ms": 13013}, "message": "CREATE TABLE (7.0 rows, 1.6 KiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_tmp_process_output", "compiled": true, "compiled_code": "\n\n\n\nWITH \n    get_lista AS (SELECT '[3, 56, 66, 151, 155, 29]' as lista_in),\n    full_proc AS (SELECT DISTINCT idprocesopadre as idproceso FROM `metrics-streams-dev`.`ManagementData`.`tproceso` ),\n    list_cut AS (SELECT REPLACE(REPLACE(REPLACE(lista_in,'[',''),']',''),' ','')  as lista_cut FROM get_lista ),\n    proc_input AS (SELECT ARRAY_CONCAT(ARRAY_AGG(CAST(listado AS INT64)),[44]) array_process\n                                FROM list_cut , UNNEST(SPLIT(lista_cut)) AS listado),\n    partial_list AS (SELECT idproceso FROM proc_input , UNNEST(array_process) AS idproceso),                           \n    proc_output AS (SELECT A.idproceso FROM partial_list A WHERE EXISTS(SELECT 'X' FROM full_proc B WHERE A.idproceso = B.idproceso))                            \n\n    \n    SELECT * FROM \n       proc_output\n    ", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_tmp_process_output`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T15:33:26.988860Z", "completed_at": "2024-06-07T15:33:41.532730Z"}, {"name": "execute", "started_at": "2024-06-07T15:33:41.534772Z", "completed_at": "2024-06-07T15:33:45.007436Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 18.022581815719604, "adapter_response": {"_message": "CREATE TABLE (887.0 rows, 7.5 GiB processed)", "code": "CREATE TABLE", "rows_affected": 887, "bytes_processed": 8023003896, "bytes_billed": 8023703552, "location": "US", "project_id": "metrics-streams-dev", "job_id": "9ab5ee20-5517-4b8c-8977-61de42842ff2", "slot_ms": 366836}, "message": "CREATE TABLE (887.0 rows, 7.5 GiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_last_snapshot", "compiled": true, "compiled_code": "-- depends_on: `metrics-streams-dev`.`TemporalData`.`final_tmp_process_output`\nSELECT DATE(datetime) day_snap, '20240607153300' sufijo , COUNT(1) records_snap, CAST(ROUND(SUM(total_cost),0) AS INT64) cost_snap \n        FROM ProcessedData_REPRO_snapshots.BillingfacAllocationFinal_20240607153300  \n        GROUP BY 1", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_last_snapshot`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T15:33:45.017737Z", "completed_at": "2024-06-07T15:33:49.859102Z"}, {"name": "execute", "started_at": "2024-06-07T15:33:49.861238Z", "completed_at": "2024-06-07T15:34:10.978413Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 25.965233325958252, "adapter_response": {"_message": "CREATE TABLE (35.4k rows, 68.9 GiB processed)", "code": "CREATE TABLE", "rows_affected": 35360, "bytes_processed": 73937254649, "bytes_billed": 73938239488, "location": "US", "project_id": "metrics-streams-dev", "job_id": "882612df-557c-4ce0-9a10-531673951059", "slot_ms": 2343346}, "message": "CREATE TABLE (35.4k rows, 68.9 GiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.substract_get_OffFury_aws", "compiled": true, "compiled_code": "-- depends on : `metrics-streams-dev`.`TemporalData`.`final_tmp_process_output` \n\n\n\n\n\n\n\n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n\n\n\n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n\n\n\n\n\nSELECT \n        cast(timestamp_trunc(line_item_usage_start_date,DAY) as DATETIME) as datetime,\n        line_item_usage_account_id as account_id\n        ,product_product_name as service_type\n        ,line_item_usage_type as billing_key      \n        ,CASE WHEN resource_tags_user_cloudcontroller_stack= '' or resource_tags_user_cloudcontroller_stack is null THEN\n          'NO-STACK'\n        ELSE\n          resource_tags_user_cloudcontroller_stack\n        END as service_name\n        ,cast(SUM(CASE WHEN line_item_line_item_type = 'DiscountedUsage' THEN \n            reservation_effective_cost\n            WHEN line_item_line_item_type = 'Usage' THEN \n              line_item_unblended_cost\n            WHEN line_item_line_item_type = 'SavingsPlanCoveredUsage' THEN\n              savings_plan_savings_plan_effective_cost\n            WHEN line_item_line_item_type = 'Fee' \n                  AND product_product_name in ('AWS Premium Support','OCBOCBAWSDirectConnect') or bill_billing_entity = 'AWS Marketplace' THEN \n                line_item_unblended_cost\n            END) as numeric) as total_cost\n        ,pricing_unit as billing_unit\n        ,cast(SUM(line_item_usage_amount) as numeric) as billing_usage_ammount\n        ,'AWS' as provider\n        ,current_date()  load_date  \n        ,current_date() update_date\n        ,'Test Final dbt' as observation\n        FROM `metrics-streams-dev`.`RawData`.`billing_edp`  \n        WHERE year >= 2024\n              and year <= 2024\n              and month >= 6\n              and month <=  6\n              and date(line_item_usage_start_date) >= '2024-06-01'  and date(line_item_usage_start_date) <='2024-06-04' \n              AND line_item_line_item_type IN ('DiscountedUsage', 'Usage', 'RIFee', 'SavingsPlanCoveredUsage', 'Fee')\n              AND line_item_usage_type NOT LIKE '%HeavyUsage%' \n               AND (   ( line_item_usage_account_id = \"165742082170\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  ( line_item_usage_account_id = \"698901797328\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  ( line_item_usage_account_id = \"150890519415\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  ( line_item_usage_account_id = \"122375311039\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  ( line_item_usage_account_id = \"047141863347\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  ( line_item_usage_account_id = \"272718278578\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  ( line_item_usage_account_id = \"886495075632\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  ( line_item_usage_account_id = \"958338282214\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  ( line_item_usage_account_id = \"537757959597\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  ( line_item_usage_account_id = \"621237723456\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  ( line_item_usage_account_id = \"690399877577\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  ( line_item_usage_account_id = \"796854892605\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  ( line_item_usage_account_id = \"796854892605\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  ( line_item_usage_account_id = \"751671831563\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  ( line_item_usage_account_id = \"270916447595\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  ( line_item_usage_account_id = \"750993754488 \" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\"))  OR (line_item_line_item_description like \"%Conditional Deal%\" AND  line_item_usage_account_id = \"736370371722\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_operation  =  \"NatGateway\" AND  line_item_usage_account_id = \"736370371722\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonCloudFront\" AND  line_item_usage_account_id = \"558628470851\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"awswaf\" AND  line_item_usage_account_id = \"537757959597\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonRoute53\" AND  line_item_usage_account_id = \"958338282214\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"awswaf\" AND  line_item_usage_account_id = \"019704497826\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonCloudFront\" AND  line_item_usage_account_id = \"537757959597\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSShield\" AND  line_item_usage_account_id = \"537757959597\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSCertificateManager\" AND  line_item_usage_account_id = \"047141863347\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSDirectConnect\" AND  line_item_usage_account_id = \"537757959597\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSCertificateManager\" AND  line_item_usage_account_id = \"070958878125\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSDirectConnect\" AND  line_item_usage_account_id = \"690399877577\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonRoute53\" AND  line_item_usage_account_id = \"558628470851\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSShield\" AND  line_item_usage_account_id = \"128464316945\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSDirectConnect\" AND  line_item_usage_account_id = \"598925332888\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonCloudFront\" AND  line_item_usage_account_id = \"749651711864\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonCloudFront\" AND  line_item_usage_account_id = \"598925332888\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonCloudFront\" AND  line_item_usage_account_id = \"913292487988\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonCloudFront\" AND  line_item_usage_account_id = \"955895235416\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonVPC\" AND  line_item_usage_account_id = \"558628470851\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonVPC\" AND  line_item_usage_account_id = \"961618667388\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonCloudFront\" AND  line_item_usage_account_id = \"281193985665\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonApiGateway\" AND  line_item_usage_account_id = \"830619001108\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonCloudFront\" AND  line_item_usage_account_id = \"621237723456\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSCertificateManager\" AND  line_item_usage_account_id = \"558628470851\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSDirectConnect\" AND  line_item_usage_account_id = \"767428572615\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"awswaf\" AND  line_item_usage_account_id = \"047141863347\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSShield\" AND  line_item_usage_account_id = \"767428572615\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSCertificateManager\" AND  line_item_usage_account_id = \"205860777463\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonVPC\" AND  line_item_usage_account_id = \"621237723456\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSShield\" AND  line_item_usage_account_id = \"961618667388\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSDirectConnect\" AND  line_item_usage_account_id = \"128464316945\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonRoute53\" AND  line_item_usage_account_id = \"470332157166\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonRoute53\" AND  line_item_usage_account_id = \"749651711864\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonVPC\" AND  line_item_usage_account_id = \"128464316945\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonVPC\" AND  line_item_usage_account_id = \"913292487988\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonRoute53\" AND  line_item_usage_account_id = \"690399877577\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonRoute53\" AND  line_item_usage_account_id = \"047141863347\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"awswaf\" AND  line_item_usage_account_id = \"961618667388\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonVPC\" AND  line_item_usage_account_id = \"070958878125\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSCertificateManager\" AND  line_item_usage_account_id = \"621237723456\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"awswaf\" AND  line_item_usage_account_id = \"830619001108\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonApiGateway\" AND  line_item_usage_account_id = \"205860777463\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonCloudFront\" AND  line_item_usage_account_id = \"047141863347\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonRoute53\" AND  line_item_usage_account_id = \"205860777463\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSCertificateManager\" AND  line_item_usage_account_id = \"019704497826\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonApiGateway\" AND  line_item_usage_account_id = \"537757959597\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonApiGateway\" AND  line_item_usage_account_id = \"128464316945\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonVPC\" AND  line_item_usage_account_id = \"019704497826\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonVPC\" AND  line_item_usage_account_id = \"281193985665\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSCertificateManager\" AND  line_item_usage_account_id = \"598925332888\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonApiGateway\" AND  line_item_usage_account_id = \"070958878125\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonRoute53\" AND  line_item_usage_account_id = \"913292487988\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonApiGateway\" AND  line_item_usage_account_id = \"767428572615\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonApiGateway\" AND  line_item_usage_account_id = \"558628470851\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonRoute53\" AND  line_item_usage_account_id = \"736370371722\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"awswaf\" AND  line_item_usage_account_id = \"470332157166\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSShield\" AND  line_item_usage_account_id = \"470332157166\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSDirectConnect\" AND  line_item_usage_account_id = \"047141863347\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonCloudFront\" AND  line_item_usage_account_id = \"830619001108\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"awswaf\" AND  line_item_usage_account_id = \"621237723456\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonRoute53\" AND  line_item_usage_account_id = \"598925332888\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSShield\" AND  line_item_usage_account_id = \"205860777463\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonCloudFront\" AND  line_item_usage_account_id = \"019704497826\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSCertificateManager\" AND  line_item_usage_account_id = \"961618667388\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonElastiCache\" AND  line_item_usage_account_id = \"736370371722\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonVPC\" AND  line_item_usage_account_id = \"205860777463\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"awswaf\" AND  line_item_usage_account_id = \"767428572615\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonRoute53\" AND  line_item_usage_account_id = \"070958878125\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonApiGateway\" AND  line_item_usage_account_id = \"736370371722\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSShield\" AND  line_item_usage_account_id = \"736370371722\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonVPC\" AND  line_item_usage_account_id = \"958338282214\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonApiGateway\" AND  line_item_usage_account_id = \"019704497826\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonEC2\" AND  line_item_usage_account_id = \"598925332888\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSELB\" AND  line_item_usage_account_id = \"019704497826\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSCertificateManager\" AND  line_item_usage_account_id = \"470332157166\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonCloudFront\" AND  line_item_usage_account_id = \"736370371722\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"awswaf\" AND  line_item_usage_account_id = \"736370371722\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSShield\" AND  line_item_usage_account_id = \"019704497826\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonRoute53\" AND  line_item_usage_account_id = \"767428572615\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSCertificateManager\" AND  line_item_usage_account_id = \"830619001108\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"awswaf\" AND  line_item_usage_account_id = \"281193985665\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonApiGateway\" AND  line_item_usage_account_id = \"598925332888\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonRoute53\" AND  line_item_usage_account_id = \"537757959597\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"awswaf\" AND  line_item_usage_account_id = \"205860777463\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonCloudFront\" AND  line_item_usage_account_id = \"961618667388\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"awswaf\" AND  line_item_usage_account_id = \"128464316945\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonApiGateway\" AND  line_item_usage_account_id = \"961618667388\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"awswaf\" AND  line_item_usage_account_id = \"749651711864\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonRoute53\" AND  line_item_usage_account_id = \"961618667388\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonVPC\" AND  line_item_usage_account_id = \"598925332888\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonApiGateway\" AND  line_item_usage_account_id = \"047141863347\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSShield\" AND  line_item_usage_account_id = \"047141863347\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonVPC\" AND  line_item_usage_account_id = \"767428572615\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSCertificateManager\" AND  line_item_usage_account_id = \"690399877577\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonCloudFront\" AND  line_item_usage_account_id = \"070958878125\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSCertificateManager\" AND  line_item_usage_account_id = \"537757959597\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSCertificateManager\" AND  line_item_usage_account_id = \"958338282214\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSDirectConnect\" AND  line_item_usage_account_id = \"470332157166\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSShield\" AND  line_item_usage_account_id = \"830619001108\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSShield\" AND  line_item_usage_account_id = \"749651711864\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSShield\" AND  line_item_usage_account_id = \"690399877577\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSCertificateManager\" AND  line_item_usage_account_id = \"749651711864\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"awswaf\" AND  line_item_usage_account_id = \"913292487988\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSShield\" AND  line_item_usage_account_id = \"913292487988\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSCertificateManager\" AND  line_item_usage_account_id = \"767428572615\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonCloudFront\" AND  line_item_usage_account_id = \"690399877577\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSShield\" AND  line_item_usage_account_id = \"070958878125\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonRoute53\" AND  line_item_usage_account_id = \"019704497826\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSDirectConnect\" AND  line_item_usage_account_id = \"958338282214\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonApiGateway\" AND  line_item_usage_account_id = \"470332157166\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSCertificateManager\" AND  line_item_usage_account_id = \"281193985665\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSDirectConnect\" AND  line_item_usage_account_id = \"830619001108\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonRoute53\" AND  line_item_usage_account_id = \"621237723456\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonCloudFront\" AND  line_item_usage_account_id = \"470332157166\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonVPC\" AND  line_item_usage_account_id = \"830619001108\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonDynamoDB\" AND  line_item_usage_account_id = \"019704497826\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSDirectConnect\" AND  line_item_usage_account_id = \"019704497826\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSDirectConnect\" AND  line_item_usage_account_id = \"955895235416\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSShield\" AND  line_item_usage_account_id = \"958338282214\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonApiGateway\" AND  line_item_usage_account_id = \"913292487988\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonApiGateway\" AND  line_item_usage_account_id = \"281193985665\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"awswaf\" AND  line_item_usage_account_id = \"958338282214\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSShield\" AND  line_item_usage_account_id = \"558628470851\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonCloudFront\" AND  line_item_usage_account_id = \"128464316945\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonVPC\" AND  line_item_usage_account_id = \"047141863347\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonVPC\" AND  line_item_usage_account_id = \"736370371722\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonApiGateway\" AND  line_item_usage_account_id = \"690399877577\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSDirectConnect\" AND  line_item_usage_account_id = \"621237723456\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"awswaf\" AND  line_item_usage_account_id = \"598925332888\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSDirectConnect\" AND  line_item_usage_account_id = \"558628470851\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonApiGateway\" AND  line_item_usage_account_id = \"958338282214\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"awswaf\" AND  line_item_usage_account_id = \"070958878125\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonRoute53\" AND  line_item_usage_account_id = \"128464316945\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonCloudFront\" AND  line_item_usage_account_id = \"767428572615\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"awswaf\" AND  line_item_usage_account_id = \"690399877577\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSShield\" AND  line_item_usage_account_id = \"598925332888\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonVPC\" AND  line_item_usage_account_id = \"470332157166\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonRoute53\" AND  line_item_usage_account_id = \"830619001108\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSDirectConnect\" AND  line_item_usage_account_id = \"736370371722\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonCloudFront\" AND  line_item_usage_account_id = \"958338282214\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSShield\" AND  line_item_usage_account_id = \"955895235416\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonVPC\" AND  line_item_usage_account_id = \"537757959597\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonCloudFront\" AND  line_item_usage_account_id = \"205860777463\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSELB\" AND  line_item_usage_account_id = \"736370371722\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonApiGateway\" AND  line_item_usage_account_id = \"955895235416\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSCertificateManager\" AND  line_item_usage_account_id = \"128464316945\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonVPC\" AND  line_item_usage_account_id = \"955895235416\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSDirectConnect\" AND  line_item_usage_account_id = \"281193985665\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSCertificateManager\" AND  line_item_usage_account_id = \"736370371722\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSDirectConnect\" AND  line_item_usage_account_id = \"749651711864\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSDirectConnect\" AND  line_item_usage_account_id = \"961618667388\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonRoute53\" AND  line_item_usage_account_id = \"955895235416\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonVPC\" AND  line_item_usage_account_id = \"749651711864\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSDirectConnect\" AND  line_item_usage_account_id = \"205860777463\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSCertificateManager\" AND  line_item_usage_account_id = \"913292487988\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"awswaf\" AND  line_item_usage_account_id = \"955895235416\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonRoute53\" AND  line_item_usage_account_id = \"281193985665\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonApiGateway\" AND  line_item_usage_account_id = \"621237723456\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSDirectConnect\" AND  line_item_usage_account_id = \"070958878125\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSCertificateManager\" AND  line_item_usage_account_id = \"955895235416\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonApiGateway\" AND  line_item_usage_account_id = \"749651711864\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSShield\" AND  line_item_usage_account_id = \"281193985665\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSShield\" AND  line_item_usage_account_id = \"621237723456\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AWSDirectConnect\" AND  line_item_usage_account_id = \"913292487988\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"AmazonVPC\" AND  line_item_usage_account_id = \"690399877577\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_product_code = \"awswaf\" AND  line_item_usage_account_id = \"558628470851\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_resource_id = \"traffic-layer-logs-current\" AND  line_item_usage_account_id = \"736370371722\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (line_item_usage_type = \"Global-SoftwareUsage-Contracts\" AND  line_item_usage_account_id = \"199745886785\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (product_product_name = \"Amazon Simple Storage Service\" AND  line_item_usage_account_id = \"070958878125\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (product_product_name = \"Amazon Simple Storage Service\" AND  line_item_usage_account_id = \"161094425896\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (product_product_name = \"Amazon Simple Storage Service\" AND  line_item_usage_account_id = \"281193985665\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (product_product_name = \"Amazon Simple Storage Service\" AND  line_item_usage_account_id = \"014991816441\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (product_product_name = \"Amazon Simple Storage Service\" AND  line_item_usage_account_id = \"913292487988\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (product_product_name = \"Amazon Simple Storage Service\" AND  line_item_usage_account_id = \"635950459433\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (product_product_name = \"Amazon Simple Storage Service\" AND  line_item_usage_account_id = \"767428572615\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (product_product_name = \"Amazon Simple Storage Service\" AND  line_item_usage_account_id = \"627632095367\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (product_product_name = \"Amazon Simple Storage Service\" AND  line_item_usage_account_id = \"830619001108\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (product_product_name = \"Amazon Simple Storage Service\" AND  line_item_usage_account_id = \"128464316945\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (product_product_name = \"Amazon Simple Storage Service\" AND  line_item_usage_account_id = \"228092041116\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (product_product_name = \"Amazon Simple Storage Service\" AND  line_item_usage_account_id = \"961618667388\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (product_product_name = \"Amazon Simple Storage Service\" AND  line_item_usage_account_id = \"470332157166\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (product_product_name = \"Amazon Simple Storage Service\" AND  line_item_usage_account_id = \"955895235416\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (product_product_name = \"Amazon Simple Storage Service\" AND  line_item_usage_account_id = \"088484141381\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (product_product_name = \"Amazon Simple Storage Service\" AND  line_item_usage_account_id = \"632765385162\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (product_servicecode = \"AWSDataTransfer\" AND  line_item_usage_account_id = \"736370371722\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (resource_tags_user_application = \"traffic-layer\" AND  line_item_usage_account_id = \"736370371722\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (resource_tags_user_application != \"\" AND  line_item_usage_account_id = \"736370371722\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (resource_tags_user_cb_application = \"melidata-generic-streams\" AND  line_item_usage_account_id = \"968153641465\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (resource_tags_user_name like  \"md-spark%\" AND  line_item_usage_account_id = \"968153641465\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (resource_tags_user_name like \"data-apps-nomad%\" AND  line_item_usage_account_id = \"736370371722\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (resource_tags_user_name like  \"md-presto%\" AND  line_item_usage_account_id = \"968153641465\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (resource_tags_user_name like  \"md-hive%\" AND  line_item_usage_account_id = \"968153641465\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (resource_tags_user_name  = \"fury-controlplane\" AND  line_item_usage_account_id = \"736370371722\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (resource_tags_user_owner = \"serverless\" AND  line_item_usage_account_id = \"736370371722\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (resource_tags_user_service = \"bigq\" AND  line_item_usage_account_id = \"019704497826\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (resource_tags_user_service = \"mq\" AND  line_item_usage_account_id = \"019704497826\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (resource_tags_user_service = \"furylogs\" AND  line_item_usage_account_id = \"433070516464\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (resource_tags_user_service = \"furylogs-test\" AND  line_item_usage_account_id = \"433070516464\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (resource_tags_user_service = \"ds\" AND  line_item_usage_account_id = \"019704497826\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (resource_tags_user_service = \"kvs\" AND  line_item_usage_account_id = \"019704497826\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (resource_tags_user_service like \"object-storage%\" AND  line_item_usage_account_id = \"736370371722\" AND ( line_item_usage_start_date BETWEEN \"2024-06-01\" AND \"2024-06-04\")))\n        GROUP BY 1,2,3,4,5,7,9,10,11,12\n        having total_cost>0\n        ORDER BY 9,1", "relation_name": "`metrics-streams-dev`.`TemporalData`.`substract_get_OffFury_aws`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T15:34:10.991014Z", "completed_at": "2024-06-07T15:34:14.943640Z"}, {"name": "execute", "started_at": "2024-06-07T15:34:14.945714Z", "completed_at": "2024-06-07T15:34:18.803956Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 7.817214250564575, "adapter_response": {"_message": "CREATE TABLE (751.0 rows, 35.2 GiB processed)", "code": "CREATE TABLE", "rows_affected": 751, "bytes_processed": 37780645871, "bytes_billed": 37781241856, "location": "US", "project_id": "metrics-streams-dev", "job_id": "a0b8c0f7-ad97-4d20-80f3-275ac27b99dc", "slot_ms": 362265}, "message": "CREATE TABLE (751.0 rows, 35.2 GiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.substract_get_OffFury_gcp", "compiled": true, "compiled_code": "-- depends on : `metrics-streams-dev`.`TemporalData`.`final_tmp_process_output` \n\n\n\n\n\n\n\n\n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n\n\n\n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n\n\n\n\n                      \n        \n\n                      \n        \n\n                      \n        \n\n\nSELECT\n      cast(TIMESTAMP_TRUNC(usage_start_time, DAY) AS datetime) datetime,\n      CASE\n        WHEN PROJECT.id IS NULL THEN 'Cargos no especificos de un proyecto'\n        ELSE\n          PROJECT.id\n      END AS account_id,\n      service.description AS service_type,\n      sku.description AS billing_key,\n      'NO-STACK' AS service_name,\n      cast((SUM(CAST(cost * 1000000 AS INT64)) + SUM(IFNULL((\n              SELECT\n                SUM(CAST(c.amount * 1000000 AS INT64))\n              FROM\n                UNNEST(credits) c),\n          0))) / 1000000 as numeric)  AS total_cost,\n      usage.pricing_unit AS billing_unit,\n      cast(SUM(usage.amount_in_pricing_units) as numeric)  AS billing_usage_amount,\n      'GCP' AS provider\n      ,current_date()  load_date\t\n      ,current_date() update_date\n      ,'Test Final dbt' as observation \n    FROM `metrics-streams-dev`.`GoogleCloudBillingDetail`.`BillingDetailExport` \n    WHERE\n      PARTITIONTIME >= DATETIME_SUB(CAST(PARSE_DATE('%F', '2024-06-01') as TIMESTAMP), INTERVAL 1 DAY)\n      AND PARTITIONTIME <= DATETIME_ADD(cast(PARSE_DATE('%F', '2024-06-04') as TIMESTAMP ),INTERVAL 1 DAY)\n      AND TIMESTAMP_TRUNC(usage_start_time, DAY) >=cast(PARSE_DATE('%F', '2024-06-01') as timestamp)\n      AND TIMESTAMP_TRUNC(usage_start_time, DAY) <= cast(PARSE_DATE('%F', '2024-06-04') as timestamp)\n       AND (   (  PROJECT.id = \"gobiernoit-reservas\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpbs-mob-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"mid-shp-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"test-shp-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"test-fra-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpbt-mp-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpbt-mob-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"low-db-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpt-mkt-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"mid-fra-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpbt-cp-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpbs-mkt-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"low-mkt-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpbt-shp-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"dev05-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bps-cp-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpbs-db-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"test-mob-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"mid-cp-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpt-mp-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"test-mkt-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"low-cp-bq02\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"high-fra-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"mid-db-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"high-com-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bps-mob-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpt-mob-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"high-mkt-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"high-shp-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpbt-db-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpbt-mkt-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"dev04b-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpbs-fra-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpt-shp-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpt-com-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"low-fra-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpbs-com-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bps-mp-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"low-com-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"mid-com-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"low-cp-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"low-shp-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"mid-mkt-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bps-shp-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"high-mob-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpbs-shp-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpbs-api-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bps-db-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpbt-fra-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bigqueue-test\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bps-mkt-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"low-mob-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpbt-com-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"mid-api-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpt-db-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bps-api-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"test-db-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"dev02-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bps-fra-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"mid-mp-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpt-fra-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"high-cp-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpt-cp-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"high-mp-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"high-db-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"dev03-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bps-com-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"dev01-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"mid-mob-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"test-cp-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpbt-api-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"low-mp-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"high-api-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpbs-cp-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"test-api-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpbs-mp-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bigqueue\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"test-mp-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"low-api-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"bpt-api-bq01\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR  (  PROJECT.id = \"shared-vpc-224614\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\"))  OR (resource.global_name like \"%//bigquery.googleapis.com/projects/melidata-marketplace/datasets/melidata%\" AND PROJECT.id = \"melidata-marketplace\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (resource.name like \"%desaenv%\" AND PROJECT.id = \"598925332888\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (resource.name like \"%DESAENV%\" AND PROJECT.id = \"dbaas-268214\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (resource.name like \"%desaenv%\" AND PROJECT.id = \"dbaas-268214\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (resource.name like \"%DESAENV%\" AND PROJECT.id = \"598925332888\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (service.description = \"Compute Engine\" AND PROJECT.id = \"fury-202121\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")) OR (service.description = \"Compute Engine\" AND PROJECT.id = \"dbaas-268214\" AND ( usage_start_time BETWEEN \"2024-06-01\" AND \"2024-06-04\")))\n    GROUP BY 1, 2, 3, 4, 5, 7, 9, 10, 11, 12\n    HAVING total_cost > 0.0", "relation_name": "`metrics-streams-dev`.`TemporalData`.`substract_get_OffFury_gcp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T15:34:18.813356Z", "completed_at": "2024-06-07T15:34:20.728327Z"}, {"name": "execute", "started_at": "2024-06-07T15:34:20.730331Z", "completed_at": "2024-06-07T15:34:23.732041Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.922407150268555, "adapter_response": {"_message": "CREATE TABLE (28.0 rows, 984.3 MiB processed)", "code": "CREATE TABLE", "rows_affected": 28, "bytes_processed": 1032134469, "bytes_billed": 1032847360, "location": "US", "project_id": "metrics-streams-dev", "job_id": "41a9f5a6-e59a-487a-8588-71523cf8c675", "slot_ms": 6391}, "message": "CREATE TABLE (28.0 rows, 984.3 MiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.substract_get_OffFury_oci", "compiled": true, "compiled_code": "-- depends on : `metrics-streams-dev`.`TemporalData`.`final_tmp_process_output` \n\n\n\n\n\n\n\n\n       \n           \n\n       \n           \n\n       \n           \n\n       \n           \n\n       \n           \n\n       \n           \n\n       \n           \n\n\nSELECT\n      cast(TIMESTAMP_TRUNC(cost_lineItem_intervalUsageStart, DAY) AS datetime) datetime,\n     'ocid1.tenancy.oc1..aaaaaaaalgfveinmsacv4lo36wk4hfoiokh2m52j72sw5f4boms676vvc2da' AS account_id,\n      CONCAT('OCI_',cost_product_Description) AS service_type,\n      COALESCE(usage_product_resource,null,'UNDEFINED')  AS billing_key,\n      'NO-STACK' AS service_name,\n      CAST(SUM(ROUND(cost_total_cost_US,2)) AS NUMERIC)  AS total_cost,\n      COALESCE(usage_consumedQuantityUnits,null,'UNDEFINED') billing_unit,\n      CAST(SUM(ROUND(cost_total_usage,2)) AS NUMERIC)  AS billing_usage_amount,\n      'OCI' AS provider\n      ,current_date()  load_date\n      ,current_date() update_date\n      ,'Test Final dbt' as observation\n    FROM `metrics-streams-dev`.`WorkData`.`BillingOracleAnnualUnified`\n    WHERE\n        (cost_product_Description = \"Exadata X9M Additional Storage Instance Meter\"  AND  cost_lineItem_intervalUsageStart BETWEEN \"2024-06-01\" AND \"2024-06-04\") OR (cost_product_Description = \"Exadata X8M Additional Storage Instance Meter\"  AND  cost_lineItem_intervalUsageStart BETWEEN \"2024-06-01\" AND \"2024-06-04\") OR (cost_product_Description = \"Exadata X9M Additional Compute Instance Meter\"  AND  cost_lineItem_intervalUsageStart BETWEEN \"2024-06-01\" AND \"2024-06-04\") OR (cost_product_Description = \"Database Exadata - Additional OCPUs - BYOL\"  AND  cost_lineItem_intervalUsageStart BETWEEN \"2024-06-01\" AND \"2024-06-04\") OR (cost_product_Description = \"Exadata X9M Quarter Rack Instance Meter\"  AND  cost_lineItem_intervalUsageStart BETWEEN \"2024-06-01\" AND \"2024-06-04\") OR (cost_product_Description = \"Exadata X8M Quarter Rack Instance Meter\"  AND  cost_lineItem_intervalUsageStart BETWEEN \"2024-06-01\" AND \"2024-06-04\") OR (cost_product_Description = \"Exadata X8M Additional Compute Instance Meter\"  AND  cost_lineItem_intervalUsageStart BETWEEN \"2024-06-01\" AND \"2024-06-04\")\n    GROUP BY 1,2,3,4,5,7,9,10,11,12\n    HAVING total_cost > 0.0", "relation_name": "`metrics-streams-dev`.`TemporalData`.`substract_get_OffFury_oci`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T15:34:23.741325Z", "completed_at": "2024-06-07T15:34:24.791240Z"}, {"name": "execute", "started_at": "2024-06-07T15:34:24.793233Z", "completed_at": "2024-06-07T15:34:27.735967Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.999100685119629, "adapter_response": {"_message": "CREATE TABLE (23.0 rows, 0 processed)", "code": "CREATE TABLE", "rows_affected": 23, "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "metrics-streams-dev", "job_id": "b13ea4b2-036d-4f54-9b7a-5f117f9bdb90", "slot_ms": 3453}, "message": "CREATE TABLE (23.0 rows, 0 processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.substract_get_rules_fury", "compiled": true, "compiled_code": "-- depends on : `metrics-streams-dev`.`TemporalData`.`final_tmp_process_output`\n\n\n\n\n    \n    SELECT\n        'application_name' tag_key, \n        'mqadmin' tag_value,\n        '!=' operator,\n        '2023-02-01' from_date,\n        '2030-12-31' to_date,\n        '(application_name != \"mqadmin\")' cadena\n\n    \n    union all\n    \n\n\n    \n    SELECT\n        'application_name' tag_key, \n        'mq-pubsub-poc' tag_value,\n        '!=' operator,\n        '2023-02-01' from_date,\n        '2030-12-31' to_date,\n        '(application_name != \"mq-pubsub-poc\")' cadena\n\n    \n    union all\n    \n\n\n    \n    SELECT\n        'application_name' tag_key, \n        'mqapi' tag_value,\n        '!=' operator,\n        '2023-02-01' from_date,\n        '2030-12-31' to_date,\n        '(application_name != \"mqapi\")' cadena\n\n    \n    union all\n    \n\n\n    \n    SELECT\n        'application_name' tag_key, \n        'bq-provider-manager' tag_value,\n        '!=' operator,\n        '2023-02-01' from_date,\n        '2030-12-31' to_date,\n        '(application_name != \"bq-provider-manager\")' cadena\n\n    \n    union all\n    \n\n\n    \n    SELECT\n        'application_name' tag_key, \n        'mqpusher' tag_value,\n        '!=' operator,\n        '2023-02-01' from_date,\n        '2030-12-31' to_date,\n        '(application_name != \"mqpusher\")' cadena\n\n    \n    union all\n    \n\n\n    \n    SELECT\n        'application_name' tag_key, \n        'mq-publisher' tag_value,\n        '!=' operator,\n        '2023-02-01' from_date,\n        '2030-12-31' to_date,\n        '(application_name != \"mq-publisher\")' cadena\n\n    \n    union all\n    \n\n\n    \n    SELECT\n        'application_name' tag_key, \n        'bigqueue-load-testing-utils' tag_value,\n        '!=' operator,\n        '2023-02-01' from_date,\n        '2030-12-31' to_date,\n        '(application_name != \"bigqueue-load-testing-utils\")' cadena\n\n    \n    union all\n    \n\n\n    \n    SELECT\n        'application_name' tag_key, \n        'bq-consumer-mock' tag_value,\n        '!=' operator,\n        '2023-02-01' from_date,\n        '2030-12-31' to_date,\n        '(application_name != \"bq-consumer-mock\")' cadena\n\n    \n    union all\n    \n\n\n    \n    SELECT\n        'application_name' tag_key, \n        'logan' tag_value,\n        '!=' operator,\n        '2022-12-02' from_date,\n        '2030-12-31' to_date,\n        '(application_name != \"logan\")' cadena\n\n    \n    union all\n    \n\n\n    \n    SELECT\n        'application_name' tag_key, \n        'logs-collector' tag_value,\n        '!=' operator,\n        '2022-12-02' from_date,\n        '2030-12-31' to_date,\n        '(application_name != \"logs-collector\")' cadena\n\n    \n    union all\n    \n\n\n    \n    SELECT\n        'application_name' tag_key, \n        'logs-admin' tag_value,\n        '!=' operator,\n        '2022-12-02' from_date,\n        '2030-12-31' to_date,\n        '(application_name != \"logs-admin\")' cadena\n\n    \n    union all\n    \n\n\n    \n    SELECT\n        'application_name' tag_key, \n        'melidata-tracking-api' tag_value,\n        '!=' operator,\n        '2024-04-01' from_date,\n        '2031-12-31' to_date,\n        '(application_name != \"melidata-tracking-api\")' cadena\n\n    \n    union all\n    \n\n\n    \n    SELECT\n        'application_name' tag_key, \n        'traffic-layer' tag_value,\n        '!=' operator,\n        '2022-01-01' from_date,\n        '2031-12-31' to_date,\n        '(application_name != \"traffic-layer\")' cadena\n\n    \n    union all\n    \n\n\n    \n    SELECT\n        'application_name' tag_key, \n        'kvsapi' tag_value,\n        '!=' operator,\n        '2022-01-01' from_date,\n        '2031-12-31' to_date,\n        '(application_name != \"kvsapi\")' cadena\n\n    \n    union all\n    \n\n\n    \n    SELECT\n        'application_name' tag_key, \n        'kvsapi-migrator' tag_value,\n        '!=' operator,\n        '2022-01-01' from_date,\n        '2031-12-31' to_date,\n        '(application_name != \"kvsapi-migrator\")' cadena\n\n    \n    union all\n    \n\n\n    \n    SELECT\n        'application_name' tag_key, \n        'dsapi' tag_value,\n        '!=' operator,\n        '2022-01-01' from_date,\n        '2031-12-31' to_date,\n        '(application_name != \"dsapi\")' cadena\n\n    \n    union all\n    \n\n\n    \n    SELECT\n        'application_name' tag_key, \n        'dsadmin' tag_value,\n        '!=' operator,\n        '2022-01-01' from_date,\n        '2031-12-31' to_date,\n        '(application_name != \"dsadmin\")' cadena\n\n    \n    union all\n    \n\n\n    \n    SELECT\n        'application_name' tag_key, \n        'melistreams-commons' tag_value,\n        '!=' operator,\n        '2023-08-01' from_date,\n        '2031-12-31' to_date,\n        '(application_name != \"melistreams-commons\")' cadena\n\n    \n    union all\n    \n\n\n    \n    SELECT\n        'application_name' tag_key, \n        'melistreams-producer' tag_value,\n        '!=' operator,\n        '2023-08-01' from_date,\n        '2031-12-31' to_date,\n        '(application_name != \"melistreams-producer\")' cadena\n\n    \n    union all\n    \n\n\n    \n    SELECT\n        'application_name' tag_key, \n        'melistreams-admin' tag_value,\n        '!=' operator,\n        '2023-08-01' from_date,\n        '2031-12-31' to_date,\n        '(application_name != \"melistreams-admin\")' cadena\n\n    \n    union all\n    \n\n\n    \n    SELECT\n        'application_name' tag_key, \n        'melistreams-pusher' tag_value,\n        '!=' operator,\n        '2023-08-01' from_date,\n        '2031-12-31' to_date,\n        '(application_name != \"melistreams-pusher\")' cadena\n\n    \n    union all\n    \n\n\n    \n    SELECT\n        'application_name' tag_key, \n        'melistreams' tag_value,\n        '!=' operator,\n        '2023-08-01' from_date,\n        '2031-12-31' to_date,\n        '(application_name != \"melistreams\")' cadena\n\n    \n    union all\n    \n\n\n    \n    SELECT\n        'application_name' tag_key, \n        'message-services-util' tag_value,\n        '!=' operator,\n        '2023-08-01' from_date,\n        '2031-12-31' to_date,\n        '(application_name != \"message-services-util\")' cadena\n\n    \n\n", "relation_name": "`metrics-streams-dev`.`TemporalData`.`substract_get_rules_fury`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T15:34:27.750200Z", "completed_at": "2024-06-07T15:34:29.419077Z"}, {"name": "execute", "started_at": "2024-06-07T15:34:29.421079Z", "completed_at": "2024-06-07T15:34:31.991685Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.247309684753418, "adapter_response": {"_message": "CREATE TABLE (1.0 rows, 436.6 KiB processed)", "code": "CREATE TABLE", "rows_affected": 1, "bytes_processed": 447048, "bytes_billed": 10485760, "location": "US", "project_id": "metrics-streams-dev", "job_id": "e2ce85fe-f0e8-470b-8b88-e7c2f141386b", "slot_ms": 207}, "message": "CREATE TABLE (1.0 rows, 436.6 KiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_last_dashOffFury_values", "compiled": true, "compiled_code": "-- depends_on: `metrics-streams-dev`.`TemporalData`.`final_last_snapshot`\nSELECT \n                    '20240607153300' sufijo, \n                    CURRENT_DATETIME('UTC') datetime,\n                    COUNT(1) records,\n                    COALESCE(SUM(CAST(total_cost AS FLOAT64)),null,0) total_cost\n            FROM  ProcessedData.BillingDashControlBaseOffFury\n            WHERE day BETWEEN '2024-06-01' AND  '2024-06-04'", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_last_dashOffFury_values`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T15:34:32.010074Z", "completed_at": "2024-06-07T15:34:33.290276Z"}, {"name": "execute", "started_at": "2024-06-07T15:34:33.292255Z", "completed_at": "2024-06-07T15:34:35.887218Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.885305166244507, "adapter_response": {"_message": "CREATE TABLE (1.0 rows, 291.3 KiB processed)", "code": "CREATE TABLE", "rows_affected": 1, "bytes_processed": 298256, "bytes_billed": 10485760, "location": "US", "project_id": "metrics-streams-dev", "job_id": "a744deaa-3eb7-4585-b6e8-82564032197a", "slot_ms": 160}, "message": "CREATE TABLE (1.0 rows, 291.3 KiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_last_dashfury_values", "compiled": true, "compiled_code": "-- depends_on: `metrics-streams-dev`.`TemporalData`.`final_last_snapshot`\nSELECT \n                    '20240607153300' sufijo, \n                    CURRENT_DATETIME('UTC') datetime,\n                    COUNT(1) records,\n                    COALESCE(SUM(CAST(total_cost AS FLOAT64)),null,0) total_cost\n            FROM `metrics-streams-dev`.`ProcessedData`.`BillingDashControlBase`  \n            WHERE day BETWEEN '2024-06-01' AND  '2024-06-04'", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_last_dashfury_values`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T15:34:35.896817Z", "completed_at": "2024-06-07T15:34:37.062833Z"}, {"name": "execute", "started_at": "2024-06-07T15:34:37.064866Z", "completed_at": "2024-06-07T15:34:39.613314Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.7204225063323975, "adapter_response": {"_message": "CREATE TABLE (1.0 rows, 57.7 MiB processed)", "code": "CREATE TABLE", "rows_affected": 1, "bytes_processed": 60521496, "bytes_billed": 60817408, "location": "US", "project_id": "metrics-streams-dev", "job_id": "75661679-8ff6-414a-97fa-f879e1fc3371", "slot_ms": 1268}, "message": "CREATE TABLE (1.0 rows, 57.7 MiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_last_final_values", "compiled": true, "compiled_code": "-- depends on : `metrics-streams-dev`.`TemporalData`.`final_last_snapshot`  \nSELECT \n                            '20240607153300'  sufijo, \n                            CURRENT_DATETIME('UTC') datetime,\n                            COUNT(1) records,\n                            COALESCE(SUM(CAST(total_cost AS FLOAT64)),null,0) total_cost\n                          FROM ProcessedData.BillingfacAllocationFinal \n                          WHERE datetime BETWEEN '2024-06-01' AND  '2024-06-04'", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_last_final_values`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T15:34:39.622825Z", "completed_at": "2024-06-07T15:34:40.745348Z"}, {"name": "execute", "started_at": "2024-06-07T15:34:40.747383Z", "completed_at": "2024-06-07T15:34:43.375948Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.757214307785034, "adapter_response": {"_message": "CREATE TABLE (1.0 rows, 436.6 KiB processed)", "code": "CREATE TABLE", "rows_affected": 1, "bytes_processed": 447048, "bytes_billed": 10485760, "location": "US", "project_id": "metrics-streams-dev", "job_id": "ecfbc195-909c-462f-bc97-8f5ae28171a9", "slot_ms": 203}, "message": "CREATE TABLE (1.0 rows, 436.6 KiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_prev_dashOffFury_values", "compiled": true, "compiled_code": "-- depends_on: `metrics-streams-dev`.`TemporalData`.`final_last_snapshot`\nSELECT '20240607153300' sufijo,\n                PARSE_DATETIME('%Y%m%d%H%M%S', '20240607153300') datetime,\n                COUNT(1) records,\n                COALESCE(SUM(CAST(total_cost AS FLOAT64)),null,0) total_cost\n          FROM ProcessedData_REPRO_snapshots.BillingDashControlBaseOffFury_20240607153300\n          WHERE day BETWEEN '2024-06-01' AND '2024-06-04'", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_prev_dashOffFury_values`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T15:34:43.385328Z", "completed_at": "2024-06-07T15:34:44.440562Z"}, {"name": "execute", "started_at": "2024-06-07T15:34:44.442643Z", "completed_at": "2024-06-07T15:34:46.896527Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.5149292945861816, "adapter_response": {"_message": "CREATE TABLE (1.0 rows, 291.3 KiB processed)", "code": "CREATE TABLE", "rows_affected": 1, "bytes_processed": 298256, "bytes_billed": 10485760, "location": "US", "project_id": "metrics-streams-dev", "job_id": "796718ff-49b7-419c-b21b-801abd6a1efd", "slot_ms": 216}, "message": "CREATE TABLE (1.0 rows, 291.3 KiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_prev_dashfury_values", "compiled": true, "compiled_code": "-- depends_on: `metrics-streams-dev`.`TemporalData`.`final_last_snapshot`\nSELECT '20240607153300' sufijo, \n                PARSE_DATETIME('%Y%m%d%H%M%S', '20240607153300') datetime,\n                COUNT(1) records,\n                COALESCE(SUM(CAST(total_cost AS FLOAT64)),null,0) total_cost \n          FROM ProcessedData_REPRO_snapshots.BillingDashControlBase_20240607153300\n          WHERE day BETWEEN '2024-06-01' AND '2024-06-04'", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_prev_dashfury_values`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T15:34:46.906023Z", "completed_at": "2024-06-07T15:34:48.043940Z"}, {"name": "execute", "started_at": "2024-06-07T15:34:48.049504Z", "completed_at": "2024-06-07T15:34:50.885508Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.9835846424102783, "adapter_response": {"_message": "CREATE TABLE (1.0 rows, 57.7 MiB processed)", "code": "CREATE TABLE", "rows_affected": 1, "bytes_processed": 60521496, "bytes_billed": 60817408, "location": "US", "project_id": "metrics-streams-dev", "job_id": "1d12b020-d834-4e88-9271-ce065302b4cb", "slot_ms": 1717}, "message": "CREATE TABLE (1.0 rows, 57.7 MiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_prev_final_values", "compiled": true, "compiled_code": "-- depends_on: `metrics-streams-dev`.`TemporalData`.`final_last_snapshot`\nSELECT '20240607153300' sufijo, \n                PARSE_DATETIME('%Y%m%d%H%M%S', '20240607153300') datetime,\n                COUNT(1) records,\n                COALESCE(SUM(CAST(total_cost AS FLOAT64)),null,0) total_cost \n          FROM ProcessedData_REPRO_snapshots.BillingfacAllocationFinal_20240607153300\n          WHERE datetime BETWEEN '2024-06-01' AND '2024-06-01'", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_prev_final_values`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T15:34:50.895924Z", "completed_at": "2024-06-07T15:34:50.906241Z"}, {"name": "execute", "started_at": "2024-06-07T15:34:50.908603Z", "completed_at": "2024-06-07T15:34:56.518012Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 5.626424789428711, "adapter_response": {"_message": "MERGE (36.1k rows, 35.3 MiB processed)", "code": "MERGE", "rows_affected": 36139, "bytes_processed": 36967671, "bytes_billed": 41943040, "location": "US", "project_id": "metrics-streams-dev", "job_id": "a22d5c7f-29ff-4708-a138-e9c16a63e178", "slot_ms": 18368}, "message": "MERGE (36.1k rows, 35.3 MiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.substract_all_in_one", "compiled": true, "compiled_code": "-- depends on : (<BigQueryRelation `metrics-streams-dev`.`TemporalData`.`substract_get_OffFury_aws`>, <BigQueryRelation `metrics-streams-dev`.`TemporalData`.`substract_get_OffFury_gcp`>, <BigQueryRelation `metrics-streams-dev`.`TemporalData`.`substract_get_OffFury_oci`>) \n\n\nSELECT * FROM `metrics-streams-dev`.`TemporalData`.`substract_get_OffFury_aws` \nUNION ALL \nSELECT * FROM `metrics-streams-dev`.`TemporalData`.`substract_get_OffFury_gcp`\nUNION ALL \nSELECT * FROM `metrics-streams-dev`.`TemporalData`.`substract_get_OffFury_oci`", "relation_name": "`metrics-streams-dev`.`ProcessedData`.`BillingtabOffFurysubtract`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T15:34:56.528012Z", "completed_at": "2024-06-07T15:34:56.536111Z"}, {"name": "execute", "started_at": "2024-06-07T15:34:56.538018Z", "completed_at": "2024-06-07T15:34:59.695083Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.170973062515259, "adapter_response": {"_message": "CREATE TABLE (52.3k rows, 9.8 MiB processed)", "code": "CREATE TABLE", "rows_affected": 52333, "bytes_processed": 10296282, "bytes_billed": 10485760, "location": "US", "project_id": "metrics-streams-dev", "job_id": "bad12ab4-f559-43ce-be8a-d85d66938cb9", "slot_ms": 20911}, "message": "CREATE TABLE (52.3k rows, 9.8 MiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_tmp_BillingDashHistoFullSubstract", "compiled": true, "compiled_code": "\n\n   WITH \n    days_dummies AS (\n        SELECT days_gen FROM \n        UNNEST(GENERATE_DATE_ARRAY(PARSE_DATE('%F', '2022-01-01'), DATE(CURRENT_DATE() - INTERVAL 2 DAY) , INTERVAL 1 DAY))  AS days_gen\n        ),\n\n   only_real_service_type AS (\n        SELECT DISTINCT service_type \n        FROM `metrics-streams-dev`.`ProcessedData`.`BillingtabOffFurysubtract`  \n   ),\n\n    service_type_day_real AS (\n       SELECT DATE(datetime) day,\n            service_type,\n            ROUND(SUM(total_cost),2) total_cost,\n            COUNT(1) conteo\n       FROM `metrics-streams-dev`.`ProcessedData`.`BillingtabOffFurysubtract`  \n       WHERE service_type IS NOT NULL\n       GROUP BY 1,2\n       ),\n\n    service_type_dummies AS (\n       SELECT DISTINCT service_type\n       FROM only_real_service_type \n       WHERE service_type IS NOT NULL\n       ),\n\n    matriz_days_service_type AS (\n       SELECT A.days_gen, B.service_type \n       FROM days_dummies A, service_type_dummies B\n       ),\n\n    cruce_service_type_values AS (\n       SELECT A.days_gen day,\n              A.service_type,\n              COALESCE(B.total_cost,null,0) total_cost,\n              COALESCE(B.conteo,null,0) conteo\n       FROM matriz_days_service_type A\n       LEFT JOIN service_type_day_real B\n            ON (A.days_gen=B.day AND A.service_type=B.service_type)\n       )\n\n    SELECT * FROM cruce_service_type_values", "relation_name": "`metrics-streams-dev`.`TemporalData`.`BillingDashHistoFullSubstract`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T15:34:59.704404Z", "completed_at": "2024-06-07T15:34:59.717604Z"}, {"name": "execute", "started_at": "2024-06-07T15:34:59.719682Z", "completed_at": "2024-06-07T15:35:03.621929Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.921290159225464, "adapter_response": {"_message": "CREATE TABLE (57.6k rows, 16.2 MiB processed)", "code": "CREATE TABLE", "rows_affected": 57604, "bytes_processed": 16968197, "bytes_billed": 20971520, "location": "US", "project_id": "metrics-streams-dev", "job_id": "b1ae18b2-ad1d-4c12-9610-d1e40478d184", "slot_ms": 14579}, "message": "CREATE TABLE (57.6k rows, 16.2 MiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_tmp_BillingfacgetBigquery", "compiled": true, "compiled_code": "-- depends on : `metrics-streams-dev`.`ProcessedData`.`BillingtabOffFurysubtract`\nSELECT \n          '237' AS idcatalogoorigen,\n          'Bigquery Meli-bi-data' AS nombrenemonico,\n          '63'  AS idproceso,\n          COALESCE(username,null,'No owner') AS generator_cost_name,\n          'No Aplica' AS account_id, \n          DATE(datetime) as datetime,\n          service_name, \n          service_type, \n          billing_key, \n          billing_usage_amount billing_usage_ammount, \n          total_cost,  \n          billing_concept, \n          billing_unit, \n          initiative_id, \n          initiative_external_code,\n          initiative_external_name,\n          head, \n          sponsor,\n          1 project_id, \n          'No aplica' project_code, \n          1 team_id, \n          'No aplica' team_name, \n          avenue_id, \n          avenue_name, \n          bu_id,bu_name, \n          super_bu_id, \n          super_bu_name, \n          load_date, \n          CURRENT_DATETIME('UTC') AS update_date,\n          'Test Final dbt' observation,\n          CAST('155' AS INT64)  as idprocesoanterior\n      FROM `metrics-streams-dev`.`ProcessedData`.`BillingtabBQMeliBIData`  AS BillingtabBQMeliBIData\n      WHERE DATE(datetime) >= '2024-06-01'\n            AND DATE(datetime) <= '2024-06-04'\n            AND EXISTS(SELECT 'X' FROM `metrics-streams-dev`.`TemporalData`.`final_tmp_process_output` as tempprocesos WHERE 155=tempprocesos.idproceso)", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_tmp_BillingfacgetBigquery`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T15:35:03.631212Z", "completed_at": "2024-06-07T15:35:03.642153Z"}, {"name": "execute", "started_at": "2024-06-07T15:35:03.644195Z", "completed_at": "2024-06-07T15:35:06.836023Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.20857834815979, "adapter_response": {"_message": "CREATE TABLE (11.3k rows, 4.4 MiB processed)", "code": "CREATE TABLE", "rows_affected": 11256, "bytes_processed": 4641017, "bytes_billed": 20971520, "location": "US", "project_id": "metrics-streams-dev", "job_id": "f618ecb2-1d6e-4a46-9c02-be3346eeda49", "slot_ms": 11720}, "message": "CREATE TABLE (11.3k rows, 4.4 MiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_tmp_BillingfacgetDatamesh", "compiled": true, "compiled_code": "-- depends on : `metrics-streams-dev`.`ProcessedData`.`BillingtabOffFurysubtract`\nSELECT \n          '247'  AS idcatalogoorigen,\n          'Bigquery Datamesh' AS nombrenemonico,\n          '63'  AS idproceso,\n          COALESCE(service_name,null,'No owner') AS generator_cost_name,\n          'No Aplica' AS account_id, \n          DATE(datetime) as datetime,\n          service_name, \n          service_type, \n          billing_key, \n          billing_usage_amount billing_usage_ammount, \n          total_cost,  \n          billing_concept, \n          billing_unit, \n          initiative_id, \n          initiative_external_code,\n          initiative_external_name,\n          head, \n          sponsor,\n          1 project_id, \n          'No aplica' project_code, \n          1 team_id, \n          'No aplica' team_name, \n          avenue_id, \n          avenue_name, \n          bu_id,bu_name, \n          super_bu_id,\n          super_bu_name, \n          load_date, \n          CURRENT_DATETIME('UTC') AS update_date, \n          'Test Final dbt' observation,\n          CAST('155' AS INT64) as idprocesoanterior\n      FROM `metrics-streams-dev`.`ProcessedData`.`BillingtabBQDatamesh`  AS BillingtabBQDatamesh\n      WHERE DATE(datetime) >= '2024-06-01'\n            AND DATE(datetime) <= '2024-06-04'\n            AND EXISTS(SELECT 'X' FROM `metrics-streams-dev`.`TemporalData`.`final_tmp_process_output` as tempprocesos WHERE 155=tempprocesos.idproceso)", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_tmp_BillingfacgetDatamesh`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T15:35:06.845251Z", "completed_at": "2024-06-07T15:35:06.855717Z"}, {"name": "execute", "started_at": "2024-06-07T15:35:06.857714Z", "completed_at": "2024-06-07T15:35:14.052635Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 7.211034059524536, "adapter_response": {"_message": "CREATE TABLE (329.3k rows, 96.4 GiB processed)", "code": "CREATE TABLE", "rows_affected": 329340, "bytes_processed": 103499322680, "bytes_billed": 103499694080, "location": "US", "project_id": "metrics-streams-dev", "job_id": "be79ca5a-d8e5-46b2-b0a0-cb55603838cd", "slot_ms": 583043}, "message": "CREATE TABLE (329.3k rows, 96.4 GiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_tmp_BillingfacgetFury", "compiled": true, "compiled_code": "-- depends on : `metrics-streams-dev`.`ProcessedData`.`BillingtabOffFurysubtract`\nSELECT \n          '70'  AS idcatalogoorigen,\n          'Fury' AS nombrenemonico,\n          '63'  AS idproceso,\n          application_name AS generator_cost_name,\n          'No Aplica' AS account_id,\n          DATE(datetime) as datetime,\n          service_name, \n          service_type, \n          billing_key, \n          billing_usage_ammount,\n          total_cost,\n          billing_concept,\n          billing_unit,\n          initiative_id, \n          initiative_external_code,  \n          initiative_external_name, \n          head, \n          sponsor, \n          project_id, \n          project_code, \n          team_id, \n          team_name, \n          avenue_id, \n          avenue_name, \n          bu_id,bu_name, \n          super_bu_id,  \n          super_bu_name, \n          load_date, \n          CURRENT_DATETIME('UTC') AS update_date,\n          'Test Final dbt' observation,\n          idproceso  as idprocesoanterior\n      FROM `metrics-streams-dev`.`ProcessedData`.`BillingtabFuryAllocation` as BillingtabFury\n      WHERE DATE(datetime) >= '2024-06-01'\n            AND DATE(datetime) <= '2024-06-04'\n            AND NOT EXISTS(SELECT 'X' FROM `metrics-streams-dev`.`TemporalData`.`substract_get_rules_fury` as restarfury \n                           WHERE restarfury.tag_key='application_name' AND BillingtabFury.application_name=restarfury.tag_value )\n            AND EXISTS(SELECT 'X' FROM `metrics-streams-dev`.`TemporalData`.`final_tmp_process_output` as tempprocesos WHERE BillingtabFury.idproceso=tempprocesos.idproceso)", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_tmp_BillingfacgetFury`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T15:35:14.062528Z", "completed_at": "2024-06-07T15:35:14.073072Z"}, {"name": "execute", "started_at": "2024-06-07T15:35:14.075155Z", "completed_at": "2024-06-07T15:35:17.968521Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.910329580307007, "adapter_response": {"_message": "CREATE TABLE (70.0 rows, 20.2 KiB processed)", "code": "CREATE TABLE", "rows_affected": 70, "bytes_processed": 20638, "bytes_billed": 20971520, "location": "US", "project_id": "metrics-streams-dev", "job_id": "4a344c53-1fd0-4b6b-aa64-74ce1f78f828", "slot_ms": 5513}, "message": "CREATE TABLE (70.0 rows, 20.2 KiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_tmp_BillingfacgetMelidata", "compiled": true, "compiled_code": "-- depends on : `metrics-streams-dev`.`ProcessedData`.`BillingtabOffFurysubtract`\nSELECT \n          '55'  AS idcatalogoorigen,\n          'Melidata' AS nombrenemonico,\n          '63'  AS idproceso,\n          username AS generator_cost_name, \n          'No Aplica' AS account_id, \n          DATE(datetime) as datetime,\n          service_name, \n          service_type, \n          billing_key, \n          CAST(billing_usage_amount AS numeric) billing_usage_amount, \n          CAST(total_cost AS numeric) total_cost,  \n          billing_concept, \n          billing_unit, \n          initiative_id, \n          initiative_external_code, \n          initiative_external_name, \n          head, \n          sponsor,\n          1 project_id, \n          'No aplica' project_code, \n          1 team_id, \n          'No aplica' team_name, \n          avenue_id, \n          avenue_name, \n          bu_id,bu_name, \n          super_bu_id, \n          super_bu_name, \n          load_date, \n          CURRENT_DATETIME('UTC') AS update_date, \n          'Test Final dbt' observation,\n          idproceso  as idprocesoanterior\n      FROM `metrics-streams-dev`.`ProcessedData`.`BillingtabMelidata`  AS BillingtabMelidata\n      WHERE DATE(datetime) >= '2024-06-01'\n            AND DATE(datetime) <= '2024-06-04'\n            AND EXISTS(SELECT 'X' FROM `metrics-streams-dev`.`TemporalData`.`final_tmp_process_output` as tempprocesos WHERE BillingtabMelidata.idproceso=tempprocesos.idproceso)", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_tmp_BillingfacgetMelidata`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T15:35:17.979784Z", "completed_at": "2024-06-07T15:35:17.990406Z"}, {"name": "execute", "started_at": "2024-06-07T15:35:17.992342Z", "completed_at": "2024-06-07T15:35:25.573923Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 7.598321914672852, "adapter_response": {"_message": "CREATE TABLE (327.1k rows, 179.3 MiB processed)", "code": "CREATE TABLE", "rows_affected": 327059, "bytes_processed": 188050445, "bytes_billed": 188743680, "location": "US", "project_id": "metrics-streams-dev", "job_id": "83e11522-6020-4fa0-9574-1a1ac63efb10", "slot_ms": 26240}, "message": "CREATE TABLE (327.1k rows, 179.3 MiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_tmp_BillingfacgetOffFury", "compiled": true, "compiled_code": "-- depends on : `metrics-streams-dev`.`ProcessedData`.`BillingtabOffFurysubtract`\nSELECT \n          '72'  AS idcatalogoorigen,\n          'OffFury' AS nombrenemonico,\n          '63'  AS idproceso,\n          account_name AS generator_cost_name,\n          BillingtabOffFury.account_id,\n          DATE(BillingtabOffFury.datetime) as datetime,\n          BillingtabOffFury.service_name, \n          BillingtabOffFury.service_type, \n          BillingtabOffFury.billing_key, \n          ROUND((billing_usage_amount - IFNULL(billing_usage_ammount,0)),2) AS billing_usage_ammount,\n          ROUND((BillingtabOffFury.total_cost - IFNULL(BillingtabOffFurysubtract.total_cost,0)),2) AS total_cost,\n          billing_concept, \n          BillingtabOffFury.billing_unit, \n          CAST(initiative_id AS INT64) initiative_id,  \n          initiative_external_code, \n          initiative_external_name, \n          head, \n          sponsor, \n          1 project_id, \n          'No Aplica' project_code, \n          1 team_id, \n          'No Aplica' team_name,\n          CAST(avenue_id AS INT64) avenue_id , \n          avenue_name,\n          CAST(bu_id AS INT64) bu_id,\n          bu_name, \n          CAST(super_bu_id AS INT64) super_bu_id, \n          super_bu_name, \n          BillingtabOffFury.load_date, \n          CURRENT_DATETIME('UTC') AS update_date,\n          'Test Final dbt' observation, \n          BillingtabOffFury.idproceso  as idprocesoanterior\n      FROM `metrics-streams-dev`.`ProcessedData`.`BillingtabOffFury` as BillingtabOffFury\n      LEFT JOIN `metrics-streams-dev`.`ProcessedData`.`BillingtabOffFurysubtract` as BillingtabOffFurysubtract \n           ON (DATE(BillingtabOffFury.datetime) = DATE(BillingtabOffFurysubtract.datetime)\n              AND BillingtabOffFury.account_id  =BillingtabOffFurysubtract.account_id\n              AND BillingtabOffFury.service_type =BillingtabOffFurysubtract.service_type\n              AND BillingtabOffFury.billing_key =BillingtabOffFurysubtract.billing_key\n              AND BillingtabOffFury.service_name =BillingtabOffFurysubtract.service_name\n              AND BillingtabOffFury.billing_unit =BillingtabOffFurysubtract.billing_unit)\n      WHERE DATE(BillingtabOffFury.datetime) >= '2024-06-01'\n            AND DATE(BillingtabOffFury.datetime) <= '2024-06-04' \n            AND (BillingtabOffFury.total_cost - IFNULL(BillingtabOffFurysubtract.total_cost,0)) > 0 \n             AND EXISTS(SELECT 'X' FROM `metrics-streams-dev`.`TemporalData`.`final_tmp_process_output` as tempprocesos WHERE BillingtabOffFury.idproceso=tempprocesos.idproceso)", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_tmp_BillingfacgetOffFury`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T15:35:25.583889Z", "completed_at": "2024-06-07T15:35:25.593677Z"}, {"name": "execute", "started_at": "2024-06-07T15:35:25.595665Z", "completed_at": "2024-06-07T15:35:29.211988Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.631805896759033, "adapter_response": {"_message": "CREATE TABLE (3.1k rows, 1.1 MiB processed)", "code": "CREATE TABLE", "rows_affected": 3078, "bytes_processed": 1137079, "bytes_billed": 20971520, "location": "US", "project_id": "metrics-streams-dev", "job_id": "b77a399a-1a14-4b80-8a1d-e07dbcfd82f9", "slot_ms": 12740}, "message": "CREATE TABLE (3.1k rows, 1.1 MiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_tmp_BillingfacgetOpenAI", "compiled": true, "compiled_code": "-- depends on : `metrics-streams-dev`.`ProcessedData`.`BillingtabOffFurysubtract`\nSELECT \n          '199'  AS idcatalogoorigen,\n          nombrenemonico,\n          '63' AS idproceso,\n          generator_cost_name, \n          account_id, \n          DATE(datetime) as datetime,\n          service_name, \n          service_type, \n          billing_key, \n          billing_usage_ammount, \n          total_cost,  \n          billing_concept, \n          billing_unit, \n          initiative_id, \n          initiative_external_code, \n          initiative_external_name, \n          head, \n          sponsor,\n          project_id, \n          project_code, \n          team_id, \n          team_name, \n          avenue_id, \n          avenue_name, \n          bu_id,\n          bu_name, \n          super_bu_id, \n          super_bu_name, \n          load_date, \n          CURRENT_DATETIME('UTC') AS update_date, \n          'Test Final dbt' observation,\n          CAST('151' AS INT64)  as idprocesoanterior\n      FROM `metrics-streams-dev`.`ProcessedData`.`BillingtabGENAI`  AS BillingtabGENAI\n      WHERE DATE(datetime) >= '2024-06-01'\n            AND DATE(datetime) <= '2024-06-04'\n            AND EXISTS(SELECT 'X' FROM `metrics-streams-dev`.`TemporalData`.`final_tmp_process_output` as tempprocesos WHERE 151=tempprocesos.idproceso)", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_tmp_BillingfacgetOpenAI`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T15:35:29.222362Z", "completed_at": "2024-06-07T15:35:29.232751Z"}, {"name": "execute", "started_at": "2024-06-07T15:35:29.234768Z", "completed_at": "2024-06-07T15:35:32.489106Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.271303176879883, "adapter_response": {"_message": "CREATE TABLE (0.0 rows, 493.4 MiB processed)", "code": "CREATE TABLE", "rows_affected": 0, "bytes_processed": 517392167, "bytes_billed": 517996544, "location": "US", "project_id": "metrics-streams-dev", "job_id": "312ad2e7-a0d7-446a-bb92-af7697119b56", "slot_ms": 24876}, "message": "CREATE TABLE (0.0 rows, 493.4 MiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_tmp_BillingtabMelidataBIFinalCosts", "compiled": true, "compiled_code": "-- depends on : `metrics-streams-dev`.`ProcessedData`.`BillingtabOffFurysubtract`\nSELECT \n          '248'  AS idcatalogoorigen,\n          'melidata-storage' AS nombrenemonico,\n          '63'  AS idproceso,\n          application_name AS generator_cost_name,\n          'No Aplica' AS account_id, \n          DATE(datetime) datetime,\n          service_name, \n          service_type, \n          billing_key, \n          CAST(billing_usage_amount AS numeric) billing_usage_amount, \n          CAST(total_cost AS numeric) total_cost,  \n          billing_concept, \n          billing_unit, \n          initiative_id, \n          initiative_external_code, \n          initiative_external_name, \n          head,\n          sponsor,\n          1 project_id, \n          'No aplica' project_code, \n          1 team_id, \n          'No aplica' team_name, \n          avenue_id, \n          avenue_name, \n          bu_id,bu_name, \n          super_bu_id, \n          super_bu_name, \n          load_date, \n          CURRENT_DATETIME('UTC') AS update_date, \n          'Test Final dbt' observation,\n          210 AS idprocesoanterior\nFROM `metrics-streams-dev`.`ProcessedData`.`BillingtabMelidataBIFinalCosts`  AS BillingtabMelidata\n      WHERE DATE(datetime) >= '2024-06-01'\n            AND DATE(datetime) <= '2024-06-04'\n            AND EXISTS(SELECT 'X' FROM `metrics-streams-dev`.`TemporalData`.`final_tmp_process_output` as tempprocesos WHERE 210=tempprocesos.idproceso)", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_tmp_BillingtabMelidataBIFinalCosts`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T15:35:32.500256Z", "completed_at": "2024-06-07T15:35:32.510196Z"}, {"name": "execute", "started_at": "2024-06-07T15:35:32.512097Z", "completed_at": "2024-06-07T15:35:43.149083Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 10.65271782875061, "adapter_response": {"_message": "CREATE TABLE (728.4k rows, 284.9 MiB processed)", "code": "CREATE TABLE", "rows_affected": 728407, "bytes_processed": 298717172, "bytes_billed": 298844160, "location": "US", "project_id": "metrics-streams-dev", "job_id": "21c0ac63-9dd1-41de-abe3-ae856e08a5e1", "slot_ms": 19358}, "message": "CREATE TABLE (728.4k rows, 284.9 MiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_tmp_consolidate", "compiled": true, "compiled_code": "\n-- depends on : (<BigQueryRelation `metrics-streams-dev`.`TemporalData`.`final_tmp_BillingfacgetOffFury`>, <BigQueryRelation `metrics-streams-dev`.`TemporalData`.`final_tmp_BillingfacgetFury`>, <BigQueryRelation `metrics-streams-dev`.`TemporalData`.`final_tmp_BillingfacgetMelidata`>, <BigQueryRelation `metrics-streams-dev`.`TemporalData`.`final_tmp_BillingfacgetBigquery`>, <BigQueryRelation `metrics-streams-dev`.`TemporalData`.`final_tmp_BillingfacgetOpenAI`>, <BigQueryRelation `metrics-streams-dev`.`TemporalData`.`final_tmp_BillingfacgetDatamesh`>, Undefined)\n\n\nSELECT * FROM `metrics-streams-dev`.`TemporalData`.`final_tmp_BillingfacgetOffFury`\nUNION ALL \nSELECT * FROM `metrics-streams-dev`.`TemporalData`.`final_tmp_BillingfacgetFury`\nUNION ALL \nSELECT * FROM `metrics-streams-dev`.`TemporalData`.`final_tmp_BillingfacgetMelidata`\nUNION ALL \nSELECT * FROM `metrics-streams-dev`.`TemporalData`.`final_tmp_BillingfacgetBigquery`\nUNION ALL\nSELECT * FROM `metrics-streams-dev`.`TemporalData`.`final_tmp_BillingfacgetOpenAI`\nUNION ALL\nSELECT * FROM `metrics-streams-dev`.`TemporalData`.`final_tmp_BillingfacgetDatamesh`\nUNION ALL\nSELECT * FROM `metrics-streams-dev`.`TemporalData`.`final_tmp_BillingtabMelidataBIFinalCosts`", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_tmp_consolidate`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T15:35:43.158998Z", "completed_at": "2024-06-07T15:35:43.169609Z"}, {"name": "execute", "started_at": "2024-06-07T15:35:43.171493Z", "completed_at": "2024-06-07T15:36:00.507324Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 17.352319478988647, "adapter_response": {"_message": "CREATE TABLE (693.7k rows, 273.8 MiB processed)", "code": "CREATE TABLE", "rows_affected": 693724, "bytes_processed": 287062660, "bytes_billed": 287309824, "location": "US", "project_id": "metrics-streams-dev", "job_id": "bcf9e3d1-5f1a-4057-ad60-784772e2aed9", "slot_ms": 66512}, "message": "CREATE TABLE (693.7k rows, 273.8 MiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_prefacIT", "compiled": true, "compiled_code": "\n\n-- depends_on: `metrics-streams-dev`.`TemporalData`.`final_tmp_consolidate`\nSELECT  CAST(a.idcatalogoorigen AS INT64) idcatalogoorigen,   \n              a.nombrenemonico,\n              CAST(a.idproceso AS INT64) idproceso,\n              a.generator_cost_name,\n              a.account_id, \n              a.datetime,   \n              a.service_name,   \n              a.service_type,   \n              a.billing_key,\n              SUM(CAST(a.billing_usage_ammount AS NUMERIC)) billing_usage_ammount,   \n              SUM(CAST(a.total_cost AS NUMERIC)) total_cost,  \n              IF (a.idprocesoanterior=155, a.billing_key, a.billing_concept) billing_concept,\n              a.billing_unit,   \n              a.initiative_id,  \n              a.initiative_external_code, \n              LEFT(a.initiative_external_name,149)  initiative_external_name,\n              LEFT(a.head,149) head,\n              LEFT(a.sponsor,149) sponsor,\n              a.project_id,\n              LEFT(a.project_code,149) project_code,    \n              a.team_id,LEFT(a.team_name,149) team_name,\n              a.avenue_id, LEFT(a.avenue_name,149) avenue_name, \n              a.bu_id,\n              LEFT(a.bu_name,149) bu_name,\n              a.super_bu_id, \n              LEFT(a.super_bu_name,149) super_bu_name,\n              MIN(a.load_date) load_date,\n              MAX(a.update_date) update_date,\n              CONCAT('se sumaron ', CAST( COUNT(1) AS STRING), ' de registros') observation,\n              a.idprocesoanterior,\n              ARRAY_AGG(STRUCT(PARSE_JSON(\n                  CASE WHEN a.idprocesoanterior=155 THEN\n                       billing_concept\n                  ELSE\n                       '{\"N/A\":\"N/A\"}' \n                  END) AS user, CAST(billing_usage_ammount AS NUMERIC) AS billing_usage_ammount , CAST(total_cost  AS NUMERIC) AS total_cost)) AS consumption_type \n      FROM `metrics-streams-dev`.`TemporalData`.`final_tmp_consolidate` AS a\n      INNER JOIN \n        (SELECT \n            final.datetime,\n            final.generator_cost_name,\n            final.billing_key,\n            final.service_type,\n            final.service_name,\n            final.billing_unit\n         FROM `metrics-streams-dev`.`TemporalData`.`final_tmp_consolidate` AS  final\n         GROUP BY 1,2,3,4,5,6\n         HAVING COUNT(1)>1) b\n      ON      a.datetime=b.datetime\n          AND a.generator_cost_name =b.generator_cost_name\n          AND a.billing_key = b.billing_key\n          AND a.service_type = b.service_type\n          AND a.service_name = b.service_name\n          AND a.billing_unit= b.billing_unit\n      GROUP BY 1,2,3,4,5,6,7,8,9,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,32\n      UNION ALL\n      SELECT CAST(a.idcatalogoorigen AS INT64) idcatalogoorigen,\n             a.nombrenemonico,  \n             CAST(a.idproceso AS INT64) idproceso,\n             a.generator_cost_name,\n             a.account_id,\n             a.datetime,    \n             a.service_name,\n             a.service_type,\n             a.billing_key,\n             SUM(CAST(a.billing_usage_ammount AS NUMERIC)) billing_usage_ammount, \n             SUM(CAST(a.total_cost AS NUMERIC)) total_cost, \n             a.billing_concept,\n             a.billing_unit,\n             a.initiative_id,   \n             a.initiative_external_code,\n             LEFT(a.initiative_external_name,149) initiative_external_name,\n             LEFT(a.head,149) head,\n             LEFT(a.sponsor,149) sponsor,   \n             a.project_id,\n             LEFT(a.project_code,149) project_code, \n             a.team_id,\n             LEFT(a.team_name,149) team_name,\n             a.avenue_id,\n             LEFT(a.avenue_name,149) avenue_name,   \n             a.bu_id,\n             LEFT(a.bu_name,149) bu_name,   \n             a.super_bu_id,\n             LEFT(a.super_bu_name,149) super_bu_name,\n             MIN(a.load_date) load_date,   \n             MAX(a.update_date) update_date,\n             CONCAT('se sumaron ', CAST( COUNT(1) AS STRING), ' de registros') observation,\n             a.idprocesoanterior,\n             ARRAY_AGG(STRUCT(PARSE_JSON('{\"N/A\":\"N/A\"}') AS user, CAST(billing_usage_ammount AS NUMERIC) as billing_usage_ammount, CAST(total_cost AS NUMERIC) as total_cost )) AS consumption_type   \n      FROM `metrics-streams-dev`.`TemporalData`.`final_tmp_consolidate`  AS a\n      INNER JOIN \n      (SELECT \n             final.datetime,\n             final.generator_cost_name,\n             final.billing_key,\n             final.service_type, \n             final.service_name,\n             final.billing_unit\n        FROM `metrics-streams-dev`.`TemporalData`.`final_tmp_consolidate` final\n        GROUP BY 1,2,3,4,5,6\n        HAVING COUNT(1)=1) b \n      ON  (\n          a.datetime=b.datetime\n      AND a.generator_cost_name =b.generator_cost_name\n      AND a.billing_key = b.billing_key\n      AND a.service_type = b.service_type\n      AND a.service_name = b.service_name\n      AND a.billing_unit= b.billing_unit)\n      WHERE a.idprocesoanterior != 155\n      GROUP BY 1,2,3,4,5,6,7,8,9,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,32\n      UNION ALL\n      SELECT CAST(a.idcatalogoorigen AS INT64) idcatalogoorigen,\n             a.nombrenemonico,  \n             CAST(a.idproceso AS INT64) idproceso,\n             a.generator_cost_name,\n             a.account_id,\n             a.datetime,    \n             a.service_name,\n             a.service_type,\n             a.billing_key,\n             SUM(CAST(a.billing_usage_ammount AS NUMERIC)) billing_usage_ammount, \n             SUM(CAST(a.total_cost AS NUMERIC)) total_cost, \n             a.billing_key AS billing_concept,\n             a.billing_unit,\n             a.initiative_id,   \n             a.initiative_external_code,\n             LEFT(a.initiative_external_name,149) initiative_external_name,\n             LEFT(a.head,149) head,\n             LEFT(a.sponsor,149) sponsor,   \n             a.project_id,\n             LEFT(a.project_code,149) project_code, \n             a.team_id,\n             LEFT(a.team_name,149) team_name,\n             a.avenue_id,\n             LEFT(a.avenue_name,149) avenue_name,   \n             a.bu_id,\n             LEFT(a.bu_name,149) bu_name,   \n             a.super_bu_id,\n             LEFT(a.super_bu_name,149) super_bu_name,\n             MIN(a.load_date) load_date,   \n             MAX(a.update_date) update_date,\n             CONCAT('se sumaron ', CAST( COUNT(1) AS STRING), ' de registros') observation,\n             a.idprocesoanterior,\n             ARRAY_AGG(STRUCT(PARSE_JSON('{\"N/A\":\"N/A\"}') AS user, CAST(billing_usage_ammount AS NUMERIC) AS billing_usage_ammount, CAST(total_cost AS NUMERIC) AS total_cost )) AS consumption_type \n      FROM `metrics-streams-dev`.`TemporalData`.`final_tmp_consolidate` a  \n      INNER JOIN\n      (SELECT \n             final.datetime,\n             final.generator_cost_name,\n             final.billing_key,\n             final.service_type, \n             final.service_name,\n             final.billing_unit\n        FROM `metrics-streams-dev`.`TemporalData`.`final_tmp_consolidate` final\n        WHERE final.idprocesoanterior = 155\n        GROUP BY 1,2,3,4,5,6\n        HAVING COUNT(1)=1) b \n      ON  (\n          a.datetime=b.datetime\n      AND a.generator_cost_name =b.generator_cost_name\n      AND a.billing_key = b.billing_key\n      AND a.service_type = b.service_type\n      AND a.service_name = b.service_name\n      AND a.billing_unit= b.billing_unit)\n      WHERE a.idprocesoanterior = 155\n      GROUP BY 1,2,3,4,5,6,7,8,9,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,32", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_prefacIT`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T15:36:00.706367Z", "completed_at": "2024-06-07T15:36:00.715269Z"}, {"name": "execute", "started_at": "2024-06-07T15:36:00.717495Z", "completed_at": "2024-06-07T15:36:05.636920Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.934874534606934, "adapter_response": {"_message": "CREATE TABLE (3.0 rows, 94.9 MiB processed)", "code": "CREATE TABLE", "rows_affected": 3, "bytes_processed": 99529674, "bytes_billed": 99614720, "location": "US", "project_id": "metrics-streams-dev", "job_id": "9f5de14f-8263-4bf9-be32-59108e704660", "slot_ms": 7568}, "message": "CREATE TABLE (3.0 rows, 94.9 MiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_dupli_check_it", "compiled": true, "compiled_code": "\n\n\n        SELECT DATE(datetime) day\n              ,generator_cost_name\n              ,account_id\n              ,service_type  \n              ,billing_key\n              ,service_name\n              ,billing_unit \n              ,billing_concept\n              ,idprocesoanterior\n              ,COUNT(1) records\n              ,SUM(total_cost) total_cost\n        FROM `metrics-streams-dev`.`TemporalData`.`final_prefacIT`\n        GROUP BY 1,2,3,4,5,6,7,8,9\n        HAVING COUNT(*) > 1", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_dupli_check_it`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T15:36:07.508674Z", "completed_at": "2024-06-07T15:36:07.518548Z"}, {"name": "execute", "started_at": "2024-06-07T15:36:07.521935Z", "completed_at": "2024-06-07T15:36:11.657224Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.153286695480347, "adapter_response": {"_message": "CREATE TABLE (3.0 rows, 309.3 MiB processed)", "code": "CREATE TABLE", "rows_affected": 3, "bytes_processed": 324279039, "bytes_billed": 325058560, "location": "US", "project_id": "metrics-streams-dev", "job_id": "9e7d15ce-6b2b-4edb-b742-e861b8c42f7c", "slot_ms": 20979}, "message": "CREATE TABLE (3.0 rows, 309.3 MiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_dupli_check_it_reinsert_it", "compiled": true, "compiled_code": "\n\n\n\n\n        WITH base_for_change AS (\n          SELECT A.* FROM `metrics-streams-dev`.`TemporalData`.`final_prefacIT` A \n          INNER JOIN `metrics-streams-dev`.`TemporalData`.`final_dupli_check_it`  B \n          ON (DATE(A.datetime) = B.day AND\n              A.generator_cost_name = B.generator_cost_name AND\n              A.account_id = B.account_id AND \n              A.service_type = B.service_type AND\n              A.billing_key = B.billing_key AND\n              A.service_name = B.service_name AND  \n              A.billing_unit = B.billing_unit AND \n              A.billing_concept = B.billing_concept AND \n              A.idprocesoanterior = B.idprocesoanterior)  \n        )\n\n        SELECT * FROM base_for_change \n        WHERE TRUE \n        QUALIFY ROW_NUMBER() \n        OVER (PARTITION BY \n                DATE(datetime),\n                generator_cost_name,\n                account_id,\n                service_type,\n                billing_key,\n                service_name,\n                billing_unit,\n                billing_concept,\n                idprocesoanterior\n                ORDER BY load_date DESC) = 1", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_dupli_check_it_reinsert_it`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T15:36:11.669701Z", "completed_at": "2024-06-07T15:36:11.677568Z"}, {"name": "execute", "started_at": "2024-06-07T15:36:11.679554Z", "completed_at": "2024-06-07T15:36:26.993648Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 15.328349351882935, "adapter_response": {"_message": "CREATE TABLE (693.7k rows, 309.3 MiB processed)", "code": "CREATE TABLE", "rows_affected": 693721, "bytes_processed": 324280346, "bytes_billed": 325058560, "location": "US", "project_id": "metrics-streams-dev", "job_id": "eaa14f27-33c3-405c-99da-f0534089af47", "slot_ms": 24874}, "message": "CREATE TABLE (693.7k rows, 309.3 MiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_prefacIT_nodup", "compiled": true, "compiled_code": "\n\n\n\nWITH cut_duplis AS (SELECT * FROM `metrics-streams-dev`.`TemporalData`.`final_prefacIT`  A \n                    WHERE NOT EXISTS (SELECT 'X' FROM `metrics-streams-dev`.`TemporalData`.`final_dupli_check_it_reinsert_it` B WHERE\n                        A.datetime=B.datetime AND\n                        A.generator_cost_name = B.generator_cost_name AND\n                        A.account_id = B.account_id AND \n                        A.service_type = B.service_type AND\n                        A.billing_key = B.billing_key AND\n                        A.service_name = B.service_name AND  \n                        A.billing_unit = B.billing_unit AND \n                        A.billing_concept = B.billing_concept AND \n                        A.idprocesoanterior = B.idprocesoanterior) AND A.initiative_id IS NOT NULL\n                    )\n\nSELECT * FROM cut_duplis  \nUNION ALL\nSELECT * FROM `metrics-streams-dev`.`TemporalData`.`final_dupli_check_it_reinsert_it`", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_prefacIT_nodup`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T15:36:27.003934Z", "completed_at": "2024-06-07T15:36:27.016474Z"}, {"name": "execute", "started_at": "2024-06-07T15:36:27.018473Z", "completed_at": "2024-06-07T15:36:49.073078Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 22.073177576065063, "adapter_response": {"_message": "MERGE (693.7k rows, 146.2 GiB processed)", "code": "MERGE", "rows_affected": 693721, "bytes_processed": 156984098107, "bytes_billed": 156984410112, "location": "US", "project_id": "metrics-streams-dev", "job_id": "b496dd6a-e6fc-4be9-9afe-31f97760490c", "slot_ms": 7801611}, "message": "MERGE (693.7k rows, 146.2 GiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.BillingfacAllocationFinal", "compiled": true, "compiled_code": "-- depends_on: `metrics-streams-dev`.`TemporalData`.`final_prefacIT_nodup` \n\n\nSELECT * FROM `metrics-streams-dev`.`TemporalData`.`final_prefacIT_nodup`", "relation_name": "`metrics-streams-dev`.`ProcessedData`.`BillingfacAllocationFinal`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T15:36:49.082862Z", "completed_at": "2024-06-07T15:36:49.094451Z"}, {"name": "execute", "started_at": "2024-06-07T15:36:49.096442Z", "completed_at": "2024-06-07T15:37:00.195692Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 11.116830587387085, "adapter_response": {"_message": "CREATE TABLE (693.7k rows, 309.3 MiB processed)", "code": "CREATE TABLE", "rows_affected": 693721, "bytes_processed": 324276873, "bytes_billed": 325058560, "location": "US", "project_id": "metrics-streams-dev", "job_id": "55de1ac1-5cdc-457d-b728-b4a8707b1d10", "slot_ms": 29032}, "message": "CREATE TABLE (693.7k rows, 309.3 MiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_prefacFI", "compiled": true, "compiled_code": "-- depends_on: __dbt__cte__final_get_finance_limits\n\n\nWITH  __dbt__cte__final_get_finance_limits as (\n-- depends_on: `metrics-streams-dev`.`TemporalData`.`final_prefacIT`\n\n\n\n\n\n    \n    \n\n\nWITH get_current_day AS (\n    SELECT CASE WHEN CAST('7' AS INT64) >= 20 THEN \n         DATE(DATE_TRUNC(CURRENT_DATE(), month) )\n    ELSE\n         DATE(DATE_TRUNC(CURRENT_DATE(), month) - INTERVAL 1 MONTH )\n    END AS limit_finance),\n\n    get_range AS (SELECT limit_finance, \n           '2024-06-01' start_date, \n           '2024-06-04' end_date \n    FROM get_current_day), \n\n    get_limits_ind AS (\n    SELECT \n        CASE \n            WHEN  PARSE_DATE('%F', A.start_date) >= B.limit_finance AND PARSE_DATE('%F', A.end_date) >= B.limit_finance THEN\n                STRUCT(PARSE_DATE('%F', A.start_date) as start_date, PARSE_DATE('%F', A.end_date) as end_date) \n            WHEN  PARSE_DATE('%F', A.start_date) < B.limit_finance AND PARSE_DATE('%F', A.end_date) < B.limit_finance THEN\n                STRUCT(DATE(CURRENT_DATE('UTC') + INTERVAL 100 DAY) as start_date, DATE(CURRENT_DATE('UTC') + INTERVAL 100 DAY) as end_date) \n            WHEN  PARSE_DATE('%F', A.start_date) < B.limit_finance AND PARSE_DATE('%F', A.end_date) >= B.limit_finance THEN\n                STRUCT(B.limit_finance as start_date, DATE(A.end_date) as end_date ) \n       END AS output  \n    FROM get_range A , get_current_day B )\n\n    SELECT * FROM get_limits_ind\n    WHERE output IS NOT NULL\n), finance_limits AS (\n    SELECT output.start_date start_date, \n           output.end_date end_date \n    FROM __dbt__cte__final_get_finance_limits\n)\n\nSELECT A.* FROM `metrics-streams-dev`.`TemporalData`.`final_prefacIT_nodup` A , finance_limits B\nWHERE  DATE(A.datetime) BETWEEN B.start_date AND B.end_date", "relation_name": "`metrics-streams-dev`.`billing_wr_test`.`final_prefacFI`"}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-06-07T15:37:00.205656Z", "completed_at": "2024-06-07T15:37:01.954943Z"}, {"name": "execute", "started_at": "2024-06-07T15:37:01.956962Z", "completed_at": "2024-06-07T15:37:04.102762Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.901535987854004, "adapter_response": {"_message": "SELECT (1.0 rows, 5.0 GiB processed)", "code": "SELECT", "rows_affected": 1, "bytes_processed": 5348670200, "bytes_billed": 5348786176, "location": "US", "project_id": "metrics-streams-dev", "job_id": "079cd734-6509-4fb9-842c-8f42438121fb", "slot_ms": 373013}, "message": null, "failures": 0, "unique_id": "test.BillingfacAllocationFinal.final_load_tofinal", "compiled": true, "compiled_code": "WITH \n\nlista_proc AS (SELECT idproceso FROM `metrics-streams-dev`.`TemporalData`.`final_tmp_process_output`),\n\n  days_dummies AS (\n        SELECT days_gen FROM \n        UNNEST(GENERATE_DATE_ARRAY(PARSE_DATE('%F', '2024-06-01'), PARSE_DATE('%F', '2024-06-01')))  AS days_gen\n        ),\n  \n  matriz_days_pipes AS (\n       SELECT * \n       FROM days_dummies, lista_proc \n       ),\n\n\n  lista_validos AS (SELECT idprocesoanterior FROM `metrics-streams-dev`.`ProcessedData`.`BillingfacAllocationFinal` \n                    WHERE DATE(datetime) BETWEEN PARSE_DATE('%F', '2024-06-01') - INTERVAL 7 DAY  \n                          AND PARSE_DATE('%F', '2024-06-01') - INTERVAL 1 DAY GROUP BY 1),\n\n  lista_real AS (SELECT DATE(datetime) day, idprocesoanterior, COUNT(1), SUM(total_cost) \n                 FROM `metrics-streams-dev`.`ProcessedData`.`BillingfacAllocationFinal` \n                 WHERE DATE(datetime) BETWEEN PARSE_DATE('%F', '2024-06-01') AND PARSE_DATE('%F', '2024-06-04')\n                 GROUP BY 1,2 )\n  \n  SELECT * FROM matriz_days_pipes A WHERE EXISTS(SELECT 'X' FROM lista_validos C WHERE A.idproceso=C.idprocesoanterior)\n                             AND NOT EXISTS(SELECT 'X' FROM lista_real B WHERE A.idproceso=B.idprocesoanterior AND A.days_gen=B.day)", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T15:37:04.111944Z", "completed_at": "2024-06-07T15:37:04.120201Z"}, {"name": "execute", "started_at": "2024-06-07T15:37:04.122876Z", "completed_at": "2024-06-07T15:37:27.764418Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 23.65648865699768, "adapter_response": {"_message": "MERGE (693.7k rows, 137.1 GiB processed)", "code": "MERGE", "rows_affected": 693721, "bytes_processed": 147182555254, "bytes_billed": 147183370240, "location": "US", "project_id": "metrics-streams-dev", "job_id": "4d796dd3-f3e8-452a-a8f4-00d9a1c5ee27", "slot_ms": 8948177}, "message": "MERGE (693.7k rows, 137.1 GiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.BillingfacAllocationFinal_Finance", "compiled": true, "compiled_code": "\n\nSELECT * FROM `metrics-streams-dev`.`billing_wr_test`.`final_prefacFI`", "relation_name": "`metrics-streams-dev`.`ProcessedData`.`BillingfacAllocationFinal_Finance`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T15:37:27.773911Z", "completed_at": "2024-06-07T15:37:27.782260Z"}, {"name": "execute", "started_at": "2024-06-07T15:37:27.784189Z", "completed_at": "2024-06-07T15:37:34.522674Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 6.752560138702393, "adapter_response": {"_message": "CREATE TABLE (3.2m rows, 6.6 GiB processed)", "code": "CREATE TABLE", "rows_affected": 3163929, "bytes_processed": 7041940995, "bytes_billed": 7042236416, "location": "US", "project_id": "metrics-streams-dev", "job_id": "e42b48fc-6140-49d0-b68a-a081e92bcacb", "slot_ms": 366768}, "message": "CREATE TABLE (3.2m rows, 6.6 GiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_tmp_BillingDashHistoFullAccountOffFury", "compiled": true, "compiled_code": "-- depends_on: `metrics-streams-dev`.`ProcessedData`.`BillingfacAllocationFinal`\n\n\n\n   WITH \n    days_dummies AS (\n        SELECT days_gen FROM \n        UNNEST(GENERATE_DATE_ARRAY(PARSE_DATE('%F', '2022-01-01'), DATE(CURRENT_DATE() - INTERVAL 2 DAY) , INTERVAL 1 DAY))  AS days_gen\n        ),\n\n    account_day_real AS (\n       SELECT DATE(datetime) day,\n            account_id, \n            account_name,\n            idproceso,\n            ROUND(SUM(total_cost),2) total_cost,\n            COUNT(1) conteo\n       FROM `metrics-streams-dev`.`ProcessedData`.`BillingtabOffFury` B \n       WHERE account_id IS NOT NULL AND account_name IS NOT NULL\n       GROUP BY 1,2,3,4\n       ),\n\n    account_dummies AS (\n       SELECT account_id, account_name, idproceso\n       FROM account_day_real \n       WHERE account_name IS NOT NULL AND account_id IS NOT NULL\n       GROUP BY 1,2,3 \n       ),\n\n    matriz_days_account AS (\n       SELECT A.days_gen, B.account_id , B.account_name, B.idproceso\n       FROM days_dummies A, account_dummies B\n       ),\n\n    cruce_account_values AS (\n       SELECT A.days_gen day,\n              A.account_id,\n              A.account_name,\n              A.idproceso,\n              COALESCE(B.total_cost,null,0) total_cost,\n              COALESCE(B.conteo,null,0) conteo\n       FROM matriz_days_account A\n       LEFT JOIN account_day_real B\n            ON (A.days_gen=B.day AND A.account_id=B.account_id AND A.account_name=B.account_name AND A.idproceso=B.idproceso)\n       )\n\n    SELECT * FROM cruce_account_values", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_tmp_BillingDashHistoFullAccountOffFury`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T15:37:34.533203Z", "completed_at": "2024-06-07T15:37:34.540793Z"}, {"name": "execute", "started_at": "2024-06-07T15:37:34.542827Z", "completed_at": "2024-06-07T15:37:40.716867Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 6.18792986869812, "adapter_response": {"_message": "CREATE TABLE (3.2m rows, 237.2 MiB processed)", "code": "CREATE TABLE", "rows_affected": 3163929, "bytes_processed": 248738749, "bytes_billed": 249561088, "location": "US", "project_id": "metrics-streams-dev", "job_id": "a5f5af9a-ddc4-44d4-8eb5-f62d1c7a04a9", "slot_ms": 54086}, "message": "CREATE TABLE (3.2m rows, 237.2 MiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_BillingDashHistoFullAccountOffFury", "compiled": true, "compiled_code": "\n\nSELECT DISTINCT \n              day, \n              account_id, \n              account_name,\n              total_cost, \n              conteo,\n              ROW_NUMBER() OVER (PARTITION BY day ORDER BY total_cost DESC) AS ranking\nFROM `metrics-streams-dev`.`TemporalData`.`final_tmp_BillingDashHistoFullAccountOffFury`", "relation_name": "`metrics-streams-dev`.`TemporalData`.`BillingDashHistoFullAccountOffFury`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T15:37:40.727656Z", "completed_at": "2024-06-07T15:37:40.739147Z"}, {"name": "execute", "started_at": "2024-06-07T15:37:40.741115Z", "completed_at": "2024-06-07T15:37:44.264428Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.54109525680542, "adapter_response": {"_message": "CREATE TABLE (18.6k rows, 237.2 MiB processed)", "code": "CREATE TABLE", "rows_affected": 18627, "bytes_processed": 248738749, "bytes_billed": 249561088, "location": "US", "project_id": "metrics-streams-dev", "job_id": "6c3e474f-246b-4c2d-bcc8-6ac65a48ad47", "slot_ms": 44047}, "message": "CREATE TABLE (18.6k rows, 237.2 MiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_BillingDashControlBaseOffFury", "compiled": true, "compiled_code": "\n\n   WITH     \n    selected_base AS (\n      SELECT DATE(day) day,\n        account_id, \n        account_name,\n        total_cost,\n        conteo\n      FROM `metrics-streams-dev`.`TemporalData`.`BillingDashHistoFullAccountOffFury`  \n      QUALIFY ROW_NUMBER() OVER (PARTITION BY day ORDER BY total_cost DESC) <= 20\n      UNION ALL\n      SELECT day, \n             'ID_OTHERS' account_id, \n             'OTHERS ACCOUNTS TOP 20' account_name, \n             ROUND(SUM(total_cost),2) total_cost,\n             SUM(conteo) conteo\n      FROM (\n            SELECT DATE(day) day,\n                    account_id,\n                    account_name,\n                    total_cost,\n                    conteo\n            FROM  `metrics-streams-dev`.`TemporalData`.`BillingDashHistoFullAccountOffFury`\n            QUALIFY ROW_NUMBER() OVER (PARTITION BY day ORDER BY total_cost DESC) > 20)\n      GROUP BY 1,2,3  ) \n\n    SELECT *,\n        ROW_NUMBER() OVER (PARTITION BY day ORDER BY total_cost DESC) AS ranking \n    FROM selected_base\n    ORDER BY 1 DESC, 4 DESC", "relation_name": "`metrics-streams-dev`.`ProcessedData`.`BillingDashControlBaseOffFury`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T15:37:44.274239Z", "completed_at": "2024-06-07T15:37:44.282892Z"}, {"name": "execute", "started_at": "2024-06-07T15:37:44.285003Z", "completed_at": "2024-06-07T15:37:47.452118Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.1816697120666504, "adapter_response": {"_message": "CREATE TABLE (80.0 rows, 1.0 MiB processed)", "code": "CREATE TABLE", "rows_affected": 80, "bytes_processed": 1050814, "bytes_billed": 10485760, "location": "US", "project_id": "metrics-streams-dev", "job_id": "1dede46f-e4c3-4416-b083-095790ea7bc2", "slot_ms": 5521}, "message": "CREATE TABLE (80.0 rows, 1.0 MiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_BillingDashHistoRankingOffFury", "compiled": true, "compiled_code": "\n\nSELECT account_name, ARRAY_AGG(STRUCT (day, ranking, conteo, total_cost )) histo_rank \n          FROM `metrics-streams-dev`.`ProcessedData`.`BillingDashControlBaseOffFury`\n    GROUP BY account_name", "relation_name": "`metrics-streams-dev`.`billing_wr_test`.`BillingDashHistoRankingOffFury`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T15:37:47.462343Z", "completed_at": "2024-06-07T15:37:48.719191Z"}, {"name": "execute", "started_at": "2024-06-07T15:37:48.721715Z", "completed_at": "2024-06-07T15:37:51.848256Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.3899242877960205, "adapter_response": {"_message": "CREATE TABLE (0.0 rows, 2.4 MiB processed)", "code": "CREATE TABLE", "rows_affected": 0, "bytes_processed": 2524924, "bytes_billed": 20971520, "location": "US", "project_id": "metrics-streams-dev", "job_id": "184173f1-5e89-4906-b9a6-87163772a8ac", "slot_ms": 22075}, "message": "CREATE TABLE (0.0 rows, 2.4 MiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_change_fury", "compiled": true, "compiled_code": "\n-- depends on : (<BigQueryRelation `metrics-streams-dev`.`billing_wr_test`.`BillingDashHistoRankingOffFury`>, <BigQueryRelation `metrics-streams-dev`.`TemporalData`.`final_last_snapshot`>)  \nWITH dif_1 AS (\n                SELECT day,\n                    idproceso,\n                    proceso,\n                    conteo,\n                    COALESCE(CAST(total_cost AS FLOAT64),null,0) AS total_cost  \n                FROM \n                `metrics-streams-dev`.`ProcessedData`.`BillingDashControlBase`\n                WHERE \n                day BETWEEN  '2024-06-01' \n                AND '2024-06-04'\n                EXCEPT \n                DISTINCT \n                SELECT day,\n                    idproceso,\n                    proceso,\n                    conteo,\n                    COALESCE(CAST(total_cost AS FLOAT64),null,0) AS total_cost \n                FROM \n                ProcessedData_REPRO_snapshots.BillingDashControlBase_20240607153300 \n                WHERE \n                day BETWEEN '2024-06-01' \n                AND '2024-06-04'\n            ),\n            \n             dif_2 AS (\n                 SELECT day,\n                 idproceso,\n                 proceso,\n                 conteo,\n                 COALESCE(CAST(total_cost AS FLOAT64),null,0) AS total_cost \n        FROM \n          ProcessedData_REPRO_snapshots.BillingDashControlBase_20240607153300 \n        WHERE \n          day BETWEEN '2024-06-01' \n          AND '2024-06-04' \n        EXCEPT \n          DISTINCT \n        SELECT day,\n               idproceso,\n               proceso,\n               conteo,\n               COALESCE(CAST(total_cost AS FLOAT64),null,0) AS total_cost         \n        FROM\n          `metrics-streams-dev`.`ProcessedData`.`BillingDashControlBase`\n        WHERE \n          day BETWEEN '2024-06-01' \n          AND '2024-06-04'\n      )\n        \n        SELECT 'LasttoPrev' sentido, * FROM dif_1\n        UNION ALL\n        SELECT 'PrevtoLast' sentido, * FROM dif_2", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_change_fury`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T15:37:51.858614Z", "completed_at": "2024-06-07T15:37:52.990156Z"}, {"name": "execute", "started_at": "2024-06-07T15:37:52.992219Z", "completed_at": "2024-06-07T15:37:56.177079Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.322626829147339, "adapter_response": {"_message": "CREATE TABLE (4.0 rows, 2.6 MiB processed)", "code": "CREATE TABLE", "rows_affected": 4, "bytes_processed": 2772070, "bytes_billed": 20971520, "location": "US", "project_id": "metrics-streams-dev", "job_id": "d4d44618-7411-4ec4-9fe8-f914b83bf270", "slot_ms": 22373}, "message": "CREATE TABLE (4.0 rows, 2.6 MiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_change_offfury", "compiled": true, "compiled_code": "-- depends on : (<BigQueryRelation `metrics-streams-dev`.`billing_wr_test`.`BillingDashHistoRankingOffFury`>, <BigQueryRelation `metrics-streams-dev`.`TemporalData`.`final_last_snapshot`>)  \n\n\n        WITH dif_1 AS (\n                SELECT * \n                FROM `metrics-streams-dev`.`ProcessedData`.`BillingDashControlBaseOffFury`\n                WHERE \n                day BETWEEN  '2024-06-01' \n                AND '2024-06-04' \n                EXCEPT \n                DISTINCT \n                SELECT * \n                FROM \n                ProcessedData_REPRO_snapshots.BillingDashControlBaseOffFury_20240607153300 \n                WHERE \n                day BETWEEN '2024-06-01' \n                AND '2024-06-04'\n            ),\n            \n             dif_2 AS (\n                SELECT * \n                FROM \n                ProcessedData_REPRO_snapshots.BillingDashControlBaseOffFury_20240607153300 \n                WHERE \n                day BETWEEN '2024-06-01' \n                AND '2024-06-04' \n                EXCEPT \n                DISTINCT \n                SELECT *         \n                FROM\n                `metrics-streams-dev`.`ProcessedData`.`BillingDashControlBaseOffFury`\n                WHERE \n                day BETWEEN '2024-06-01' \n                AND '2024-06-04'\n            )\n        \n        SELECT 'LasttoPrev' sentido, * FROM dif_1\n        UNION ALL\n        SELECT 'PrevtoLast' sentido, * FROM dif_2", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_change_offfury`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T15:37:56.190919Z", "completed_at": "2024-06-07T15:37:57.211771Z"}, {"name": "execute", "started_at": "2024-06-07T15:37:57.213811Z", "completed_at": "2024-06-07T15:38:00.142017Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.959048271179199, "adapter_response": {"_message": "CREATE TABLE (1.0 rows, 0 processed)", "code": "CREATE TABLE", "rows_affected": 1, "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "metrics-streams-dev", "job_id": "6d39d486-6bce-4795-a19d-4040b26d4f02", "slot_ms": 170}, "message": "CREATE TABLE (1.0 rows, 0 processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_for_newrecord_fury", "compiled": true, "compiled_code": "-- depends_on: (<BigQueryRelation `metrics-streams-dev`.`TemporalData`.`final_last_snapshot`>, <BigQueryRelation `metrics-streams-dev`.`TemporalData`.`final_change_fury`>)\nSELECT   \n                '20240607153300' sufijo, \n                ARRAY_AGG(\n                STRUCT (\n                    COALESCE(day,null,DATE(CURRENT_DATE())) AS day,\n                    COALESCE(idproceso,null,0) AS idproceso,\n                    COALESCE(proceso,null,'EMPTY') AS proceso,\n                    COALESCE(sentido,null,'EMPTY') AS sentido,\n                    COALESCE(CAST(conteo AS FLOAT64),null,0) AS conteo,\n                    COALESCE(CAST(total_cost AS FLOAT64),null,0) AS total_cost\n                    )) AS value \n\n               FROM (SELECT CURRENT_DATE() day, \n                    0 idproceso,\n                    'NULL' proceso, \n                    'NULL' sentido,\n                    0 conteo, \n                    0 total_cost)", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_for_newrecord_fury`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T15:38:00.151957Z", "completed_at": "2024-06-07T15:38:01.268473Z"}, {"name": "execute", "started_at": "2024-06-07T15:38:01.270617Z", "completed_at": "2024-06-07T15:38:03.721039Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.5732035636901855, "adapter_response": {"_message": "CREATE TABLE (1.0 rows, 0 processed)", "code": "CREATE TABLE", "rows_affected": 1, "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "metrics-streams-dev", "job_id": "8702f0ed-62b6-422c-b992-832d552753b1", "slot_ms": 138}, "message": "CREATE TABLE (1.0 rows, 0 processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_for_newrecord_offfury", "compiled": true, "compiled_code": "-- depends_on: (<BigQueryRelation `metrics-streams-dev`.`TemporalData`.`final_last_snapshot`>, <BigQueryRelation `metrics-streams-dev`.`TemporalData`.`final_change_offfury`>)\nSELECT   \n                '20240607153300'  sufijo, \n                ARRAY_AGG(\n                STRUCT (\n                    COALESCE(day,null,DATE(CURRENT_DATE())) AS day,\n                    COALESCE(account_id,null,'EMPTY') AS account_id,\n                    COALESCE(account_name,null,'EMPTY') AS account_name,\n                    'N/A' AS responsable,\n                    COALESCE(sentido,null,'EMPTY') AS sentido,\n                    COALESCE(CAST(total_cost AS FLOAT64),null,0) AS total_cost,\n                    COALESCE(CAST(conteo AS INT64),null,0) AS conteo,\n                    COALESCE(CAST(ranking AS INT64),null,0) AS ranking\n                    )) AS value   \n            FROM (SELECT CURRENT_DATE() day, \n                  'NULL' account_id,\n                  'NULL' account_name, \n                  'N/A' responsable,\n                  'NULL' sentido,\n                  0 total_cost,\n                  0 conteo, \n                  0 ranking)", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_for_newrecord_offfury`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T15:38:03.731885Z", "completed_at": "2024-06-07T15:38:03.742733Z"}, {"name": "execute", "started_at": "2024-06-07T15:38:03.744803Z", "completed_at": "2024-06-07T15:38:07.229086Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.5014307498931885, "adapter_response": {"_message": "CREATE TABLE (1.0 rows, 331.0 Bytes processed)", "code": "CREATE TABLE", "rows_affected": 1, "bytes_processed": 331, "bytes_billed": 83886080, "location": "US", "project_id": "metrics-streams-dev", "job_id": "19b30dc4-0984-4cc7-860e-8105547b1f84", "slot_ms": 5389}, "message": "CREATE TABLE (1.0 rows, 331.0 Bytes processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.final_new_record_bitacora", "compiled": true, "compiled_code": "-- depends on : (<BigQueryRelation `metrics-streams-dev`.`TemporalData`.`final_for_newrecord_fury`>, <BigQueryRelation `metrics-streams-dev`.`TemporalData`.`final_for_newrecord_offfury`>)  \n\n\n    SELECT \n      A.sufijo, \n      B.datetime,\n      'Test Final dbt' observation,\n      STRUCT(A.records, A.total_cost) AS last_final,\n      STRUCT(B.records, B.total_cost) AS prev_final,\n      STRUCT(C.records, C.total_cost) AS last_dash_fury,\n      STRUCT(D.records, D.total_cost) AS prev_dash_fury,\n      STRUCT(E.records, E.total_cost) AS last_dash_offfury,\n      STRUCT(F.records, F.total_cost) AS prev_dash_offfury,\n      (A.records    - B.records)    dif_final_records,\n      (A.total_cost - B.total_cost) dif_final_cost,\n      (C.records    - D.records)    dif_dash_fury_records,\n      (C.total_cost - D.total_cost) dif_dash_fury_cost,\n      (E.records    - F.records)    dif_dash_offfury_records,\n      (E.total_cost - F.total_cost) dif_dash_offfury_cost,\n      '2024-06-01'  date_start_repro,\n      '2024-06-04'  date_end_repro,\n      G.value struct_fury_dash, \n      H.value struct_offfury_dash\n    FROM  `metrics-streams-dev`.`TemporalData`.`final_last_final_values`                A \n        INNER JOIN `metrics-streams-dev`.`TemporalData`.`final_prev_final_values`       B  ON (A.sufijo=B.sufijo)\n        INNER JOIN `metrics-streams-dev`.`TemporalData`.`final_last_dashfury_values`    C  ON (A.sufijo=C.sufijo)\n        INNER JOIN `metrics-streams-dev`.`TemporalData`.`final_prev_dashfury_values`    D  ON (A.sufijo=D.sufijo)\n        INNER JOIN `metrics-streams-dev`.`TemporalData`.`final_last_dashOffFury_values` E  ON (A.sufijo=E.sufijo)\n        INNER JOIN `metrics-streams-dev`.`TemporalData`.`final_prev_dashOffFury_values` F  ON (A.sufijo=F.sufijo)\n        INNER JOIN `metrics-streams-dev`.`TemporalData`.`final_for_newrecord_fury`      G  ON (A.sufijo=G.sufijo)\n        INNER JOIN `metrics-streams-dev`.`TemporalData`.`final_for_newrecord_offfury`  H  ON (A.sufijo=H.sufijo)", "relation_name": "`metrics-streams-dev`.`TemporalData`.`final_new_record_bitacora`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-07T15:38:07.239724Z", "completed_at": "2024-06-07T15:38:08.955270Z"}, {"name": "execute", "started_at": "2024-06-07T15:38:08.957369Z", "completed_at": "2024-06-07T15:38:12.042775Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.807283639907837, "adapter_response": {"_message": "MERGE (1.0 rows, 2.9 KiB processed)", "code": "MERGE", "rows_affected": 1, "bytes_processed": 3016, "bytes_billed": 20971520, "location": "US", "project_id": "metrics-streams-dev", "job_id": "bd9a6b17-65ec-439e-b030-52ba856d967f", "slot_ms": 15067}, "message": "MERGE (1.0 rows, 2.9 KiB processed)", "failures": null, "unique_id": "model.BillingfacAllocationFinal.BillingBitacoraRepro", "compiled": true, "compiled_code": "-- depends on : `metrics-streams-dev`.`TemporalData`.`final_new_record_bitacora`  \n\n\n\nSELECT * FROM `metrics-streams-dev`.`TemporalData`.`final_new_record_bitacora`", "relation_name": "`metrics-streams-dev`.`billing_wr_test`.`BillingBitacoraRepro`"}], "elapsed_time": 299.507123708725, "args": {"which": "build", "introspect": true, "strict_mode": false, "show_resource_report": false, "write_json": true, "printer_width": 80, "populate_cache": true, "use_colors": true, "enable_legacy_logger": false, "warn_error_options": {"include": [], "exclude": []}, "macro_debugging": false, "print": true, "log_format_file": "debug", "indirect_selection": "eager", "quiet": false, "send_anonymous_usage_stats": true, "favor_state": false, "use_colors_file": true, "log_path": "/home/wilson_roldan/dbt_projects/dbt_final/logs", "version_check": true, "exclude": [], "defer": false, "log_level": "info", "log_format": "default", "cache_selected_only": false, "profiles_dir": "/home/wilson_roldan/.dbt", "select": [], "vars": {"v_fecha_start": "2024-06-01", "v_fecha_end": "2024-06-04", "v_strobservation": "Test Final dbt", "v_list_pipelines": "[3, 56, 66, 151, 155, 29]"}, "partial_parse": true, "log_level_file": "debug", "include_saved_query": false, "log_file_max_bytes": 10485760, "invocation_command": "dbt build --vars {\"v_fecha_start\": \"2024-06-01\", \"v_fecha_end\":\"2024-06-04\",  \"v_strobservation\":\"Test Final dbt\", \"v_list_pipelines\":\"[3, 56, 66, 151, 155, 29]\" }", "resource_types": [], "show": false, "static_parser": true, "project_dir": "/home/wilson_roldan/dbt_projects/dbt_final", "partial_parse_file_diff": true}}